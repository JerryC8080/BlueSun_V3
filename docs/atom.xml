<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>BlueSun</title>
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://huang-jerryc.com/"/>
  <updated>2021-03-21T12:29:05.378Z</updated>
  <id>http://huang-jerryc.com/</id>
  
  <author>
    <name>JerryC</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>å¾®ä¿¡å°ç¨‹åºè·¯ç”±å®æˆ˜</title>
    <link href="http://huang-jerryc.com/2021/03/21/wxapp-router-experience/"/>
    <id>http://huang-jerryc.com/2021/03/21/wxapp-router-experience/</id>
    <published>2021-03-21T12:28:00.000Z</published>
    <updated>2021-03-21T12:29:05.378Z</updated>
    
    <content type="html"><![CDATA[<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>åœ¨å¾®ä¿¡å°ç¨‹åºç”±ä¸€ä¸ª <code>App()</code>å®ä¾‹ï¼Œå’Œä¼—å¤š<code>Page()</code>ç»„æˆã€‚è€Œåœ¨å°ç¨‹åºä¸­æ‰€æœ‰é¡µé¢çš„è·¯ç”±å…¨éƒ¨ç”±æ¡†æ¶è¿›è¡Œç®¡ç†ï¼Œæ¡†æ¶ä»¥æ ˆçš„å½¢å¼ç»´æŠ¤äº†æ‰€æœ‰é¡µé¢ï¼Œç„¶åæä¾›äº†ä»¥ä¸‹ API æ¥è¿›è¡Œè·¯ç”±ä¹‹é—´çš„è·³è½¬ï¼š</p>
<ol>
<li><code>wx.navigateTo</code></li>
<li><code>wx.redirectTo</code></li>
<li><code>wx.navigateBack</code></li>
<li><code>wx.switchTab</code></li>
<li><code>wx.reLaunch</code> </li>
</ol>
<p>ä½†æ˜¯ï¼Œå¯¹äºä¸€ä¸ªä¼ä¸šåº”ç”¨ï¼ŒæŠŠè¿™äº›é—®é¢˜ç•™ç»™äº†å¼€å‘è€…ï¼š</p>
<ol>
<li>åŸç”Ÿ API ä½¿ç”¨äº† <code>Callback</code> çš„å‡½æ•°å®ç°å½¢å¼ï¼Œä¸æˆ‘ä»¬ç°ä»£æ™®éçš„ <code>Promise</code> å’Œ <code>async/await</code> å­˜åœ¨ gapã€‚</li>
<li>åŸºäºå°ç¨‹åºè·¯ç”±çš„è®¾è®¡ï¼Œæš´éœ²ç»™å¤–éƒ¨çš„æ˜¯çœŸå®è·¯ç”±ï¼ˆå¦‚æ‰«ç ï¼Œå…¬ä¼—å·é“¾æ¥ç­‰æ–¹å¼ï¼‰ï¼Œå¯¹åç»­é¡¹ç›®é‡æ„ç•™ä¸‹å†å²åŒ…è¢±ã€‚</li>
<li>å°ç¨‹åºé¡µé¢æ ˆæœ€å¤šåå±‚ï¼Œ åœ¨è¶…è¿‡åå±‚å <code>wx.navigateTo</code> å¤±æ•ˆï¼Œéœ€è¦å¼€å‘è€…åˆ¤æ–­ä½¿ç”¨ <code>wx.redirectTo</code> æˆ–å…¶ä»–API</li>
<li>å°ç¨‹åºé¡µé¢æ ˆå­˜åœ¨ä¸€ç§ç‰¹æ®Šçš„é¡µé¢ï¼šTab é¡µé¢ï¼Œéœ€è¦ä½¿ç”¨ <code>wx.switchTab</code> æ‰èƒ½è·³è½¬ã€‚éœ€è¦å¼€å‘è€…ä¸»åŠ¨åˆ¤æ–­ï¼Œä¸æ–¹ä¾¿åæœŸæ”¹åŠ¨ Tab é¡µé¢å±æ€§ã€‚</li>
<li>é¢å¤–çš„ï¼Œå¯¹äºå°ç¨‹åºç ï¼Œè¦ä½¿ç”¨æ— æ•°é‡é™åˆ¶ API <a href="https://developers.weixin.qq.com/miniprogram/dev/api-backend/open-api/qr-code/wxacode.getUnlimited.html" target="_blank" rel="external">wxacode.getUnlimited</a> ï¼Œå­˜åœ¨å‚æ•°é•¿åº¦é™åˆ¶32ä½ä»¥å†…ã€‚éœ€è¦å¼€å‘è€…è‡ªè¡Œè§£å†³ã€‚</li>
</ol>
<p>è€Œæœ¬æ–‡ï¼ŒæœŸæœ›èƒ½å¯¹è¿™è‹¥å¹²é—®é¢˜ï¼Œé€ä¸ªæä¾›è§£å†³æ–¹æ¡ˆã€‚</p>
<h2 id="æ™ºèƒ½è·¯ç”±è·³è½¬-â€”-Navigator-æ¨¡å—"><a href="#æ™ºèƒ½è·¯ç”±è·³è½¬-â€”-Navigator-æ¨¡å—" class="headerlink" title="æ™ºèƒ½è·¯ç”±è·³è½¬ â€” Navigator æ¨¡å—"></a>æ™ºèƒ½è·¯ç”±è·³è½¬ â€” Navigator æ¨¡å—</h2><p>åœ¨è¿™é‡Œæˆ‘ä»¬ä¸€èµ·è§£å†³ï¼š</p>
<ol>
<li>åŸç”Ÿ API é Promsie</li>
<li>é¡µé¢æ ˆçªç ´åå±‚æ—¶ç‰¹æ®Šå¤„ç†</li>
<li>ç‰¹æ®Šé¡µé¢ Tab çš„è·³è½¬å¤„ç†</li>
</ol>
<p>æˆ‘ä»¬çš„æ€è·¯æ˜¯ï¼Œå¸Œæœ›èƒ½è®¾è®¡ä¸€ç§é€»è¾‘ï¼Œæ ¹æ®åœºæ™¯æ¥è‡ªåŠ¨åˆ¤æ–­ä½¿ç”¨å“ªä¸ªå¾®ä¿¡è·¯ç”± APIï¼Œç„¶åå¯¹å¤–åªæä¾›ä¸€ä¸ªå‡½æ•°ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gotoPage(<span class="string">'/pages/goods/index'</span>)</div></pre></td></tr></table></figure>
<p>å…·ä½“é€»è¾‘å¦‚ä¸‹ï¼š</p>
<ol>
<li>å½“è·³è½¬çš„è·¯ç”±ä¸ºå°ç¨‹åº tab é¡µé¢æ—¶ï¼Œåˆ™ä½¿ç”¨ <code>wx.switchTab</code>ã€‚</li>
<li>å½“é¡µé¢æ ˆè¾¾åˆ° 10 å±‚ä¹‹åï¼Œå¦‚æœè¦è·³è½¬çš„é¡µé¢åœ¨é¡µé¢æ ˆä¸­ï¼Œä½¿ç”¨ <code>wx.navigateBack({ delta: X })</code> å‡ºæ ˆåˆ°ç›®æ ‡é¡µé¢ã€‚</li>
<li>å½“é¡µé¢æ ˆè¾¾åˆ° 10 å±‚ä¹‹åï¼Œç›®æ ‡é¡µé¢ä¸å­˜åœ¨é¡µé¢æ ˆä¸­ï¼Œä½¿ç”¨ <code>wx.redirectTo</code> æ›¿æ¢æ ˆé¡¶é¡µé¢ã€‚</li>
<li>å…¶ä»–æƒ…å†µä½¿ç”¨ <code>wx.navigateTo</code></li>
</ol>
<p>é¡ºå¸¦çš„ï¼Œæˆ‘ä»¬æŠŠè¿™ä¸ªå‡½æ•°ä»¥ Promise å½¢å¼å®ç°ï¼Œä»¥åŠæ”¯æŒå‚æ•°ä½œä¸º <code>object</code>ä¼ å…¥ï¼Œä¾‹å¦‚ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gotoPage(<span class="string">'/pages/goods/index'</span>, &#123; <span class="attr">name</span>: <span class="string">'jc'</span> &#125;).then(...).catch(...);</div></pre></td></tr></table></figure>
<p>å¤§éƒ¨åˆ†åœºæ™¯ä¸‹ï¼Œåªè¦ä½¿ç”¨<code>gotoPage</code>å°±èƒ½æ»¡è¶³ã€‚</p>
<p>é‚£è‚¯å®šä¹Ÿä¼šæœ‰ç‰¹å®šçš„æƒ…å†µï¼Œéœ€è¦æ˜¾å¼çš„æŒ‡å®šä½¿ç”¨ <code>navigateTo/switchTab/redirectTo/navigateBack</code>çš„å“ªä¸€ä¸ªã€‚</p>
<p>é‚£ä¹ˆæˆ‘ä»¬ä¹ŸæŒ‰ç…§ç±»ä¼¼çš„å®ç°ï¼Œæ»¡è¶³ç›¸åŒæ¨¡å¼çš„ API</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">navigateTo(<span class="string">'/pages/goods/index'</span>, &#123; <span class="attr">name</span>: <span class="string">'jc'</span> &#125;).then(...).catch(...);</div><div class="line">switchTab(<span class="string">'/pages/goods/index'</span>, &#123; <span class="attr">name</span>: <span class="string">'jc'</span> &#125;).then(...).catch(...);</div><div class="line">redirectTo(<span class="string">'/pages/goods/index'</span>, &#123; <span class="attr">name</span>: <span class="string">'jc'</span> &#125;).then(...).catch(...);</div><div class="line">navigateBack(<span class="string">'/pages/goods/index'</span>, &#123; <span class="attr">name</span>: <span class="string">'jc'</span> &#125;).then(...).catch(...);</div></pre></td></tr></table></figure>
<p>è¿™äº›å‡½æ•°éƒ½å¯ä»¥å†…èšåˆ°åŒä¸€ä¸ªæ¨¡å—ï¼Œæˆ‘ä»¬ç§°å…¶ä¸ºï¼š<strong>Navigator</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> navigator = <span class="keyword">new</span> Navigator();</div><div class="line">navigator.gotoPage(...);</div><div class="line">navigator.navigateTo(...);</div><div class="line">navigator.switchTab(...);</div><div class="line">navigator.redirectTo(...);</div><div class="line">navigator.navigateBack(...);</div></pre></td></tr></table></figure>
<p>æ¨¡å—è®¾è®¡ï¼š</p>
<p><img src="https://raw.githubusercontent.com/JerryC8080/figure-bed/master/img/20210321202552.png" alt="navigator-class"></p>
<h2 id="è™šæ‹Ÿè·¯ç”±ç­–ç•¥-â€”-Router-æ¨¡å—"><a href="#è™šæ‹Ÿè·¯ç”±ç­–ç•¥-â€”-Router-æ¨¡å—" class="headerlink" title="è™šæ‹Ÿè·¯ç”±ç­–ç•¥ â€” Router æ¨¡å—"></a>è™šæ‹Ÿè·¯ç”±ç­–ç•¥ â€” Router æ¨¡å—</h2><p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬è§£å†³ï¼š</p>
<ol>
<li>å¯¹å¤–æš´éœ²äº†çœŸå®è·¯ç”±ï¼Œå¯¼è‡´å†å²åŒ…è¢±æ²‰é‡çš„é—®é¢˜ã€‚</li>
</ol>
<p>åœ¨è®¸å¤šåº”ç”¨å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸éœ€è¦æŠŠæŸç§æ¨¡å¼åŒ¹é…åˆ°çš„æ‰€æœ‰è·¯ç”±ï¼Œå…¨éƒ½æ˜ å°„åˆ°åŒä¸ªé¡µé¢ä¸­å»ã€‚<br>ä¾‹å¦‚ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ª Goods é¡µé¢ï¼Œå¯¹äºæ‰€æœ‰ ID å„ä¸ç›¸åŒçš„å•†å“ï¼Œéƒ½è¦ä½¿ç”¨è¿™ä¸ªé¡µé¢æ¥æ‰¿è½½ã€‚  </p>
<p><img src="https://raw.githubusercontent.com/JerryC8080/figure-bed/master/img/20210321202632.png" alt=""></p>
<p>é‚£ä¹ˆåœ¨ä»£ç å±‚é¢ä¸Šï¼ŒæœŸæœ›èƒ½å®ç°è¿™æ ·çš„è°ƒç”¨æ–¹å¼ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// åˆ›å»ºè·¯ç”±å®ä¾‹</span></div><div class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> Router();</div><div class="line"></div><div class="line"><span class="comment">// æ³¨å†Œè·¯ç”±</span></div><div class="line">router.register(&#123;</div><div class="line">  <span class="attr">path</span>: <span class="string">'/goods/:id'</span>, <span class="comment">// è™šæ‹Ÿè·¯ç”±</span></div><div class="line">  route: <span class="string">'/pages/goods/index'</span>, <span class="comment">// çœŸå®è·¯ç”±</span></div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// è·³è½¬åˆ° /pages/goods/indexï¼Œå‚æ•°: onLoad(options) çš„ options = &#123; id: '123' &#125;</span></div><div class="line">router.gotoPage(<span class="string">'/goods/123'</span>);</div><div class="line"></div><div class="line"><span class="comment">// è·³è½¬åˆ° /pages/goods/indexï¼Œå‚æ•°: onLoad(options) çš„ options = &#123; id: '456' &#125;</span></div><div class="line">router.gotoPage(<span class="string">'/goods/456'</span>);</div></pre></td></tr></table></figure>
<p><strong>Class Router</strong> çš„æ ¸å¿ƒé€»è¾‘æ˜¯å®Œæˆï¼š</p>
<ol>
<li>è·¯ç”±çš„æ³¨å†Œï¼Œå®Œæˆã€Œè™šæ‹Ÿè·¯å¾„ã€å’Œã€ŒçœŸå®è·¯å¾„ã€å…³ç³»çš„å­˜å‚¨ã€‚</li>
<li>æ»¡è¶³ã€Œè™šæ‹Ÿè·¯å¾„ã€åˆ°ã€ŒçœŸå®è·¯å¾„ã€çš„è½¬æ¢ï¼Œå¹¶ä¸”è¯†åˆ«ã€ŒåŠ¨æ€è·¯å¾„å‚æ•°ã€ï¼ˆdynamic segmentï¼‰ã€‚</li>
<li>è·¯ç”±è·³è½¬ã€‚</li>
</ol>
<p>å¯¹äºã€Œè·¯ç”±çš„æ³¨å†Œã€ï¼Œæˆ‘ä»¬åœ¨å…¶å†…éƒ¨å­˜å‚¨ä¸€ä¸ª map å°±èƒ½å®Œæˆã€‚</p>
<p>è€Œå¯¹äºã€Œè·¯å¾„çš„è½¬æ¢ã€ï¼Œ <code>vue-router</code> æœ‰ç±»ä¼¼çš„å®ç°ï¼Œé€šè¿‡å…¶æºç å‘ç°ï¼Œå†…éƒ¨æ˜¯ä½¿ç”¨  <a href="https://github.com/pillarjs/path-to-regexp" target="_blank" rel="external">path-to-regexp</a> ä½œä¸ºè·¯å¾„åŒ¹é…å¼•æ“ï¼Œæˆ‘ä»¬å¯ä»¥æ‹¿æ¥ç”¨ä¹‹ã€‚</p>
<p>ç„¶åå¯¹äºã€Œè·¯ç”±çš„è·³è½¬ã€ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å¤ç”¨ä¸Šé¢æåˆ°çš„ <strong>Navigator</strong> æ¨¡å—ï¼Œé€šè¿‡è¾“å…¥çœŸå®è·¯å¾„ï¼Œæ¥å®Œæˆè·¯ç”±çš„è·³è½¬ã€‚</p>
<p>æ¨¡å—è®¾è®¡ï¼š</p>
<p><img src="https://raw.githubusercontent.com/JerryC8080/figure-bed/master/img/20210321202636.png" alt="route-class"></p>
<p>å…¶ä¸­ï¼š</p>
<ol>
<li>RouteMatcherï¼šæä¾›åŠ¨æ€è·¯ç”±å‚æ•°åŒ¹é…åŠŸèƒ½ï¼Œå†…éƒ¨ä½¿ç”¨  <a href="https://github.com/pillarjs/path-to-regexp" target="_blank" rel="external">path-to-regexp</a> ä½œä¸ºè·¯å¾„åŒ¹é…å¼•æ“ã€‚</li>
<li>Route: ä¸ºæ¯ä¸ªè·¯å¾„åˆ›å»ºè·¯ç”±å™¨ï¼Œå­˜å‚¨æ¯ä¸ªè·¯ç”±çš„è™šæ‹Ÿè·¯å¾„å’ŒçœŸå®è·¯ç”±çš„å…³ç³»ã€‚</li>
<li>Routerï¼šæ•´åˆå†…éƒ¨å„æ¨¡å—ï¼Œå¯¹å¤–æä¾›ç»Ÿä¸€ä¸”ä¼˜é›…çš„è°ƒç”¨æ–¹å¼ã€‚</li>
</ol>
<h2 id="è½åœ°ä¸­è½¬ç­–ç•¥-â€”-LandTransfer-æ¨¡å—"><a href="#è½åœ°ä¸­è½¬ç­–ç•¥-â€”-LandTransfer-æ¨¡å—" class="headerlink" title="è½åœ°ä¸­è½¬ç­–ç•¥ â€” LandTransfer æ¨¡å—"></a>è½åœ°ä¸­è½¬ç­–ç•¥ â€” LandTransfer æ¨¡å—</h2><p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬è§£å†³ï¼š</p>
<ol>
<li>å°ç¨‹åºæ‰«ç ã€å…¬ä¼—å·é“¾æ¥ç­‰åœºæ™¯ä¸‹çš„è½åœ°é¡µç»Ÿä¸€ã€‚</li>
<li>å°ç¨‹åºç ï¼Œå¯¹äºæ— é™é‡API <a href="https://developers.weixin.qq.com/miniprogram/dev/api-backend/open-api/qr-code/wxacode.getUnlimited.html" target="_blank" rel="external">wxacode.getUnlimited</a> ï¼Œçªç ´å‚æ•°32ä½é•¿åº¦é™åˆ¶ã€‚</li>
</ol>
<h3 id="å¯¹äºè¦è§£å†³çš„ç¬¬ä¸€ä¸ªé—®é¢˜ï¼šç»Ÿä¸€çš„è½åœ°é¡µ"><a href="#å¯¹äºè¦è§£å†³çš„ç¬¬ä¸€ä¸ªé—®é¢˜ï¼šç»Ÿä¸€çš„è½åœ°é¡µ" class="headerlink" title="å¯¹äºè¦è§£å†³çš„ç¬¬ä¸€ä¸ªé—®é¢˜ï¼šç»Ÿä¸€çš„è½åœ°é¡µ"></a>å¯¹äºè¦è§£å†³çš„ç¬¬ä¸€ä¸ªé—®é¢˜ï¼šç»Ÿä¸€çš„è½åœ°é¡µ</h3><p>æˆ‘ä»¬æŠŠå¦‚ï¼šæ‰«å°ç¨‹åºç ã€å…¬ä¼—å·èœå•ã€å…¬ä¼—å·æ–‡ç« ç­‰æ–¹å¼æ‰“å¼€å°ç¨‹åºæŸä¸ªé¡µé¢çš„è·¯å¾„ç§°ä¸ºã€Œå¤–éƒ¨è·¯ç”±ã€ã€‚</p>
<p>æ ¹æ®å°ç¨‹åºçš„è®¾è®¡ï¼Œæš´éœ²ç»™å¤–éƒ¨çš„è¿æ¥æ˜¯çœŸå®çš„é¡µé¢è·¯å¾„ï¼Œå¦‚ï¼š<code>/pages/home/index</code>ï¼Œè¯¥è®¾è®¡åœ¨å®è·µä¸­å­˜åœ¨çš„å¼Šç«¯ï¼š<strong>å„ä¸ªè½åœ°é¡µåˆ†æ•£ï¼ŒåæœŸä¿®æ”¹çœŸå®æ–‡ä»¶è·¯å¾„éš¾åº¦å¤§ã€‚</strong></p>
<p>åœ¨ <strong>ã€Œä¸­é•¿ç”Ÿå‘½å‘¨æœŸã€</strong> äº§å“ä¸­ï¼Œéšç€äº§å“çš„è¿­ä»£ï¼Œæˆ‘ä»¬éš¾å…ä¼šé‡åˆ°é¡¹ç›®çš„é‡æ„ã€‚å¦‚æœåˆ†å‘å‡ºå»çš„éƒ½æ˜¯æ²¡ç»è¿‡å¤„ç†çš„çœŸå®è·¯å¾„çš„è¯ï¼Œæˆ‘ä»¬é‡æ„æ—¶å°±ä¼šæŸæ‰‹æŸè„šï¼Œè¦åšå¾ˆå¤šçš„å…¼å®¹æ“ä½œã€‚å› ä¸ºä½ ä¸çŸ¥é“ï¼Œåˆ†å‘å‡ºå»çš„å°ç¨‹åºäºŒç»´ç ï¼Œ æœ‰å¤šå°‘è¢«æ‰“å°åˆ°å®ä½“ç‰©æ–™ä¸­ã€‚</p>
<p>é‚£ä¹ˆï¼Œ<strong>ã€Œè™šæ‹Ÿè·¯ç”±ã€+ã€Œè½åœ°ä¸­è½¬ã€</strong> çš„ç­–ç•¥å°±æ˜¾å¾—åŸºæœ¬ä¸”é‡è¦äº†ã€‚</p>
<p>ã€Œè™šæ‹Ÿè·¯ç”±ã€çš„åŠŸèƒ½ï¼Œ<strong>Router </strong>æ¨¡å—ç»™æˆ‘ä»¬æä¾›äº†æ”¯æŒäº†ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å¯¹å¤–æä¾›ä¸€ä¸ªç»Ÿä¸€çš„è½åœ°é¡µé¢ï¼Œè®©å®ƒæ¥å®Œæˆå¯¹å†…éƒ¨è·¯ç”±çš„ä¸­è½¬ã€‚</p>
<p>åŸºæœ¬é€»è¾‘ï¼š</p>
<ol>
<li>åˆ†å‘å‡ºå»çš„çœŸå®è·¯ç”±ï¼ŒæŒ‡å‘åˆ°å”¯ä¸€çš„è½åœ°é¡µé¢ï¼Œå¦‚ï¼š<code>$LAND_PAGE: /pages/land-page/index</code></li>
<li>ç”±è¿™ä¸ªè½åœ°é¡µé¢ï¼Œè¿›è¡Œå†…éƒ¨è·¯ç”±çš„é‡å®šå‘è½¬å‘ï¼Œé€šè¿‡æ¥æ”¶ å‚æ•°ï¼Œå¦‚ï¼š<code>path=/user&amp;name=jc&amp;age=18</code></li>
</ol>
<p><img src="https://raw.githubusercontent.com/JerryC8080/figure-bed/master/img/20210309185153.png" alt="æ™®é€šæ¨¡å¼"></p>
<p>åœ¨ä»£ç å±‚é¢ä¸Šï¼Œæˆ‘ä»¬å¸Œæœ›èƒ½å®ç°è¿™æ ·çš„ä½¿ç”¨ï¼š</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// /pages/land-page/index.ts</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> landTransfer = <span class="keyword">new</span> LandTransfer(landTransferOptions);</div><div class="line"></div><div class="line">Page(&#123;</div><div class="line">  onLoad(options) &#123;</div><div class="line">      landTransfer</div><div class="line">        .run(options)</div><div class="line">        .then(() =&gt; &#123;...&#125;)</div><div class="line">        .catch(() =&gt; &#123;...&#125;);</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>ç„¶åé’ˆå¯¹ TSï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ç”¨è£…é¥°å™¨ç‰ˆæœ¬ï¼Œæ›´åŠ ç®€ä¾¿ï¼š</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; landTransferDecorator &#125; from <span class="string">'wxapp-router'</span>;</div><div class="line"></div><div class="line">Page(&#123;</div><div class="line">  @landTransferDecorator(landTransferOptions)</div><div class="line">  onLoad(options) &#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">  &#125;,</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h3 id="å¯¹äºç¬¬äºŒä¸ªè¦è§£å†³çš„é—®é¢˜ï¼šçŸ­é“¾å‚æ•°"><a href="#å¯¹äºç¬¬äºŒä¸ªè¦è§£å†³çš„é—®é¢˜ï¼šçŸ­é“¾å‚æ•°" class="headerlink" title="å¯¹äºç¬¬äºŒä¸ªè¦è§£å†³çš„é—®é¢˜ï¼šçŸ­é“¾å‚æ•°"></a>å¯¹äºç¬¬äºŒä¸ªè¦è§£å†³çš„é—®é¢˜ï¼šçŸ­é“¾å‚æ•°</h3><p>å¾®ä¿¡å°ç¨‹åºä¸»è¦æä¾›äº†ä¸¤ä¸ªæ¥å£å»ç”Ÿæˆå°ç¨‹åºç ï¼š</p>
<ol>
<li><a href="https://developers.weixin.qq.com/miniprogram/dev/api-backend/open-api/qr-code/wxacode.get.html" target="_blank" rel="external">wxacode.get</a>: è·å–å°ç¨‹åºç ï¼Œé€‚ç”¨äºéœ€è¦çš„ç æ•°é‡è¾ƒå°‘çš„ä¸šåŠ¡åœºæ™¯ã€‚<strong>é€šè¿‡è¯¥æ¥å£ç”Ÿæˆçš„å°ç¨‹åºç ï¼Œæ°¸ä¹…æœ‰æ•ˆï¼Œæ•°é‡é™åˆ¶ä¸º 100,000</strong> ä¸ª</li>
<li><a href="https://developers.weixin.qq.com/miniprogram/dev/api-backend/open-api/qr-code/wxacode.getUnlimited.html" target="_blank" rel="external">wxacode.getUnlimited</a>: è·å–å°ç¨‹åºç ï¼Œé€‚ç”¨äºéœ€è¦çš„ç æ•°é‡æå¤šçš„ä¸šåŠ¡åœºæ™¯ã€‚<strong>é€šè¿‡è¯¥æ¥å£ç”Ÿæˆçš„å°ç¨‹åºç ï¼Œæ°¸ä¹…æœ‰æ•ˆï¼Œæ•°é‡æš‚æ— é™åˆ¶ã€‚</strong></li>
</ol>
<p>ç¬¬ä¸€ç§æ–¹å¼ï¼Œ<code>wxacode.get</code> æ•°é‡é™åˆ¶ä¸º 10w ä¸ªï¼Œè™½ç„¶é‡å¾ˆå¤§äº†ï¼Œç»å¤§å¤šæ•°çš„å°ç¨‹åºå¯èƒ½ç”¨ä¸åˆ°è¿™ä¸ªé‡ã€‚</p>
<p>ä½†å¦‚æœæˆ‘ä»¬è¿è¥çš„æ˜¯ä¸€ä¸ªä¸­å¤§å‹ç”µå•†å°ç¨‹åºçš„è¯ï¼Œå‡å¦‚ï¼š1w ç§å•†å“ x 10 ç§å•†å“è§„æ ¼ï¼Œé‚£å°±ä¼šè¶…è¿‡è¿™ä¸ªæ•°é‡ã€‚åˆ°æ—¶å€™å†è¿›è¡Œæ”¹é€ ï¼Œå°±å›°éš¾äº†ã€‚</p>
<p>æ‰€ä»¥ï¼Œå¦‚æœæŠ±ç€æ˜¯è¿è¥ä¸€ä¸ª <strong>ã€Œä¸­é•¿ç”Ÿå‘½å‘¨æœŸã€</strong> çš„äº§å“çš„è¯ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨ç¬¬äºŒç§æ–¹å¼ï¼š<code>wxacode.getUnlimited</code></p>
<p>ä¸å°½äººæ„çš„æ˜¯ï¼Œè™½ç„¶å®ƒæ²¡æœ‰æ•°é‡é™åˆ¶ï¼Œä½†æ˜¯å¯¹å‚æ•°ä¼šæœ‰ 32 ä¸ªå­—ç¬¦çš„é™åˆ¶ï¼Œæ˜¾ç„¶æ˜¯ä¸å¤Ÿç”¨çš„ï¼ˆä¸€ä¸ª uuid å°± 32 å­—ç¬¦äº†ï¼‰ã€‚</p>
<p>å¯¹äºè¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ã€ŒçŸ­é“¾å‚æ•°ã€çš„å½¢å¼è§£å†³ï¼Œç”±äº<a href="https://developers.weixin.qq.com/miniprogram/dev/api-backend/open-api/qr-code/wxacode.getUnlimited.html" target="_blank" rel="external">wxacode.getUnlimited</a> ä¼šé€šè¿‡ <code>scene</code>å­—æ®µä½œä¸º query å‚æ•°ä¼ é€’ç»™å°ç¨‹åºçš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>scene</code>å‚æ•°æ¥å®ç°çŸ­é“¾æœåŠ¡ï¼Œè¿™éœ€è¦åç«¯é…åˆã€‚</p>
<p>å‰åç«¯äº¤äº’å¦‚ä¸‹ï¼š</p>
<p><img src="https://raw.githubusercontent.com/JerryC8080/figure-bed/master/img/20210312182826.png" alt="SceneçŸ­é“¾æ¨¡å¼"></p>
<ol>
<li>å½“å°ç¨‹åºéœ€è¦ç”Ÿæˆå°ç¨‹åºç çš„æ—¶å€™ï¼Œè¯·æ±‚åç«¯æä¾›çš„æ¥å£ï¼Œä¾‹å¦‚ï¼š<code>/api/encodeShortParams</code></li>
<li>åç«¯æŠŠå†…å®¹è½¬æ¢ä¸º 32 å­—ç¬¦å†…çš„å­—ç¬¦ä¸²ï¼Œå­˜å‚¨åˆ°æ•°æ®åº“ä¸­ã€‚</li>
<li>åç«¯é€šè¿‡ <a href="https://developers.weixin.qq.com/miniprogram/dev/api-backend/open-api/qr-code/wxacode.getUnlimited.html" target="_blank" rel="external">wxacode.getUnlimited</a> æ¥å£ï¼Œä»¥çŸ­é“¾å­—ç¬¦ä¸²ä½œä¸º <code>scene</code>çš„å€¼ï¼Œä»¥å•†å®šå¥½çš„ç»Ÿä¸€è½åœ°é¡µ <code>$LAND_PAGE</code>ä½œä¸º <code>page</code>å€¼ï¼Œç”Ÿæˆå°ç¨‹åºç ã€‚</li>
<li>å½“é€šè¿‡å°ç¨‹åºç è¿›å…¥å°ç¨‹åºï¼Œå°ç¨‹åºè·å–åˆ° <code>scene</code>å‚æ•°ï¼Œè¯·æ±‚åç«¯æä¾›çš„æ¥å£ï¼Œä¾‹å¦‚ï¼š<code>/api/decodeShrotParams</code></li>
<li>å°ç¨‹åºç†è§£å†…å®¹ï¼Œè·³è½¬åˆ°ç›®æ ‡é¡µé¢ä¸­å»ã€‚</li>
</ol>
<p>è€Œå‰ç«¯å¯¹äºç»Ÿä¸€è½åœ°é¡µçš„é€»è¾‘å¤„ç†ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨ç¬¬ä¸€ä¸ªé—®é¢˜çš„åŸºç¡€ä¸Šï¼Œå¢åŠ ä¸€ä¸ª<strong>è½¬æ¢çŸ­é“¾å‚æ•°å†…å®¹</strong>çš„é€»è¾‘å°±è¡Œäº†ï¼š</p>
<p><img src="https://raw.githubusercontent.com/JerryC8080/figure-bed/master/img/20210309185154.png" alt="çŸ­é“¾æ¨¡å¼"></p>
<p>ä»£ç å±‚é¢ä¸Šï¼Œæˆ‘ä»¬æˆ‘ä»¬åªéœ€è¦å¤šå®šä¹‰è½¬æ¢çŸ­é“¾å‚æ•°çš„æ–¹å¼ï¼š<code>convertScenePrams</code></p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// in /pages/land-page/index.js</span></div><div class="line"><span class="keyword">import</span> &#123; landTransferDecorator &#125; from <span class="string">'wxapp-router'</span>;</div><div class="line"></div><div class="line"><span class="keyword">const</span> landTransferOptions = &#123;</div><div class="line">  <span class="comment">// æ­¤å¤„æ¥æ”¶ onLoad(options) ä¸­çš„ options.scene</span></div><div class="line">  convertSceneParams: (sceneParams) =&gt; &#123;</div><div class="line">    <span class="keyword">return</span> API.convertScene(&#123; sceneParams &#125;).then((content) =&gt; &#123;</div><div class="line">      <span class="comment">// å‡å¦‚åç«¯å­˜çš„æ˜¯ JSON å­—ç¬¦ä¸²ï¼Œå‰ç«¯decode</span></div><div class="line">      <span class="comment">// è¦æ±‚ content = &#123; path: '/home', a: 1, b:2 &#125;</span></div><div class="line">      <span class="keyword">return</span> <span class="built_in">JSON</span>.parse(content);</div><div class="line">    &#125;);</div><div class="line">  &#125;,</div><div class="line">&#125;;</div><div class="line"></div><div class="line">Page(&#123;</div><div class="line">  @landTransferDecorator(landTransferOptions)</div><div class="line">  onLoad(options) &#123;</div><div class="line">    <span class="comment">// ...</span></div><div class="line">  &#125;,</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>è€Œå…¶ä¸­çš„ <code>API.convertScene</code> å°±å¯¹æ¥æœåŠ¡ç«¯æä¾› HTTP æ¥å£æœåŠ¡æ¥å®Œæˆã€‚</p>
<h3 id="LandTransfer-æ¨¡å—è®¾è®¡"><a href="#LandTransfer-æ¨¡å—è®¾è®¡" class="headerlink" title="LandTransfer æ¨¡å—è®¾è®¡"></a>LandTransfer æ¨¡å—è®¾è®¡</h3><p><img src="https://raw.githubusercontent.com/JerryC8080/figure-bed/master/img/20210321202654.png" alt="land-transfer"></p>
<h2 id="æ›´å¥½çš„å¼€å‘ä½“éªŒ"><a href="#æ›´å¥½çš„å¼€å‘ä½“éªŒ" class="headerlink" title="æ›´å¥½çš„å¼€å‘ä½“éªŒ"></a>æ›´å¥½çš„å¼€å‘ä½“éªŒ</h2><h3 id="Typescript-Router"><a href="#Typescript-Router" class="headerlink" title="Typescript + Router"></a>Typescript + Router</h3><p>å¯¹äºå°ç¨‹åºå†…éƒ¨çš„è·¯ç”±è·³è½¬ï¼Œæˆ‘ä»¬é™¤äº†æŒ‡å®šä¸€ä¸ªå­—ç¬¦ä¸²çš„è·¯ç”±ï¼Œæˆ‘ä»¬æ˜¯å¦ä¹Ÿå¯ä»¥é€šè¿‡é“¾å¼è°ƒç”¨ï¼Œåƒè°ƒç”¨å‡½æ•°é‚£æ ·å»è·³è½¬é¡µé¢å‘¢ï¼Ÿç±»ä¼¼è¿™æ ·ï¼›</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">routes.pages.user.go(&#123; name: <span class="string">'jc'</span> &#125;);</div></pre></td></tr></table></figure>
<p>è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼š</p>
<ol>
<li>æ›´è‡ªç„¶çš„è°ƒç”¨æ–¹å¼ã€‚</li>
<li>èƒ½ç»“åˆ TSï¼Œæ¥åšåˆ°ç±»å‹æç¤ºå’Œè”æƒ³ã€‚</li>
</ol>
<p>ç”±äºäº‹å…ˆ <code>wxapp-router</code> å¹¶ä¸çŸ¥é“å¼€å‘è€…éœ€è¦æ³¨å†Œçš„è·¯ç”±æ˜¯ä»€ä¹ˆæ ·çš„ï¼Œæ‰€ä»¥è·¯ç”±çš„ TS å£°æ˜æ–‡ä»¶ï¼Œéœ€è¦å¼€å‘è€…æ¥å®šä¹‰ã€‚</p>
<p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬åœ¨é¡¹ç›®ä¸­ç»´æŠ¤ä¸€ä»½è·¯ç”±æ–‡ä»¶ï¼š</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// config/routes.ts</span></div><div class="line"></div><div class="line"><span class="comment">// åˆ›å»ºè·¯ç”±å®ä¾‹</span></div><div class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> Router();</div><div class="line"></div><div class="line"><span class="keyword">const</span> routesConfig = [&#123;</div><div class="line">  path: <span class="string">'/user'</span>,</div><div class="line">  route: <span class="string">'/pages/user/index'</span>,</div><div class="line">&#125;, &#123;</div><div class="line">  path: <span class="string">'/goods'</span>,</div><div class="line">  route: <span class="string">'/pages/goods/index'</span>,</div><div class="line">&#125;]ï¼›</div><div class="line"></div><div class="line"><span class="keyword">type</span> RoutesType &#123;</div><div class="line">  paegs: &#123;</div><div class="line">    user: Route&lt;&#123;name: <span class="built_in">string</span>&#125;&gt;,</div><div class="line">    goods: Route,</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// æ³¨å†Œè·¯ç”±</span></div><div class="line">router.batchRegister(routesConfig);</div><div class="line"></div><div class="line"><span class="comment">// è·å– routes</span></div><div class="line"><span class="keyword">const</span> routes: RoutesType = router.getRoutes();</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> routes;</div></pre></td></tr></table></figure>
<p>ç„¶ååœ¨åˆ«çš„åœ°æ–¹ä½¿ç”¨å®ƒï¼š</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> routes from <span class="string">'./routes.ts'</span>;</div><div class="line"></div><div class="line">routes.pages.user.go(&#123; name: <span class="string">'jc'</span> &#125;);</div></pre></td></tr></table></figure>
<h3 id="æ™ºèƒ½ç”Ÿæˆè·¯ç”±é…ç½®"><a href="#æ™ºèƒ½ç”Ÿæˆè·¯ç”±é…ç½®" class="headerlink" title="æ™ºèƒ½ç”Ÿæˆè·¯ç”±é…ç½®"></a>æ™ºèƒ½ç”Ÿæˆè·¯ç”±é…ç½®</h3><p>å¦‚æœè·¯ç”±å˜å¤šçš„æ—¶å€™ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å¯¹æ¯ä¸ªè·¯ç”±æ‰‹åŠ¨å»ç¼–å†™ <code>RoutesType</code> çš„è¯ï¼Œå°±æœ‰ç‚¹éš¾å—äº†ã€‚</p>
<p>åœ¨å°ç¨‹åºä¸­ï¼Œæˆ‘ä»¬æŠŠæ­£å¼è·¯ç”±éƒ½é…ç½®åˆ° <code>app.json</code> ï¼Œé‚£ä¹ˆåœ¨éµå¾ªæ—¢å®šçš„é¡¹ç›®ç»“æ„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è‡ªåŠ¨æ„å»ºï¼Œå®Œæˆå¤§éƒ¨åˆ†å·¥ä½œï¼Œä¾‹å¦‚ï¼š</p>
<ol>
<li>æ™ºèƒ½æ³¨å†Œè·¯ç”±</li>
<li>æ™ºèƒ½è¯†åˆ«é¡µé¢å…¥å‚å£°æ˜</li>
</ol>
<h3 id="è‡ªå®šä¹‰ç»„ä»¶è·³è½¬"><a href="#è‡ªå®šä¹‰ç»„ä»¶è·³è½¬" class="headerlink" title="è‡ªå®šä¹‰ç»„ä»¶è·³è½¬"></a>è‡ªå®šä¹‰ç»„ä»¶è·³è½¬</h3><p>ä»¥ä¸Šéƒ½æ˜¯è„šæœ¬å±‚é¢çš„ä½¿ç”¨ï¼Œå°ç¨‹åºä¸­è¿˜æœ‰ <code>wxml</code>, æˆ‘ä»¬å¸Œæœ›èƒ½åœ¨æœ‰ä¸ªç»„ä»¶å¿«é€Ÿä½¿ç”¨ï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">Router</span> <span class="attr">path</span>=<span class="string">"/pageA"</span> <span class="attr">query</span>=<span class="string">"&#123;&#123;pageAQuery&#125;&#125;"</span>&gt;</span><span class="tag">&lt;/<span class="name">Router</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">Router</span> <span class="attr">path</span>=<span class="string">"/pageB"</span> <span class="attr">query</span>=<span class="string">"&#123;&#123;pageBQuery&#125;&#125;"</span> <span class="attr">type</span>=<span class="string">"redirectTo"</span>&gt;</span><span class="tag">&lt;/<span class="name">Router</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">Router</span> <span class="attr">path</span>=<span class="string">"/pageC/katy"</span>&gt;</span><span class="tag">&lt;/<span class="name">Router</span>&gt;</span></div></pre></td></tr></table></figure>
<p>é‚£ä¹ˆï¼Œå®ç°ä¸€ä¸ªè‡ªå®šä¹‰ç»„ä»¶ï¼Œç„¶åæŠŠ <strong>Router</strong>æ¨¡å—åŒ…è£…ä¸€ä¸‹ï¼Œé—®é¢˜å°±ä¸å¤§äº†ã€‚</p>
<p>ç¤ºä¾‹ä»£ç ï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">// components/router.wxml</div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"wxapp-router"</span> <span class="attr">bind:tap</span>=<span class="string">"gotoPage"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">slot</span> /&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// components/router.ts</span></div><div class="line"></div><div class="line">Component(&#123;</div><div class="line">    properties: &#123;</div><div class="line">        path: <span class="built_in">String</span>,</div><div class="line">        <span class="keyword">type</span>: &#123;</div><div class="line">            <span class="keyword">type</span>: <span class="built_in">String</span>,</div><div class="line">            value: <span class="string">'gotoPage'</span></div><div class="line">        &#125;,</div><div class="line">        route: <span class="built_in">String</span>,</div><div class="line">        query: <span class="built_in">Object</span>,</div><div class="line">        delta: <span class="built_in">Number</span>,</div><div class="line">        setData: <span class="built_in">Object</span>,</div><div class="line">    &#125;,</div><div class="line"></div><div class="line">    methods: &#123;</div><div class="line">        gotoPage(event) &#123;</div><div class="line">            <span class="keyword">const</span> router = getApp().router;</div><div class="line">            <span class="keyword">const</span> &#123; path, route, <span class="keyword">type</span>, query&#125; = <span class="keyword">this</span>.data;</div><div class="line">            <span class="keyword">const</span> toPath = route || path;</div><div class="line"></div><div class="line">            <span class="keyword">if</span> ([<span class="string">'gotoPage'</span>, <span class="string">'navigateTo'</span>, <span class="string">'switchTab'</span>, <span class="string">'redirectTo'</span>].includes(<span class="keyword">type</span>)) &#123;</div><div class="line">                (router as <span class="built_in">any</span>)[<span class="keyword">type</span>](toPath, query);</div><div class="line">            &#125;</div><div class="line"></div><div class="line">            <span class="keyword">if</span> (<span class="keyword">type</span> === <span class="string">'navigateBack'</span>) &#123;</div><div class="line">                <span class="keyword">const</span> &#123; delta, setData &#125; = <span class="keyword">this</span>.data;</div><div class="line">                router.navigateBack(&#123; delta &#125;, &#123; setData &#125;)</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<h2 id="æ•´ä½“æ¶æ„å›¾"><a href="#æ•´ä½“æ¶æ„å›¾" class="headerlink" title="æ•´ä½“æ¶æ„å›¾"></a>æ•´ä½“æ¶æ„å›¾</h2><p>æœ€åï¼Œæˆ‘ä»¬æ¥æ•´ä½“å›é¡¾ä¸€ä¸‹å„æ¨¡å—çš„è®¾è®¡</p>
<p><img src="https://raw.githubusercontent.com/JerryC8080/figure-bed/master/img/20210321202700.png" alt="æ¶æ„è®¾è®¡"></p>
<ol>
<li>Navigatorï¼šå°è£…å¾®ä¿¡åŸç”Ÿè·¯ç”± APIï¼Œæä¾›æ™ºèƒ½è·³è½¬ç­–ç•¥ã€‚</li>
<li>LandTransferï¼šæä¾›è½åœ°é¡µä¸­è½¬ç­–ç•¥ã€‚</li>
<li>RouteMatcherï¼šæä¾›åŠ¨æ€è·¯ç”±å‚æ•°åŒ¹é…åŠŸèƒ½ã€‚</li>
<li>Route: ä¸ºæ¯ä¸ªè·¯å¾„åˆ›å»ºè·¯ç”±å™¨ã€‚</li>
<li>Routerï¼šæ•´åˆå†…éƒ¨å„æ¨¡å—ï¼Œå¯¹å¤–æä¾›ä¼˜é›…çš„è°ƒç”¨æ–¹å¼ã€‚</li>
<li>Loggerï¼šå†…éƒ¨æ—¥å¿—å™¨ã€‚</li>
<li>Path-to-regexp: å¼€æºç¤¾åŒºçš„è·¯ç”±åŒ¹é…å¼•æ“ã€‚</li>
</ol>
<h1 id="æœ€åçš„æœ€å"><a href="#æœ€åçš„æœ€å" class="headerlink" title="æœ€åçš„æœ€å"></a>æœ€åçš„æœ€å</h1><p>é‰´äºå†™è¿‡å¾ˆå¤šçš„å®æˆ˜ç±»çš„æ–‡ç« ï¼Œä¼šæœ‰ä¸å°‘åŒå­¦æƒ³è¦åˆ°æ•´ä½“çš„ç¤ºä¾‹ä»£ç ï¼Œè¿™æ¬¡æˆ‘å°±ç´¢æ€§å†™äº†ä¸€ä¸ªå·¥å…·ï¼ŒEnjoy it!</p>
<p><a href="https://github.com/JerryC8080/wxapp-router" target="_blank" rel="external">wxapp-router</a>ï¼š ğŸ›µ The router for Wechat Miniprogram</p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h2&gt;&lt;p&gt;åœ¨å¾®ä¿¡å°ç¨‹åºç”±ä¸€ä¸ª &lt;code&gt;App()&lt;/code&gt;å®ä¾‹ï¼Œå’Œä¼—å¤š&lt;code&gt;Page()&lt;/code&gt;ç»„æˆã€‚è€Œåœ¨å°ç¨‹åºä¸­æ‰€æœ‰é¡µé¢çš„è·¯ç”±å…¨
    
    </summary>
    
      <category term="æ¬ç –ç å†œ" scheme="http://huang-jerryc.com/categories/%E6%90%AC%E7%A0%96%E7%A0%81%E5%86%9C/"/>
    
    
      <category term="å¾®ä¿¡å°ç¨‹åº" scheme="http://huang-jerryc.com/tags/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/"/>
    
  </entry>
  
  <entry>
    <title>Module Seed: ä¸€å¥—ä¼˜é›…çš„ Github å·¥ä½œæµ</title>
    <link href="http://huang-jerryc.com/2021/01/28/github-workflow/"/>
    <id>http://huang-jerryc.com/2021/01/28/github-workflow/</id>
    <published>2021-01-28T09:51:00.000Z</published>
    <updated>2021-01-28T09:52:36.379Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Motivation"><a href="#Motivation" class="headerlink" title="Motivation"></a>Motivation</h2><p>å¹³æ—¶å–œæ¬¢å†™ä¸€äº› NPM æ¨¡å—ï¼Œå†™å¾—å¤šäº†ï¼Œæ•´ç†å‡ºä¸€å¥—å·¥ä½œæµï¼Œè§£æ”¾ä¸€äº›é‡å¤çš„æ­å»ºå·¥ä½œã€‚<br>å¦‚æœä½ å–œæ¬¢ï¼Œè¯·ç›´æ¥æ‹¿å»ç”¨ï¼Œä¹Ÿå¯ä»¥å‚ç…§è¯¥é¡¹ç›®çš„ä¸€äº› Feature ï¼Œç»™ä½ ä¸€äº›æç¤ºä¸å¸®åŠ©ã€‚</p>
<h2 id="Feature"><a href="#Feature" class="headerlink" title="Feature"></a>Feature</h2><ol>
<li>æ”¯æŒ Typescript</li>
<li>æ”¯æŒå•å…ƒæµ‹è¯•ï¼Œä¸æµ‹è¯•è¦†ç›–ç‡</li>
<li>å¿«é€Ÿç”Ÿæˆæ–‡æ¡£ç«™ç‚¹</li>
<li>æ¥å…¥ Circle CLIï¼Œæ„å»ºã€å‘åŒ…ã€æ–‡æ¡£ç«™ç‚¹ä¸€æ¡é¾™æœåŠ¡</li>
<li>è§„èŒƒ ESLint + Prettier</li>
<li>å¿«é€Ÿç”Ÿæˆ Change Log</li>
<li>ç”ŸæˆåŒæ—¶æ”¯æŒ CommonJS å’Œ ES Module çš„ NPM åŒ…</li>
</ol>
<h2 id="Download"><a href="#Download" class="headerlink" title="Download"></a>Download</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">git clone git@github.com:JerryC8080/module-seed.git</div></pre></td></tr></table></figure>
<h2 id="Usage"><a href="#Usage" class="headerlink" title="Usage"></a>Usage</h2><h3 id="1-Architecture"><a href="#1-Architecture" class="headerlink" title="1. Architecture"></a>1. Architecture</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">.</div><div class="line">â”œâ”€â”€ .circleci // CircleCI è„šæœ¬</div><div class="line">â”‚   â”œâ”€â”€ config.yml</div><div class="line">â”œâ”€â”€ coverage // è‡ªåŠ¨ç”Ÿæˆçš„æµ‹è¯•è¦†ç›–ç‡æŠ¥å‘Š</div><div class="line">â”œâ”€â”€ docs  // è‡ªåŠ¨ç”Ÿæˆçš„æ–‡æ¡£</div><div class="line">â”œâ”€â”€ build  // æ„å»ºä»£ç </div><div class="line">â”‚   â”œâ”€â”€ main  // å…¼å®¹ CommonJS</div><div class="line">â”‚   â”‚   â”œâ”€â”€ index.d.ts</div><div class="line">â”‚   â”‚   â”œâ”€â”€ index.js</div><div class="line">â”‚   â”‚   â””â”€â”€ lib</div><div class="line">â”‚   â””â”€â”€ module  // å…¼å®¹ ES Module</div><div class="line">â”‚       â”œâ”€â”€ index.d.ts</div><div class="line">â”‚       â”œâ”€â”€ index.js</div><div class="line">â”‚       â””â”€â”€ lib</div><div class="line">â”œâ”€â”€ src  // æºç </div><div class="line">â”‚   â”œâ”€â”€ index.ts</div><div class="line">â”‚   â””â”€â”€ lib</div><div class="line">â”‚       â”œâ”€â”€ hello-world.spec.ts // å•å…ƒæµ‹è¯•</div><div class="line">â”‚       â””â”€â”€ hello-world.ts</div><div class="line">â”œâ”€â”€ CHANGELOG.md</div><div class="line">â”œâ”€â”€ LICENSE</div><div class="line">â”œâ”€â”€ README.md</div><div class="line">â”œâ”€â”€ package.json</div><div class="line">â”œâ”€â”€ tsconfig.json</div><div class="line">â””â”€â”€ tsconfig.module.json</div></pre></td></tr></table></figure>
<h3 id="2-Npm-Script"><a href="#2-Npm-Script" class="headerlink" title="2. Npm Script"></a>2. Npm Script</h3><table>
<thead>
<tr>
<th>Script</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>build</td>
<td>æ„å»ºä»£ç ï¼Œç”Ÿæˆ ./build æ–‡ä»¶å¤¹</td>
</tr>
<tr>
<td>fix</td>
<td>å¿«é€Ÿæ ¼å¼åŒ–ä»£ç </td>
</tr>
<tr>
<td>test</td>
<td>æ„å»ºå•å…ƒæµ‹è¯•</td>
</tr>
<tr>
<td>watch:build</td>
<td>åŠ¨æ€æ„å»ºä»£ç ï¼Œç”¨äºå¼€å‘æ¨¡å¼</td>
</tr>
<tr>
<td>watch:test</td>
<td>åŠ¨æ€æ„å»ºå•å…ƒæµ‹è¯•ï¼Œç”¨äºå¼€å‘æ¨¡å¼</td>
</tr>
<tr>
<td>cov</td>
<td>æ„å»ºå•å…ƒæµ‹è¯•è¦†ç›–ç‡ï¼Œç”Ÿæˆ ./coverage æ–‡ä»¶å¤¹</td>
</tr>
<tr>
<td>doc</td>
<td>æ„å»ºæ–‡æ¡£ç«™ç‚¹ï¼Œç”Ÿæˆ ./docs æ–‡ä»¶å¤¹</td>
</tr>
<tr>
<td>doc:publish</td>
<td>å‘å¸ƒæ–‡æ¡£ç«™ç‚¹åˆ° github pages</td>
</tr>
<tr>
<td>version</td>
<td>å¼ºåˆ¶ä»¥ patch æ¨¡å¼æ›´æ–° versionï¼Œå¦‚ï¼šv0.0.1 â†’ v0.0.2</td>
</tr>
</tbody>
</table>
<h3 id="3-Coverage"><a href="#3-Coverage" class="headerlink" title="3. Coverage"></a>3. Coverage</h3><p>é€šè¿‡è¿è¡Œ <code>npm run cov</code>ï¼Œå‘½ä»¤ä¼šæ„å»ºå•å…ƒæµ‹è¯•ï¼Œå¹¶ä¸”è¾“å‡ºç½‘é¡µç‰ˆæœ¬çš„æµ‹è¯•æŠ¥å‘Šï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">open coverage/index.html</div></pre></td></tr></table></figure>
<p><img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/img/20201212173414.png" alt="coverage"></p>
<h3 id="4-Docs"><a href="#4-Docs" class="headerlink" title="4. Docs"></a>4. Docs</h3><p>é€šè¿‡è¿è¡Œ <code>npm run doc</code>ï¼Œä¼šæ„å»º TS API æ–‡æ¡£ï¼Œå¹¶ä¸”è¾“å‡ºç½‘é¡µç‰ˆæœ¬ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">open docs/index.html</div></pre></td></tr></table></figure>
<p><img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/img/20201212173820.png" alt="docs"></p>
<h3 id="5-CircleCI-Config"><a href="#5-CircleCI-Config" class="headerlink" title="5. CircleCI Config"></a>5. CircleCI Config</h3><p>æœ¬é¡¹ç›®é€‰æ‹© <a href="https://circleci.com/" target="_blank" rel="external">CircleCI</a> æ¥å®Œæˆé¡¹ç›®æ„å»ºã€å‘å¸ƒ NPMã€å‘å¸ƒæ–‡æ¡£ç«™ç‚¹ç­‰è‡ªåŠ¨åŒ–æ„å»ºå·¥ä½œã€‚</p>
<h4 id="1-Add-Repo-to-CircleCI"><a href="#1-Add-Repo-to-CircleCI" class="headerlink" title="1. Add Repo to CircleCI"></a>1. Add Repo to CircleCI</h4><p><img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/img/20201212174309.png" alt=""></p>
<p><img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/img/20201212174310.png" alt=""></p>
<h4 id="2-Test-Coverage-to-Coveralls"><a href="#2-Test-Coverage-to-Coveralls" class="headerlink" title="2. Test Coverage to Coveralls"></a>2. Test Coverage to Coveralls</h4><p>å¦‚æœæƒ³æ‹¥æœ‰ä¸€ä¸ªè¿™æ ·çš„ Status: <img src="https://coveralls.io/repos/github/JerryC8080/module-seed/badge.svg?branch=master" alt="Coverage Status"></p>
<p>éœ€è¦æŠŠä½ çš„ repo æ·»åŠ åˆ° <a href="https://coveralls.io/" target="_blank" rel="external">coveralls.io</a></p>
<p><img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/img/20201212175434.png" alt=""></p>
<p><img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/img/20201212175435.png" alt=""></p>
<p>ç„¶åï¼Œåœ¨ CircleCI æ·»åŠ ç¯å¢ƒå˜é‡ <code>COVERALLS_REPO_TOKEN</code></p>
<p><img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/img/20201212175703.png" alt=""></p>
<p><img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/img/20201212175850.png" alt=""></p>
<p>é‚£ä¹ˆï¼Œæ¯æ¬¡ CircleCI å‘ç”Ÿæ„å»ºçš„æ—¶å€™ï¼Œå°±ä¼šä¸ŠæŠ¥å•å…ƒæµ‹è¯•è¦†ç›–ç‡åˆ° coveralls å»ã€‚</p>
<p>å‚è€ƒ <code>.circleci/config.yml</code> ç›¸å…³è„šæœ¬:</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line"><span class="attr">upload-coveralls:</span></div><div class="line">  &lt;&lt;: <span class="meta">*defaults</span></div><div class="line"><span class="attr">  steps:</span></div><div class="line"><span class="attr">    - attach_workspace:</span></div><div class="line"><span class="attr">        at:</span> ~/repo</div><div class="line"><span class="attr">    - run:</span></div><div class="line"><span class="attr">        name:</span> Test Coverage</div><div class="line"><span class="attr">        command:</span> npm run cov</div><div class="line"><span class="attr">    - run:</span></div><div class="line"><span class="attr">        name:</span> Report for coveralls</div><div class="line"><span class="attr">        command:</span> <span class="string">|</span></div><div class="line">          npm install coveralls --save-dev</div><div class="line">          ./node_modules/.bin/nyc report --reporter=text-lcov | ./node_modules/.bin/coveralls</div><div class="line"><span class="attr">    - store_artifacts:</span></div><div class="line"><span class="attr">        path:</span> coverage</div><div class="line">...</div></pre></td></tr></table></figure>
<h4 id="3-Doc-Site-to-Github-Pages"><a href="#3-Doc-Site-to-Github-Pages" class="headerlink" title="3. Doc Site to Github Pages"></a>3. Doc Site to Github Pages</h4><p>æœ¬åœ°å¯ä»¥é€šè¿‡å‘½ä»¤æ¥æ„å»ºå’Œå‘å¸ƒæ–‡æ¡£ç«™ç‚¹åˆ° Github Pages</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">npm run doc</div><div class="line">npm run doc:publish</div></pre></td></tr></table></figure>
<p>å¦‚æœè¿™ä¸ªåŠ¨ä½œäº¤ç»™ CircleCI æ¥å®Œæˆï¼Œåˆ™éœ€è¦ä¸º Repo æ·»åŠ ä¸€ä¸ª <code>Read/Write</code> æƒé™çš„ <code>User Key</code></p>
<p><img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/img/20201212180750.png" alt=""></p>
<p>é‚£ä¹ˆï¼Œæ¯æ¬¡ CircleCI å‘ç”Ÿæ„å»ºçš„æ—¶å€™ï¼Œå°±ä¼šæ„å»ºæ–‡æ¡£ï¼Œå¹¶å‘å¸ƒåˆ° Github Pages ä¸­å»ã€‚</p>
<p>ä¾‹å¦‚æœ¬é¡¹ç›®ï¼Œå°±å¯ä»¥é€šè¿‡ä»¥ä¸‹åœ°å€è®¿é—®ï¼š</p>
<p><a href="https://jerryc8080.github.io/module-seed" target="_blank" rel="external">https://jerryc8080.github.io/module-seed</a></p>
<p>å‚è€ƒ <code>.circleci/config.yml</code> ç›¸å…³è„šæœ¬:</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line"><span class="attr"> deploy-docs:</span></div><div class="line">    &lt;&lt;: <span class="meta">*defaults</span></div><div class="line"><span class="attr">    steps:</span></div><div class="line"><span class="attr">      - attach_workspace:</span></div><div class="line"><span class="attr">          at:</span> ~/repo</div><div class="line"><span class="attr">      - run:</span></div><div class="line"><span class="attr">          name:</span> Avoid hosts unknown for github</div><div class="line"><span class="attr">          command:</span> mkdir ~/.ssh/ &amp;&amp; echo -e <span class="string">"Host github.com\n\tStrictHostKeyChecking no\n"</span> &gt; ~/.ssh/config</div><div class="line"><span class="attr">      - run:</span></div><div class="line"><span class="attr">          name:</span> Set github email and user</div><div class="line"><span class="attr">          command:</span> <span class="string">|</span></div><div class="line">            git config --global user.email "huangjerryc@gmail.com"</div><div class="line">            git config --global user.name "CircleCI-Robot"</div><div class="line"><span class="attr">      - run:</span></div><div class="line"><span class="attr">          name:</span> Show coverage</div><div class="line"><span class="attr">          command:</span> ls coverage</div><div class="line"><span class="attr">      - run:</span></div><div class="line"><span class="attr">          name:</span> Show docs</div><div class="line"><span class="attr">          command:</span> ls docs</div><div class="line"><span class="attr">      - run:</span></div><div class="line"><span class="attr">          name:</span> Copy to docs folder</div><div class="line"><span class="attr">          command:</span> <span class="string">|</span></div><div class="line">            mkdir docs/coverage</div><div class="line">            cp -rf coverage/* docs/coverage</div><div class="line"><span class="attr">      - run:</span></div><div class="line"><span class="attr">          name:</span> Show docs</div><div class="line"><span class="attr">          command:</span> ls docs</div><div class="line"><span class="attr">      - run:</span></div><div class="line"><span class="attr">          name:</span> Publish to gh-pages</div><div class="line"><span class="attr">          command:</span> npm run doc:publish</div><div class="line">...</div></pre></td></tr></table></figure>
<h4 id="4-Coverage-site"><a href="#4-Coverage-site" class="headerlink" title="4. Coverage site"></a>4. Coverage site</h4><p>åœ¨ CircleCI çš„ <code>deploy-docs</code> ä»»åŠ¡ä¸­ï¼Œä¼šæ„å»º Coverage Site ï¼Œç„¶åä¸€èµ·å‘å¸ƒåˆ° Github Pages çš„ <code>/coverage</code> ç›®å½•ä¸­ã€‚</p>
<p>ä¾‹å¦‚æœ¬é¡¹ç›®ï¼Œå°±å¯ä»¥é€šè¿‡ä»¥ä¸‹åœ°å€è®¿é—®ï¼š</p>
<p><a href="https://jerryc8080.github.io/module-seed/coverage/index.html" target="_blank" rel="external">https://jerryc8080.github.io/module-seed/coverage/index.html</a></p>
<h4 id="5-NPM-Deploy"><a href="#5-NPM-Deploy" class="headerlink" title="5. NPM Deploy"></a>5. NPM Deploy</h4><p>è‡ªåŠ¨åŒ–è„šæœ¬ä¼šä»¥ <code>patch</code> çš„å½¢å¼å‡çº§ç‰ˆæœ¬å·ï¼Œä¾‹å¦‚ï¼š<code>v0.0.1</code> â†’ <code>v0.0.2</code>ã€‚<br>ç„¶åå‘å¸ƒåˆ° <a href="http://npmjs.com/" target="_blank" rel="external">npmjs.com</a> å»ã€‚</p>
<p>å¦‚æœéœ€è¦å¯ç”¨è¿™ä¸€åŠŸèƒ½ï¼Œéœ€è¦ä¸º CircleCI Repo æ·»åŠ  <code>npm token</code>ã€‚</p>
<p>é¦–å…ˆï¼Œè·å– <code>npm token</code></p>
<p><img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/img/20201212182501.png" alt=""><br><img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/img/20201212182500.png" alt=""></p>
<p>ç„¶åï¼Œä¸º CircleCI Repo æ·»åŠ ç¯å¢ƒå˜é‡ï¼š<code>npm_TOKEN</code></p>
<p><img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/img/20201212182819.png" alt=""></p>
<p>é‚£ä¹ˆï¼Œæ¯æ¬¡ CircleCI å‘ç”Ÿæ„å»ºçš„æ—¶å€™ï¼Œå°±ä¼šæ„å»ºå’Œå‘å¸ƒ NPM åŒ…ã€‚</p>
<p>å‚è€ƒ <code>.circleci/config.yml</code> ç›¸å…³è„šæœ¬:</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">...</div><div class="line"><span class="attr">deploy:</span></div><div class="line">  &lt;&lt;: <span class="meta">*defaults</span></div><div class="line"><span class="attr">  steps:</span></div><div class="line"><span class="attr">    - attach_workspace:</span></div><div class="line"><span class="attr">        at:</span> ~/repo</div><div class="line"><span class="attr">    - run:</span></div><div class="line"><span class="attr">        name:</span> Set github email and user</div><div class="line"><span class="attr">        command:</span> <span class="string">|</span></div><div class="line">          # You should change email to yours.</div><div class="line">          git config --global user.email "huangjerryc@gmail.com"</div><div class="line">          git config --global user.name "CircleCI-Robot"</div><div class="line"><span class="attr">    - run:</span></div><div class="line"><span class="attr">        name:</span> Authenticate with registry</div><div class="line"><span class="attr">        command:</span> echo <span class="string">"//registry.npmjs.org/:_authToken=$npm_TOKEN"</span> &gt; ~/repo/.npmrc</div><div class="line"><span class="attr">    - run:</span></div><div class="line"><span class="attr">        name:</span> Update version as patch</div><div class="line"><span class="attr">        command:</span> npm run version</div><div class="line"><span class="attr">    - run:</span></div><div class="line"><span class="attr">        name:</span> Publish package</div><div class="line"><span class="attr">        command:</span> npm publish</div><div class="line">...</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;Motivation&quot;&gt;&lt;a href=&quot;#Motivation&quot; class=&quot;headerlink&quot; title=&quot;Motivation&quot;&gt;&lt;/a&gt;Motivation&lt;/h2&gt;&lt;p&gt;å¹³æ—¶å–œæ¬¢å†™ä¸€äº› NPM æ¨¡å—ï¼Œå†™å¾—å¤šäº†ï¼Œæ•´ç†å‡ºä¸€å¥—å·¥ä½œæµï¼Œè§£æ”¾ä¸€äº›é‡å¤çš„æ­å»º
    
    </summary>
    
      <category term="æ¬ç –ç å†œ" scheme="http://huang-jerryc.com/categories/%E6%90%AC%E7%A0%96%E7%A0%81%E5%86%9C/"/>
    
    
  </entry>
  
  <entry>
    <title>å‡½æ•°ä¿é™©ä¸ï¼šé¿å…å‡½æ•°è¿‡çƒ­è°ƒç”¨</title>
    <link href="http://huang-jerryc.com/2021/01/28/method-fuse/"/>
    <id>http://huang-jerryc.com/2021/01/28/method-fuse/</id>
    <published>2021-01-28T07:34:00.000Z</published>
    <updated>2021-01-28T09:36:07.795Z</updated>
    
    <content type="html"><![CDATA[<p>  <img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/img/20210128154439.png" width="300"></p>
<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p>åœ¨æ—¥å¸¸å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ä¼šé‡åˆ°å¾ˆå¤šè¿™æ ·çš„åœºæ™¯ï¼š</p>
<ol>
<li>åœ¨æŠ¢è´­æ´»åŠ¨ä¸­ï¼Œç”¨æˆ·å¾€å¾€ä¼šé¢‘ç¹åˆ·æ–°æ¥å£ï¼Œè¦ç»™æ¥å£åŠ ä¸Šé˜²æŠ¤ï¼Œé¢‘ç¹è°ƒç”¨åœæ­¢å“åº”ã€‚</li>
<li>åœ¨å¼±ç½‘ç¯å¢ƒä¸­ï¼Œå¾€å¾€ä¼šå®ç°å¤±è´¥é‡è¯•åŠŸèƒ½ï¼Œå¦‚æœå¤±è´¥æ¬¡æ•°å¤šäº†ï¼Œé¢‘ç¹çš„é‡è¯•éœ€è¦åˆ¶æ­¢ã€‚</li>
<li>åœ¨è‚¡ç¥¨å¸‚åœºä¸­ï¼Œå½“ä»·æ ¼æ³¢åŠ¨çš„å¹…åº¦åœ¨äº¤æ˜“æ—¶é—´ä¸­è¾¾åˆ°æŸä¸€ä¸ªé™å®šçš„ç†”æ–­ç‚¹æ—¶ï¼Œå¯¹å…¶æš‚åœäº¤æ˜“ä¸€æ®µæ—¶é—´çš„æœºåˆ¶ã€‚</li>
<li>â€¦â€¦</li>
</ol>
<p>è¿™ç±»é—®é¢˜ï¼Œæœ¬è´¨æ˜¯ï¼š<strong>ã€Œè¿‡çƒ­çš„è°ƒç”¨ã€</strong></p>
<p>åœ¨ç‰©ç†ç”µè·¯ä¸­ï¼Œå¯¹äºã€Œè¿‡çƒ­çš„è°ƒç”¨ã€æœ‰ä¸€ç§å¤§å®¶ç”Ÿæ´»ä¸­éƒ½å¸¸è§çš„ç”µå­å…ƒä»¶ï¼š<strong>ä¿é™©ä¸</strong></p>
<p>ä¿é™©ä¸ä¼šåœ¨ç”µæµå¼‚å¸¸å‡é«˜åˆ°ä¸€å®šçš„é«˜åº¦å’Œçƒ­åº¦çš„æ—¶å€™ï¼Œè‡ªèº«ç†”æ–­åˆ‡æ–­ç”µæµï¼Œä¿æŠ¤ç”µè·¯å®‰å…¨è¿è¡Œã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥æ¨¡ä»¿è¿™æ ·çš„æ€è·¯ï¼Œå»è§£å†³ç¼–ç¨‹ä¸­çš„ã€Œè¿‡çƒ­çš„è°ƒç”¨ã€é—®é¢˜ï¼š</p>
<ol>
<li>è®¾å®šä¸€ä¸ªé˜ˆå€¼ï¼Œå¦‚æœå‡½æ•°åœ¨çŸ­æ—¶é—´å†…è°ƒç”¨æ¬¡æ•°è¾¾åˆ°è¿™ä¸ªé˜ˆå€¼ï¼Œå°±ç†”æ–­ä¸€æ®µæ—¶é—´ã€‚</li>
<li>åœ¨å‡½æ•°æœ‰ä¸€æ®µæ—¶é—´æ²¡æœ‰è¢«è°ƒç”¨äº†ï¼Œè®©å‡½æ•°çš„çƒ­åº¦é™ä¸‹æ¥ã€‚</li>
</ol>
<h2 id="å‡½æ•°ä¿é™©ä¸çš„åŠŸèƒ½å®ç°"><a href="#å‡½æ•°ä¿é™©ä¸çš„åŠŸèƒ½å®ç°" class="headerlink" title="å‡½æ•°ä¿é™©ä¸çš„åŠŸèƒ½å®ç°"></a>å‡½æ•°ä¿é™©ä¸çš„åŠŸèƒ½å®ç°</h2><p>åŸºäºä»¥ä¸Šçš„æ€è·¯ï¼Œæˆ‘å®ç°äº†ä¸€ä¸ª npm åº“ï¼š<a href="https://github.com/JerryC8080/method-fuse" target="_blank" rel="external">Method Fuse</a></p>
<p>ä½¿ç”¨æ–¹å¼å¦‚ä¸‹ï¼š</p>
<h3 id="Step1ï¼šå®‰è£…"><a href="#Step1ï¼šå®‰è£…" class="headerlink" title="Step1ï¼šå®‰è£…"></a>Step1ï¼šå®‰è£…</h3><p><code>npm install @jerryc/method-fuse</code></p>
<h3 id="Step2ï¼šå¿«é€Ÿä½¿ç”¨"><a href="#Step2ï¼šå¿«é€Ÿä½¿ç”¨" class="headerlink" title="Step2ï¼šå¿«é€Ÿä½¿ç”¨"></a>Step2ï¼šå¿«é€Ÿä½¿ç”¨</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; MethodFuse &#125; <span class="keyword">from</span> <span class="string">'@jerryc/method-fuse'</span>;</div><div class="line"></div><div class="line"><span class="comment">// ä¸€ä¸ªè¯·æ±‚è¿œç¨‹èµ„æºçš„å¼‚æ­¥å‡½æ•°</span></div><div class="line"><span class="keyword">const</span> getAssets = <span class="keyword">async</span> () =&gt; API.requestAssets();</div><div class="line"></div><div class="line"><span class="comment">// åˆ›å»º MethodFuse å®ä¾‹</span></div><div class="line"><span class="keyword">const</span> fuse = <span class="keyword">new</span> MethodFuse(&#123;</div><div class="line">  <span class="comment">// å‘½åï¼Œç”¨äºæ—¥å¿—è¾“å‡º</span></div><div class="line">  name: <span class="string">'TestFuse'</span>,</div><div class="line"></div><div class="line">  <span class="comment">// æœ€å¤§è´Ÿè·ï¼Œé»˜è®¤ï¼š3</span></div><div class="line">  maxLoad: <span class="number">3</span>,</div><div class="line"></div><div class="line">  <span class="comment">// æ¯æ¬¡ç†”æ–­æ—¶é—´ã€‚æ¯æ¬¡ç†”æ–­ä¹‹åï¼Œé—´éš” N æ¯«ç§’ä¹‹åé‡é“¸ï¼Œé»˜è®¤ï¼š5000ms</span></div><div class="line">  breakingTime: <span class="number">5000</span>,</div><div class="line"></div><div class="line">  <span class="comment">// è‡ªåŠ¨å†·å´æ—¶é—´ã€‚åœ¨æœ€åä¸€æ¬¡è°ƒç”¨é—´éš” N æ¯«ç§’ä¹‹åè‡ªåŠ¨é‡é“¸ï¼Œé»˜è®¤ï¼š1000ms</span></div><div class="line">  coolDownTime: <span class="number">1000</span>,</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// ä»£ç†åŸå‡½æ•°</span></div><div class="line"><span class="keyword">const</span> getAssetsProxy = fuse.proxy(getAssets);</div><div class="line"></div><div class="line"><span class="comment">// é«˜é¢‘å¹¶å‘è°ƒç”¨ getAssetsProxyã€‚</span></div><div class="line">getAssetsProxy();</div><div class="line">getAssetsProxy();</div><div class="line">getAssetsProxy();</div><div class="line">getAssetsProxy(); <span class="comment">// æ­¤æ¬¡è°ƒç”¨ä¼šç†”æ–­</span></div><div class="line">setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> getAssetsProxy(), <span class="number">5000</span>); <span class="comment">// ç­‰å¾…ç†”æ–­é‡é“¸åï¼Œæ–¹å¯é‡æ–°è°ƒç”¨ã€‚</span></div><div class="line"></div><div class="line"><span class="comment">// ä»¥ä¸Šä¼šæ‰“å°æ—¥å¿—ï¼š</span></div><div class="line"><span class="comment">// [method-fuse:info] TestFuse-é€šè¿‡ä¿é™©ä¸(1/3)</span></div><div class="line"><span class="comment">// [method-fuse:info] TestFuse-é€šè¿‡ä¿é™©ä¸(2/3)</span></div><div class="line"><span class="comment">// [method-fuse:info] TestFuse-é€šè¿‡ä¿é™©ä¸(3/3)</span></div><div class="line"><span class="comment">// [method-fuse:error] TestFuse-ä¿é™©ä¸ç†”æ–­ï¼Œ5000ms ä¹‹åé‡é“¸</span></div><div class="line"><span class="comment">// [method-fuse:info] TestFuse-ä¿é™©ä¸é‡ç½®</span></div><div class="line"><span class="comment">// [method-fuse:info] TestFuse-é€šè¿‡ä¿é™©ä¸(1/3)</span></div></pre></td></tr></table></figure>
<h3 id="Step3ï¼šä½¿ç”¨è£…é¥°å™¨"><a href="#Step3ï¼šä½¿ç”¨è£…é¥°å™¨" class="headerlink" title="Step3ï¼šä½¿ç”¨è£…é¥°å™¨"></a>Step3ï¼šä½¿ç”¨è£…é¥°å™¨</h3><p>å¦‚æœä½ çš„é¡¹ç›®ä¸­æ”¯æŒ <code>TS</code> æˆ–è€… <code>ES Decorator</code>ï¼Œé‚£ä¹ˆ <code>MethodFuse</code> æä¾›äº†å¿«æ·ä½¿ç”¨çš„è£…é¥°å™¨ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; decorator <span class="keyword">as</span> methodFuse &#125; <span class="keyword">from</span> <span class="string">'@jerryc/method-fuse'</span>;</div><div class="line"></div><div class="line">@methodFuse(&#123; <span class="attr">name</span>: <span class="string">'TestFuse'</span> &#125;)</div><div class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">function</span> <span class="title">getAsset</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> API.requestAssets();</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h3 id="Step4ï¼šä¿®æ”¹æ—¥å¿—çº§åˆ«"><a href="#Step4ï¼šä¿®æ”¹æ—¥å¿—çº§åˆ«" class="headerlink" title="Step4ï¼šä¿®æ”¹æ—¥å¿—çº§åˆ«"></a>Step4ï¼šä¿®æ”¹æ—¥å¿—çº§åˆ«</h3><p><code>MethodFuse</code> å†…ç½®äº†ä¸€ä¸ªè¿·ä½  loggerï¼ˆpower by <a href="https://github.com/JerryC8080/mini-logger" target="_blank" rel="external">@jerryc/mini-logger</a>ï¼‰ï¼Œæ–¹ä¾¿å†…éƒ¨æ—¥å¿—æ‰“å°ï¼Œå¤–éƒ¨å¯ä»¥è·å¾— <code>Logger</code> çš„å®ä¾‹ï¼Œè¿›è¡Œ log level çš„æ§åˆ¶ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; LoggerLevel &#125; <span class="keyword">from</span> <span class="string">'@jerryc/mini-logger'</span>;</div><div class="line"><span class="keyword">import</span> &#123; logger, MethodFuse &#125; <span class="keyword">from</span> <span class="string">'@jerryc/method-fuse'</span>;</div><div class="line"></div><div class="line"><span class="comment">// åˆ›å»º MethodFuse å®ä¾‹</span></div><div class="line"><span class="keyword">const</span> MethodFuse = <span class="keyword">new</span> MethodFuse(&#123; <span class="attr">name</span>: <span class="string">'TestFuse'</span> &#125;);</div><div class="line"></div><div class="line"><span class="comment">// ä¸‹è°ƒ Log level</span></div><div class="line">logger.level = LoggerLevel.ERROR;</div></pre></td></tr></table></figure>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;  &lt;img src=&quot;https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/img/20210128154439.png&quot; width=&quot;300&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; c
    
    </summary>
    
      <category term="æ¬ç –ç å†œ" scheme="http://huang-jerryc.com/categories/%E6%90%AC%E7%A0%96%E7%A0%81%E5%86%9C/"/>
    
    
  </entry>
  
  <entry>
    <title>å¾®ä¿¡å°ç¨‹åºç™»å½•çš„å‰ç«¯è®¾è®¡ä¸å®ç°</title>
    <link href="http://huang-jerryc.com/2020/10/16/wxapp-login-design/"/>
    <id>http://huang-jerryc.com/2020/10/16/wxapp-login-design/</id>
    <published>2020-10-16T14:22:25.000Z</published>
    <updated>2020-10-19T02:24:42.620Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ä¸€-å‰è¨€"><a href="#ä¸€-å‰è¨€" class="headerlink" title="ä¸€. å‰è¨€"></a>ä¸€. å‰è¨€</h1><p>å¯¹äºç™»å½•/æ³¨å†Œçš„è®¾è®¡å¦‚æ­¤ç²¾é›•ç»†ç¢çš„ç›®çš„ï¼Œå½“ç„¶æ˜¯æƒ³è®©è¿™ä¸ªä½œä¸ºåº”ç”¨çš„åŸºç¡€èƒ½åŠ›ï¼Œæœ‰è¶³å¤Ÿçš„å¥å£®æ€§ï¼Œé¿å…å‡ºç°å…¨ç«™æ€§çš„é˜»å¡ã€‚</p>
<p>åŒæ—¶è¦å……åˆ†è€ƒè™‘å¦‚ä½•è§£è€¦å’Œå°è£…ï¼Œåœ¨å¼€å±•æ–°çš„å°ç¨‹åºçš„æ—¶å€™ï¼Œèƒ½æ›´å¿«çš„å»å¤ç”¨èƒ½åŠ›ï¼Œé¿å…é‡å¤é‡‡å‘ã€‚</p>
<p>ç™»å½•æ³¨å†Œè¿™æ¨¡å—ï¼Œå°±åƒä¸ªå†°å±±ï¼Œæˆ‘ä»¬ä»¥ä¸ºå®ƒå°±æ˜¯ã€Œè¾“å…¥è´¦å·å¯†ç ï¼Œå°±å®Œæˆç™»å½•äº†ã€ï¼Œä½†å®é™…ä¸‹é¢è¿˜æœ‰å„ç§éœ€è¦è€ƒè™‘çš„é—®é¢˜ã€‚</p>
<p><img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/img/20201016104626.jpg" alt=""></p>
<p>åœ¨æ­¤ï¼Œè·Ÿåœ¨åº§çš„å„ä½åˆ†äº«ä¸€ä¸‹ï¼Œæœ€è¿‘åšå®Œä¸€ä¸ªå°ç¨‹åºç™»å½•/æ³¨å†Œæ¨¡å—ä¹‹åï¼Œæ²‰æ·€ä¸‹æ¥çš„ä¸€äº›è®¾è®¡ç»éªŒå’Œæƒ³æ³•ã€‚</p>
<h1 id="äºŒ-ä¸šåŠ¡åœºæ™¯"><a href="#äºŒ-ä¸šåŠ¡åœºæ™¯" class="headerlink" title="äºŒ. ä¸šåŠ¡åœºæ™¯"></a>äºŒ. ä¸šåŠ¡åœºæ™¯</h1><p>åœ¨ç”¨æˆ·æµè§ˆå°ç¨‹åºçš„è¿‡ç¨‹ä¸­ï¼Œç”±ä¸šåŠ¡éœ€è¦ï¼Œå¾€å¾€éœ€è¦è·å–ç”¨æˆ·çš„ä¸€äº›åŸºæœ¬ä¿¡æ¯ï¼Œå¸¸è§çš„æœ‰ï¼š</p>
<ol>
<li>å¾®ä¿¡æ˜µç§°</li>
<li>å¾®ä¿¡æ‰‹æœºå·</li>
</ol>
<p>è€Œä¸åŒçš„äº§å“ï¼Œå¯¹äºç”¨æˆ·çš„ä¿¡æ¯è¦æ±‚ä¸å°½ç›¸åŒï¼Œä¹Ÿä¼šæœ‰ä¸ä¸€æ ·çš„æˆæƒæµç¨‹ã€‚</p>
<p>ç¬¬ä¸€ç§ï¼Œå¸¸è§äºç”µå•†ç³»ç»Ÿä¸­ï¼Œç”¨æˆ·è´­ä¹°å•†å“çš„æ—¶å€™ï¼Œä¸ºäº†è¯†åˆ«ç”¨æˆ·å¤šå¹³å°çš„è´¦å·ï¼Œå¾€å¾€ç”¨æ‰‹æœºå·å»åšä¸€ä¸ªè”ç³»ï¼Œè¿™æ—¶å€™éœ€è¦ç”¨æˆ·å»æˆæƒæ‰‹æœºå·ã€‚</p>
<p><img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/img/20201016111059.jpg" alt="æˆæƒæ‰‹æœºå·"></p>
<p>ç¬¬äºŒç§ï¼Œä¸ºäº†è®©ç”¨æˆ·ä¿¡æ¯å¾—åˆ°åŸºæœ¬çš„åˆå§‹åŒ–ï¼Œå¾€å¾€éœ€è¦æ›´è¿›ä¸€æ­¥è·å–ç”¨æˆ·ä¿¡æ¯ï¼šå¦‚å¾®ä¿¡æ˜µç§°ï¼Œ<code>unionId</code> ç­‰ï¼Œå°±éœ€è¦è¯¢é—®ç”¨æˆ·æˆæƒã€‚</p>
<p><img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/img/20201016111042.jpg" alt="æˆæƒç”¨æˆ·ä¿¡æ¯"></p>
<p>ç¬¬ä¸‰ç§ï¼Œå›Šæ‹¬ç¬¬ä¸€ç§ï¼Œç¬¬äºŒç§ã€‚</p>
<p><img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/img/20201016111006.jpg" alt="å®Œæ•´æˆæƒæµç¨‹"></p>
<h1 id="ä¸‰-æ¦‚å¿µ"><a href="#ä¸‰-æ¦‚å¿µ" class="headerlink" title="ä¸‰. æ¦‚å¿µ"></a>ä¸‰. æ¦‚å¿µ</h1><p>ç§‰ç€æ²‰æ·€ä¸€å¥—é€šç”¨çš„å°ç¨‹åºç™»å½•æ–¹æ¡ˆå’ŒæœåŠ¡ä¸ºç›®æ ‡ï¼Œæˆ‘ä»¬å»åˆ†æä¸€ä¸‹ä¸šåŠ¡ï¼Œå¾—å‡ºå˜é‡ã€‚</p>
<p>åœ¨åšæŠ€æœ¯è®¾è®¡ä¹‹å‰ï¼Œè®²ç‚¹å¿…è¦çš„åºŸè¯ï¼Œå¯¹ä¸€äº›æ¦‚å¿µè¿›è¡ŒåŸºæœ¬è°ƒé¢‘ã€‚</p>
<h2 id="2-1-å…³äºã€Œç™»å½•ã€"><a href="#2-1-å…³äºã€Œç™»å½•ã€" class="headerlink" title="2.1 å…³äºã€Œç™»å½•ã€"></a>2.1 å…³äºã€Œç™»å½•ã€</h2><p>ç™»å½•åœ¨è‹±æ–‡ä¸­æ˜¯ ã€Œloginã€ï¼Œå¯¹åº”çš„è¿˜æœ‰ ã€Œlogoutã€ã€‚è€Œç™»å½•ä¹‹å‰ï¼Œä½ éœ€è¦æ‹¥æœ‰ä¸€ä¸ªè´¦å·ï¼Œå°±è¦ ã€Œregisterã€ï¼ˆor sign upï¼‰ã€‚</p>
<p>è¯è¯´ä¸€å¼€å§‹çš„äº§å“æ˜¯æ²¡æœ‰ç™»å½•/æ³¨å†ŒåŠŸèƒ½çš„ï¼Œç”¨çš„äººå¤šäº†å°±æ…¢æ…¢æœ‰äº†ã€‚å‡ºäºäº§å“æœ¬èº«çš„éœ€æ±‚ï¼Œéœ€è¦å¯¹ã€Œç”¨æˆ·ã€è¿›è¡Œèº«ä»½è¯†åˆ«ã€‚</p>
<p>åœ¨ç°å®ç¤¾ä¼šä¸­ï¼Œæˆ‘ä»¬æ¯ä¸ªäººéƒ½æœ‰ä¸€ä¸ªèº«ä»½IDï¼šèº«ä»½è¯ã€‚å½“æˆ‘åˆ°äº†16å²çš„æ—¶å€™ï¼Œç¬¬ä¸€æ¬¡å»å…¬å®‰å±€é¢†èº«ä»½è¯çš„æ—¶å€™ï¼Œå°±å®Œæˆäº†ä¸€æ¬¡ã€Œæ³¨å†Œã€è¡Œä¸ºã€‚ç„¶åæˆ‘å»ç½‘å§ä¸Šç½‘ï¼Œèº«ä»½è¯åˆ·ä¸€ä¸‹ï¼Œå®Œæˆäº†ä¸€æ¬¡ã€Œç™»å½•ã€è¡Œä¸ºã€‚</p>
<p>é‚£ä¹ˆå¯¹äºè™šæ‹Ÿä¸–ç•Œçš„äº’è”ç½‘æ¥è¯´ï¼Œè¿™ä¸ªèº«ä»½è¯æ˜å°±æ˜¯ã€Œè´¦å·+å¯†ç ã€ã€‚</p>
<p>å¸¸è§çš„ç™»å½•/æ³¨å†Œæ–¹å¼æœ‰ï¼š</p>
<ol>
<li><p><strong>è´¦å·å¯†ç æ³¨å†Œ</strong></p>
<p> åœ¨äº’è”ç½‘çš„æ—©æœŸï¼Œä¸ªäººé‚®ç®±å’Œæ‰‹æœºè¦†ç›–åº¦å°ã€‚æ‰€ä»¥ï¼Œå°±éœ€è¦ç”¨æˆ·è‡ªå·±æƒ³ä¸€ä¸ªè´¦å·åï¼Œæˆ‘ä»¬æ³¨å†Œä¸ªQQå·ï¼Œå°±æ˜¯è¿™ç§å½¢å¼ã€‚</p>
<p> <img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/img/20201016105159.png" alt="from æ±½è½¦ä¹‹å®¶">    </p>
</li>
<li><p><strong>é‚®ç®±åœ°å€æ³¨å†Œ</strong></p>
<p> åƒç¦§å¹´ä¹‹åï¼ŒPCäº’è”ç½‘æ—¶ä»£å¿«é€Ÿæ™®åŠï¼Œæˆ‘ä»¬éƒ½åˆ›å»ºäº†å±äºè‡ªå·±çš„ä¸ªäººé‚®ç®±ã€‚åŠ ä¸ŠQQä¹Ÿè‡ªå¸¦é‚®ç®±è´¦å·ã€‚ç”±äºé‚®ç®±å…·æœ‰ä¸ªäººç§å¯†æ€§ï¼Œä¸”èƒ½å¤Ÿè¿›è¡Œä¿¡æ¯çš„æ²Ÿé€šï¼Œå› æ­¤ï¼Œå¤§éƒ¨åˆ†ç½‘ç«™å¼€å§‹é‡‡ç”¨é‚®ç®±è´¦å·ä½œä¸ºç”¨æˆ·åæ¥è¿›è¡Œæ³¨å†Œï¼Œå¹¶ä¸”ä¼šåœ¨æ³¨å†Œçš„è¿‡ç¨‹ä¸­è¦æ±‚ç™»å½•åˆ°ç›¸åº”é‚®ç®±å†…æŸ¥æ”¶æ¿€æ´»é‚®ä»¶ï¼ŒéªŒè¯æˆ‘ä»¬å¯¹è¯¥æ³¨å†Œé‚®ç®±çš„æ‰€æœ‰æƒã€‚</p>
<p> <img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/img/20201016105005.png" alt="from æ”¯ä»˜å®"></p>
</li>
<li><p><strong>æ‰‹æœºå·ç æ³¨å†Œ</strong></p>
<p> åœ¨äº’è”ç½‘æ™®åŠä¹‹åï¼Œæ™ºèƒ½æ‰‹æœºä¸ç§»åŠ¨äº’è”ç½‘å‘å±•è¿…çŒ›ã€‚æ‰‹æœºä¹Ÿæˆä¸ºæ¯ä¸ªäººå¿…ä¸å¯å°‘çš„ç§»åŠ¨è®¾å¤‡ï¼ŒåŒæ—¶ç§»åŠ¨äº’è”ç½‘ä¹Ÿå·²ç»æ·±æ·±èå…¥æ¯ä¸ªäººçš„ç°ä»£ç”Ÿæ´»å½“ä¸­ã€‚æ‰€ä»¥ï¼Œç›¸è¾ƒäºé‚®ç®±ï¼Œç›®å‰æ‰‹æœºå·ç ä¸ä¸ªäººçš„è”ç³»æ›´åŠ ç´§å¯†ï¼Œè€Œä¸”è¶Šæ¥è¶Šå¤šçš„ç§»åŠ¨åº”ç”¨å‡ºç°ï¼Œé‡‡ç”¨æ‰‹æœºå·ç ä½œä¸ºç”¨æˆ·åçš„æ³¨å†Œæ–¹å¼ä¹Ÿå¾—åˆ°äº†å¹¿æ³›çš„ä½¿ç”¨ã€‚   </p>
<p> <img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/img/20201016105120.png" alt="from çŸ¥ä¹"></p>
</li>
</ol>
<p>åˆ°äº† 2020 å¹´ï¼Œå¾®ä¿¡ç”¨æˆ·è§„æ¨¡è¾¾ 12 äº¿ã€‚é‚£ä¹ˆï¼Œå¾®ä¿¡è´¦å·ï¼Œèµ·ç åœ¨ä¸­å›½ï¼Œå·²æˆä¸ºæ–°ä¸€ä»£äº’è”ç½‘ä¸–ç•Œçš„ã€Œèº«ä»½æ ‡è¯†ã€ã€‚</p>
<p>è€Œå¯¹å¾®ä¿¡å°ç¨‹åºè€Œè¨€ï¼Œå¤©ç„¶å°±èƒ½çŸ¥é“å½“å‰ç”¨æˆ·çš„å¾®ä¿¡è´¦å·IDã€‚å¾®ä¿¡å…è®¸å°ç¨‹åºåº”ç”¨ï¼Œèƒ½åœ¨ç”¨æˆ·æ— æ„ŸçŸ¥çš„æƒ…å†µä¸‹ï¼Œæ‚„æ— å£°æ¯çš„ã€Œç™»å½•ã€åˆ°æˆ‘ä»¬çš„å°ç¨‹åºåº”ç”¨ä¸­å»ï¼Œè¿™ä¸ªå°±æ˜¯æˆ‘ä»¬ç»å¸¸ç§°ä¹‹ä¸ºçš„ã€Œé™é»˜ç™»å½•ã€ã€‚</p>
<p>å…¶å®å¾®ä¿¡å°ç¨‹åºçš„ç™»å½•ï¼Œè·Ÿä¼ ç»Ÿ Web åº”ç”¨çš„ã€Œå•ç‚¹ç™»å½•ã€æœ¬è´¨æ˜¯ä¸€æ ·çš„æ¦‚å¿µã€‚</p>
<ol>
<li>å•ç‚¹ç™»å½•ï¼šåœ¨ A ç«™ç™»å½•äº†ï¼ŒC ç«™å’Œ B ç«™èƒ½å®ç°å¿«é€Ÿçš„ã€Œé™é»˜ç™»å½•ã€ã€‚</li>
<li>å¾®ä¿¡å°ç¨‹åºç™»å½•ï¼šåœ¨å¾®ä¿¡ä¸­ï¼Œç™»å½•äº†å¾®ä¿¡è´¦å·ï¼Œé‚£ä¹ˆåœ¨æ•´ä¸ªå°ç¨‹åºç”Ÿæ€ä¸­ï¼Œéƒ½å¯ä»¥å®ç°ã€Œé™é»˜ç™»å½•ã€ã€‚</li>
</ol>
<p>ç”±äº Http æœ¬æ¥æ˜¯æ— çŠ¶æ€çš„ï¼Œä¸šç•ŒåŸºæœ¬å¯¹äºç™»å½•æ€çš„ä¸€èˆ¬åšæ³•ï¼š</p>
<ol>
<li>cookie-sessionï¼šå¸¸ç”¨äºæµè§ˆå™¨åº”ç”¨ä¸­</li>
<li>access tokenï¼šå¸¸ç”¨äºç§»åŠ¨ç«¯ç­‰éæµè§ˆå™¨åº”ç”¨</li>
</ol>
<p>åœ¨å¾®ä¿¡å°ç¨‹åºæ¥è¯´ï¼Œå¯¹äºã€ŒJSé€»è¾‘å±‚ã€å¹¶ä¸æ˜¯ä¸€ä¸ªæµè§ˆå™¨ç¯å¢ƒï¼Œè‡ªç„¶æ²¡æœ‰ <code>Cookie</code>ï¼Œé‚£ä¹ˆé€šå¸¸ä¼šä½¿ç”¨ <code>access token</code> çš„æ–¹å¼ã€‚</p>
<h2 id="2-2-å…³äºã€Œæˆæƒã€"><a href="#2-2-å…³äºã€Œæˆæƒã€" class="headerlink" title="2.2 å…³äºã€Œæˆæƒã€"></a>2.2 å…³äºã€Œæˆæƒã€</h2><p>å¯¹äºéœ€è¦æ›´è¿›ä¸€æ­¥è·å–ç”¨çš„ç”¨æˆ·æ˜µç§°ã€ç”¨æˆ·æ‰‹æœºå·ç­‰ä¿¡æ¯çš„äº§å“æ¥è¯´ã€‚å¾®ä¿¡å‡ºäºç”¨æˆ·éšç§çš„è€ƒè™‘ï¼Œéœ€è¦ç”¨æˆ·ä¸»åŠ¨åŒæ„æˆæƒã€‚å°ç¨‹åºåº”ç”¨æ‰èƒ½è·å–åˆ°è¿™éƒ¨åˆ†ä¿¡æ¯ï¼Œè¿™å°±æœ‰äº†ç›®å‰æµè¡Œçš„å°ç¨‹åºã€Œæˆæƒç”¨æˆ·ä¿¡æ¯ã€ã€ã€Œæˆæƒæ‰‹æœºå·ã€çš„äº¤äº’äº†ã€‚</p>
<p>å‡ºäºä¸åŒçš„ç”¨æˆ·ä¿¡æ¯æ•æ„Ÿåº¦ä¸åŒçš„è€ƒè™‘ï¼Œå¾®ä¿¡å°ç¨‹åºå¯¹äºä¸åŒçš„ç”¨æˆ·ä¿¡æ¯æä¾›ã€Œæˆæƒã€çš„æ–¹å¼ä¸å°½ç›¸åŒï¼š</p>
<ol>
<li>è°ƒç”¨å…·ä½“ API æ–¹å¼ï¼Œå¼¹çª—æˆæƒã€‚<ol>
<li>ä¾‹å¦‚è°ƒç”¨ <a href="https://developers.weixin.qq.com/miniprogram/dev/api/location/wx.getLocation.html" target="_blank" rel="external"><code>wx.getLocation()</code></a> çš„æ—¶å€™ï¼Œå¦‚æœç”¨æˆ·æœªæˆæƒï¼Œåˆ™ä¼šå¼¹å‡ºåœ°å€æˆæƒç•Œé¢ã€‚</li>
<li>å¦‚æœæ‹’ç»äº†ï¼Œå°±ä¸ä¼šå†æ¬¡å¼¹çª—ï¼Œ<code>wx.getLocation()</code>ç›´æ¥è¿”å›å¤±è´¥ã€‚</li>
</ol>
</li>
<li><code>&lt;button open-type=&quot;xxx&quot; /&gt;</code> æ–¹å¼ã€‚<ol>
<li>ä»…æ”¯æŒï¼šç”¨æˆ·æ•æ„Ÿä¿¡æ¯ï¼Œç”¨æˆ·æ‰‹æœºå·ï¼Œéœ€è¦é…åˆåç«¯è¿›è¡Œå¯¹ç§°åŠ è§£å¯†ï¼Œæ–¹èƒ½æ‹¿åˆ°æ•°æ®ã€‚</li>
<li>ç”¨æˆ·å·²æ‹’ç»ï¼Œå†æ¬¡ç‚¹å‡»æŒ‰é’®ï¼Œä»ç„¶ä¼šå¼¹çª—ã€‚</li>
</ol>
</li>
<li>é€šè¿‡ <a href="https://developers.weixin.qq.com/miniprogram/dev/api/open-api/authorize/wx.authorize.html" target="_blank" rel="external"><code>wx.authorize()</code></a>ï¼Œæå‰è¯¢é—®æˆæƒï¼Œä¹‹åéœ€è¦è·å–ç›¸å…³ä¿¡æ¯çš„æ—¶å€™ä¸ç”¨å†æ¬¡å¼¹å‡ºæˆæƒã€‚</li>
</ol>
<h1 id="å››-è¯¦ç»†è®¾è®¡"><a href="#å››-è¯¦ç»†è®¾è®¡" class="headerlink" title="å››. è¯¦ç»†è®¾è®¡"></a>å››. è¯¦ç»†è®¾è®¡</h1><p>æ¢³ç†æ¸…æ¥šäº†æ¦‚å¿µä¹‹åï¼Œæˆ‘ä»¬æ¨¡å—çš„åˆ’åˆ†ä¸Šï¼Œå¯ä»¥æ‹†åˆ†ä¸ºä¸¤å¤§å—ï¼š</p>
<ol>
<li><strong>ç™»å½•</strong>ï¼šè´Ÿè´£ä¸æœåŠ¡ç«¯åˆ›å»ºèµ·ä¸€ä¸ªä¼šè¯ï¼Œè¿™ä¸ªä¼šè¯å®ç°é™é»˜ç™»å½•ä»¥åŠç›¸å…³çš„å®¹é”™å¤„ç†ç­‰ï¼Œæ¨¡å—å‘½åä¸ºï¼š<code>Session</code></li>
<li><strong>æˆæƒ</strong>ï¼šè´Ÿè´£ä¸ç”¨æˆ·äº¤äº’ï¼Œè·å–ä¸æ›´æ–°ä¿¡æ¯ï¼Œä»¥åŠæƒé™çš„æ§åˆ¶å¤„ç†ç­‰ï¼Œæ¨¡å—å‘½åä¸ºï¼š<code>Auth</code></li>
</ol>
<h2 id="3-1-ç™»å½•çš„å®ç°"><a href="#3-1-ç™»å½•çš„å®ç°" class="headerlink" title="3.1 ç™»å½•çš„å®ç°"></a>3.1 ç™»å½•çš„å®ç°</h2><h3 id="3-1-1-é™é»˜ç™»å½•"><a href="#3-1-1-é™é»˜ç™»å½•" class="headerlink" title="3.1.1 é™é»˜ç™»å½•"></a>3.1.1 é™é»˜ç™»å½•</h3><p><img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/img/20201016111135.png" alt="å¾®ä¿¡ç™»å½•"></p>
<p>å¾®ä¿¡å®˜æ–¹æä¾›çš„ç™»å½•æ–¹æ¡ˆï¼Œæ€»ç»“ä¸ºä¸‰æ­¥ï¼š</p>
<ol>
<li>å‰ç«¯é€šè¿‡ <code>wx.login()</code> è·å–ä¸€æ¬¡æ€§åŠ å¯†å‡­è¯ codeï¼Œäº¤ç»™åç«¯ã€‚</li>
<li>åç«¯æŠŠè¿™ä¸ª code ä¼ è¾“ç»™å¾®ä¿¡æœåŠ¡å™¨ç«¯ï¼Œæ¢å–ç”¨æˆ·å”¯ä¸€æ ‡è¯† <code>openId</code> å’Œæˆæƒå‡­è¯ <code>session_key</code>ã€‚ï¼ˆç”¨äºåç»­æœåŠ¡å™¨ç«¯å’Œå¾®ä¿¡æœåŠ¡å™¨çš„ç‰¹æ®Š API è°ƒç”¨ï¼Œå…·ä½“çœ‹ï¼š<a href="https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/signature.html" target="_blank" rel="external">å¾®ä¿¡å®˜æ–¹æ–‡æ¡£-æœåŠ¡ç«¯è·å–å¼€æ”¾æ•°æ®</a>ï¼‰ã€‚</li>
<li>åç«¯æŠŠä»å¾®ä¿¡æœåŠ¡å™¨è·å–åˆ°çš„ç”¨æˆ·å‡­è¯ä¸è‡ªè¡Œç”Ÿæˆçš„ç™»å½•æ€å‡­è¯ï¼ˆtokenï¼‰ï¼Œä¼ è¾“ç»™å‰ç«¯ã€‚å‰ç«¯ä¿å­˜èµ·æ¥ï¼Œä¸‹æ¬¡è¯·æ±‚çš„æ—¶å€™å¸¦ç»™åç«¯ï¼Œå°±èƒ½è¯†åˆ«å“ªä¸ªç”¨æˆ·ã€‚</li>
</ol>
<p>å¦‚æœåªæ˜¯å®ç°è¿™ä¸ªæµç¨‹çš„è¯ï¼ŒæŒºç®€å•çš„ã€‚</p>
<p>ä½†è¦å®ç°ä¸€ä¸ªå¥å£®çš„ç™»å½•è¿‡ç¨‹ï¼Œè¿˜éœ€è¦æ³¨æ„æ›´å¤šçš„è¾¹ç•Œæƒ…å†µï¼š</p>
<ol>
<li><p><strong>æ”¶æ‹¢ <code>wx.login()</code> çš„è°ƒç”¨</strong>ï¼š</p>
<p> ç”±äº <code>wx.login()</code> ä¼šäº§ç”Ÿä¸å¯é¢„æµ‹çš„å‰¯ä½œç”¨ï¼Œä¾‹å¦‚ä¼šå¯èƒ½å¯¼è‡´<code>session_key</code>å¤±æ•ˆï¼Œä»è€Œå¯¼è‡´åç»­çš„æˆæƒè§£å¯†åœºæ™¯ä¸­çš„å¤±è´¥ã€‚æˆ‘ä»¬è¿™é‡Œå¯ä»¥æä¾›ä¸€ä¸ªåƒ <code>session.login()</code> çš„æ–¹æ³•ï¼ŒæŒæ¡ <code>wx.login()</code> æ§åˆ¶æƒï¼Œå¯¹å…¶åšä¸€ç³»åˆ—çš„å°è£…å’Œå®¹é”™å¤„ç†ã€‚</p>
</li>
<li><p><strong>è°ƒç”¨çš„æ—¶æœº</strong>ï¼š</p>
<p> é€šå¸¸æˆ‘ä»¬ä¼šåœ¨åº”ç”¨å¯åŠ¨çš„æ—¶å€™ï¼ˆ <code>app.onLaunch()</code> ï¼‰ï¼Œå»å‘èµ·é™é»˜ç™»å½•ã€‚ä½†è¿™é‡Œä¼šç”±å°ç¨‹åºç”Ÿå‘½å‘¨æœŸè®¾è®¡é—®é¢˜è€Œå¯¼è‡´çš„ä¸€ä¸ªå¼‚æ­¥é—®é¢˜ï¼šåŠ è½½é¡µé¢çš„æ—¶å€™ï¼Œå»è°ƒç”¨ä¸€ä¸ªéœ€è¦ç™»å½•æ€çš„åç«¯ API çš„æ—¶å€™ï¼Œå‰é¢å¼‚æ­¥çš„é™æ€ç™»å½•è¿‡ç¨‹æœ‰å¯èƒ½è¿˜æ²¡æœ‰å®Œæˆï¼Œä»è€Œå¯¼è‡´è¯·æ±‚å¤±è´¥ã€‚</p>
<p> å½“ç„¶ä¹Ÿå¯ä»¥åœ¨ç¬¬ä¸€ä¸ªéœ€è¦ç™»å½•æ€çš„æ¥å£è°ƒç”¨çš„æ—¶å€™ä»¥å¼‚æ­¥é˜»å¡çš„æ–¹å¼å‘èµ·ç™»å½•è°ƒç”¨ï¼Œè¿™ä¸ªéœ€è¦ç»“åˆè‰¯å¥½è®¾è®¡çš„æ¥å£å±‚ã€‚</p>
<p> ä»¥ä¸Šè®²åˆ°çš„ä¸¤ç§åœºæ™¯çš„è¯¦ç»†è®¾è®¡æ€è·¯ä¸‹æ–‡ä¼šè®²åˆ°ã€‚</p>
</li>
<li><p><strong>å¹¶å‘è°ƒç”¨çš„é—®é¢˜</strong>ï¼š</p>
<p> åœ¨ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œéš¾å…ä¼šå‡ºç°å¤šå¤„ä»£ç éœ€è¦è§¦å‘ç™»å½•ï¼Œå¦‚æœé‡åˆ°æç«¯æƒ…å†µï¼Œè¿™å¤šå¤„ä»£ç åŒæ—¶é—´å‘èµ·è°ƒç”¨ã€‚é‚£å°±ä¼šé€ æˆçŸ­æ—¶é—´å¤šæ¬¡å‘èµ·ç™»å½•è¿‡ç¨‹ï¼Œå°½ç®¡ä¹‹å‰çš„è¯·æ±‚è¿˜æ²¡æœ‰å®Œæˆã€‚é’ˆå¯¹è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥ä»¥ç¬¬ä¸€ä¸ªè°ƒç”¨ä¸ºé˜»å¡ï¼Œåç»­è°ƒç”¨ç­‰å¾…ç»“æœï¼Œå°±åƒç²¾å­å’Œåµå­ç»“åˆçš„è¿‡ç¨‹ã€‚</p>
</li>
<li><p><strong>æœªè¿‡æœŸè°ƒç”¨çš„é—®é¢˜</strong>ï¼š</p>
<p> å¦‚æœæˆ‘ä»¬çš„ç™»å½•æ€æœªè¿‡æœŸï¼Œå®Œå…¨å¯ä»¥æ­£å¸¸ä½¿ç”¨çš„ï¼Œé»˜è®¤æƒ…å†µå°±ä¸éœ€å†å»å‘èµ·ç™»å½•è¿‡ç¨‹äº†ã€‚è¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥é»˜è®¤æƒ…å†µä¸‹å…ˆå»æ£€æŸ¥ç™»å½•æ€æ˜¯å¦å¯ç”¨ï¼Œä¸èƒ½ç”¨ï¼Œæˆ‘ä»¬å†å‘èµ·è¯·æ±‚ã€‚ç„¶åè¿˜å¯ä»¥æä¾›ä¸€ä¸ªç±»ä¼¼ <code>session.login({ force: true })</code>çš„å‚æ•°å»å¼ºè¡Œå‘èµ·ç™»å½•ã€‚</p>
</li>
</ol>
<h3 id="3-1-2-é™é»˜ç™»å½•å¼‚æ­¥çŠ¶æ€çš„å¤„ç†"><a href="#3-1-2-é™é»˜ç™»å½•å¼‚æ­¥çŠ¶æ€çš„å¤„ç†" class="headerlink" title="3.1.2 é™é»˜ç™»å½•å¼‚æ­¥çŠ¶æ€çš„å¤„ç†"></a>3.1.2 é™é»˜ç™»å½•å¼‚æ­¥çŠ¶æ€çš„å¤„ç†</h3><p><strong>1. åº”ç”¨å¯åŠ¨çš„æ—¶å€™è°ƒç”¨</strong></p>
<p>å› ä¸ºå¤§éƒ¨åˆ†æƒ…å†µéƒ½éœ€è¦ä¾èµ–ç™»å½•æ€ï¼Œæˆ‘ä»¬ä¼šå¾ˆè‡ªç„¶è€Œç„¶çš„æƒ³åˆ°æŠŠè¿™ä¸ªè°ƒç”¨çš„æ—¶æœºæ”¾åˆ°åº”ç”¨å¯åŠ¨çš„æ—¶å€™ï¼ˆ <code>app.onLaunch()</code> ï¼‰æ¥è°ƒç”¨ã€‚</p>
<p>ä½†æ˜¯ç”±äºåŸç”Ÿçš„å°ç¨‹åºå¯åŠ¨æµç¨‹ä¸­ï¼Œ <code>App</code>ï¼Œ<code>Page</code>ï¼Œ<code>Component</code> çš„ç”Ÿå‘½å‘¨æœŸé’©å­å‡½æ•°ï¼Œéƒ½ä¸æ”¯æŒå¼‚æ­¥é˜»å¡ã€‚</p>
<p>é‚£ä¹ˆæˆ‘ä»¬å¾ˆå®¹æ˜“ä¼šé‡åˆ° <code>app.onLaunch</code> å‘èµ·çš„ã€Œç™»å½•è¿‡ç¨‹ã€åœ¨ <code>page.onLoad</code> çš„æ—¶å€™è¿˜æ²¡æœ‰å®Œæˆï¼Œæˆ‘ä»¬å°±æ— æ³•æ­£ç¡®å»åšä¸€äº›ä¾èµ–ç™»å½•æ€çš„æ“ä½œã€‚</p>
<p>é’ˆå¯¹è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬è®¾è®¡äº†ä¸€ä¸ªçŠ¶æ€æœºçš„å·¥å…·ï¼š<a href="http://beautywejs.com/#/remote/plugin-status?id=plugin-statusl" target="_blank" rel="external">status</a></p>
<p><img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/img/20201016110706.png" alt="çŠ¶æ€æœº"></p>
<p>åŸºäºçŠ¶æ€æœºï¼Œæˆ‘ä»¬å°±å¯ä»¥ç¼–å†™è¿™æ ·çš„ä»£ç ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> &#123; Status &#125; <span class="keyword">from</span> <span class="string">'@beautywe/plugin-status'</span>;</div><div class="line"></div><div class="line"><span class="comment">// on app.js</span></div><div class="line">App(&#123;</div><div class="line">    <span class="attr">status</span>: &#123;</div><div class="line">       <span class="attr">login</span>: <span class="keyword">new</span> Status(<span class="string">'login'</span>);</div><div class="line">    &#125;,</div><div class="line"></div><div class="line">    onLaunch() &#123;</div><div class="line">        session</div><div class="line">            <span class="comment">// å‘èµ·é™é»˜ç™»å½•è°ƒç”¨</span></div><div class="line">            .login()</div><div class="line"></div><div class="line">            <span class="comment">// æŠŠçŠ¶æ€æœºè®¾ç½®ä¸º success</span></div><div class="line">            .then(<span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">this</span>.status.login.success())</div><div class="line">      </div><div class="line">            <span class="comment">// æŠŠçŠ¶æ€æœºè®¾ç½®ä¸º fail</span></div><div class="line">            .catch(<span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">this</span>.status.login.fail());</div><div class="line">    &#125;,</div><div class="line">&#125;);</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// on page.js</span></div><div class="line">Page(&#123;</div><div class="line">    onLoad() &#123;</div><div class="line">      <span class="keyword">const</span> loginStatus = getApp().status.login;</div><div class="line">      </div><div class="line">      <span class="comment">// must é‡Œé¢ä¼šè¿›è¡ŒçŠ¶æ€çš„åˆ¤æ–­ï¼Œä¾‹å¦‚ç™»å½•ä¸­å°±ç­‰å¾…ï¼Œç™»å½•æˆåŠŸå°±ç›´æ¥è¿”å›ï¼Œç™»å½•å¤±è´¥æŠ›å‡ºç­‰ã€‚</span></div><div class="line">      loginStatus().status.login.must(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">        <span class="comment">// è¿›è¡Œä¸€äº›éœ€è¦ç™»å½•æ€çš„æ“ä½œ...</span></div><div class="line">      &#125;);</div><div class="line">    &#125;,</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p><strong>2. åœ¨ã€Œç¬¬ä¸€ä¸ªéœ€è¦ç™»å½•æ€æ¥å£ã€è¢«è°ƒç”¨çš„æ—¶å€™å»å‘èµ·ç™»å½•</strong></p>
<p>æ›´è¿›ä¸€æ­¥ï¼Œæˆ‘ä»¬ä¼šå‘ç°ï¼Œéœ€è¦ç™»å½•æ€çš„æ›´æ·±å±‚æ¬¡çš„èŠ‚ç‚¹æ˜¯åœ¨å‘èµ·çš„ã€Œéœ€è¦ç™»å½•æ€çš„åç«¯ API ã€çš„æ—¶å€™ã€‚</p>
<p>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åœ¨è°ƒç”¨ã€Œéœ€è¦ç™»å½•æ€çš„åç«¯ APIã€çš„æ—¶å€™å†å»å‘èµ·ã€Œé™é»˜ç™»å½•ã€ï¼Œå¯¹äºå¹¶å‘çš„åœºæ™¯ï¼Œè®©å…¶ä»–è¯·æ±‚ç­‰å¾…ä¸€ä¸‹å°±å¥½äº†ã€‚</p>
<p>ä»¥ <a href="https://wendux.github.io/dist/#/doc/flyio/readme" target="_blank" rel="external">fly.js</a> ä½œä¸º <code>wx.request()</code> å°è£…çš„ã€Œç½‘ç»œè¯·æ±‚å±‚ã€ï¼Œåšä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// å‘èµ·è¯·æ±‚ï¼Œå¹¶è¡¨æ˜è¯¥è¯·æ±‚æ˜¯éœ€è¦ç™»å½•æ€çš„</span></div><div class="line">fly.post(<span class="string">'https://...'</span>, params, &#123; <span class="attr">needLogin</span>: <span class="literal">true</span> &#125;);</div><div class="line"></div><div class="line"><span class="comment">// åœ¨ fly æ‹¦æˆªå™¨ä¸­å¤„ç†é€»è¾‘</span></div><div class="line">fly.interceptors.request.use(<span class="keyword">async</span> (req)=&gt;&#123;</div><div class="line"></div><div class="line">  <span class="comment">// åœ¨è¯·æ±‚éœ€è¦ç™»å½•æ€çš„æ—¶å€™</span></div><div class="line">  <span class="keyword">if</span> (req.needLogin !== <span class="literal">false</span>) &#123;</div><div class="line"></div><div class="line">    <span class="comment">// ensureLogin æ ¸å¿ƒé€»è¾‘æ˜¯ï¼šåˆ¤æ–­æ˜¯å¦å·²ç™»å½•ï¼Œå¦‚å¦å‘èµ·ç™»å½•è°ƒç”¨ï¼Œå¦‚æœæ­£åœ¨ç™»å½•ï¼Œåˆ™è¿›å…¥é˜Ÿåˆ—ç­‰å¾…å›è°ƒã€‚</span></div><div class="line">    <span class="keyword">await</span> session.ensureLogin();</div><div class="line">    </div><div class="line">    <span class="comment">// ç™»å½•æˆåŠŸåï¼Œè·å– tokenï¼Œé€šè¿‡ headers ä¼ é€’ç»™åç«¯ã€‚</span></div><div class="line">    <span class="keyword">const</span> token = <span class="keyword">await</span> session.getToken();</div><div class="line">    <span class="built_in">Object</span>.assign(req.headers, &#123; [AUTH_KEY_NAME]: token &#125;);</div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  <span class="keyword">return</span> req;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h3 id="3-1-3-è‡ªå®šä¹‰ç™»å½•æ€è¿‡æœŸçš„å®¹é”™å¤„ç†"><a href="#3-1-3-è‡ªå®šä¹‰ç™»å½•æ€è¿‡æœŸçš„å®¹é”™å¤„ç†" class="headerlink" title="3.1.3 è‡ªå®šä¹‰ç™»å½•æ€è¿‡æœŸçš„å®¹é”™å¤„ç†"></a>3.1.3 è‡ªå®šä¹‰ç™»å½•æ€è¿‡æœŸçš„å®¹é”™å¤„ç†</h3><p>å½“è‡ªå®šä¹‰ç™»å½•æ€è¿‡æœŸçš„æ—¶å€™ï¼Œåç«¯éœ€è¦è¿”å›ç‰¹å®šçš„çŠ¶æ€ç ï¼Œä¾‹å¦‚ï¼š<code>AUTH_EXPIRED</code> ã€ <code>AUTH_INVALID</code> ç­‰ã€‚</p>
<p>å‰ç«¯å¯ä»¥åœ¨ã€Œç½‘ç»œè¯·æ±‚å±‚ã€å»ç›‘å¬æ‰€æœ‰è¯·æ±‚çš„è¿™ä¸ªçŠ¶æ€ç ï¼Œç„¶åå‘èµ·åˆ·æ–°ç™»å½•æ€ï¼Œå†å»é‡æ”¾å¤±è´¥çš„è¯·æ±‚ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æ·»åŠ å“åº”æ‹¦æˆªå™¨</span></div><div class="line">fly.interceptors.response.use(</div><div class="line">    <span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</div><div class="line">      <span class="keyword">const</span> code = res.data;</div><div class="line">        </div><div class="line">      <span class="comment">// ç™»å½•æ€è¿‡æœŸæˆ–å¤±æ•ˆ</span></div><div class="line">      <span class="keyword">if</span> ( [<span class="string">'AUTH_EXPIRED'</span>, <span class="string">'AUTH_INVALID'</span>].includes(code) ) &#123;</div><div class="line">      </div><div class="line">        <span class="comment">// åˆ·æ–°ç™»å½•æ€</span></div><div class="line">        <span class="keyword">await</span> session.refreshLogin();</div><div class="line">        </div><div class="line">        <span class="comment">// ç„¶åé‡æ–°å‘èµ·è¯·æ±‚</span></div><div class="line">        <span class="keyword">return</span> fly.request(request);</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">)</div></pre></td></tr></table></figure>
<p>é‚£ä¹ˆå¦‚æœå¹¶å‘çš„å‘èµ·å¤šä¸ªè¯·æ±‚ï¼Œéƒ½è¿”å›äº†ç™»å½•æ€å¤±æ•ˆçš„çŠ¶æ€ç ï¼Œä¸Šè¿°ä»£ç å°±ä¼šè¢«æ‰§è¡Œå¤šæ¬¡ã€‚</p>
<p>æˆ‘ä»¬éœ€è¦å¯¹ <code>session.refreshLogin()</code> åšä¸€äº›ç‰¹æ®Šçš„å®¹é”™å¤„ç†ï¼š</p>
<ol>
<li><strong>è¯·æ±‚é”</strong>ï¼šåŒä¸€æ—¶é—´ï¼Œåªå…è®¸ä¸€ä¸ªæ­£åœ¨è¿‡ç¨‹ä¸­çš„ç½‘ç»œè¯·æ±‚ã€‚</li>
<li><strong>ç­‰å¾…é˜Ÿåˆ—</strong>ï¼šè¯·æ±‚è¢«é”å®šä¹‹åï¼Œè°ƒç”¨è¯¥æ–¹æ³•çš„æ‰€æœ‰è°ƒç”¨ï¼Œéƒ½æ¨å…¥ä¸€ä¸ªé˜Ÿåˆ—ä¸­ï¼Œç­‰å¾…ç½‘ç»œè¯·æ±‚å®Œæˆä¹‹åå…±ç”¨è¿”å›ç»“æœã€‚</li>
<li><strong>ç†”æ–­æœºåˆ¶</strong>ï¼šå¦‚æœçŸ­æ—¶é—´å†…å¤šæ¬¡è°ƒç”¨ï¼Œåˆ™åœæ­¢å“åº”ä¸€æ®µæ—¶é—´ï¼Œç±»ä¼¼äº TCP æ…¢å¯åŠ¨ã€‚</li>
</ol>
<p>ç¤ºä¾‹ä»£ç ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Session</span> </span>&#123;</div><div class="line">  <span class="comment">// ....</span></div><div class="line">  </div><div class="line">  <span class="comment">// åˆ·æ–°ç™»å½•ä¿é™©ä¸ï¼Œæœ€å¤šé‡å¤ 3 æ¬¡ï¼Œç„¶åç†”æ–­ï¼Œ5s åæ¢å¤</span></div><div class="line">  refreshLoginFuseLine = REFRESH_LOGIN_FUSELINE_DEFAULT;</div><div class="line">  refreshLoginFuseLocked = <span class="literal">false</span>;</div><div class="line">  refreshLoginFuseRestoreTime = <span class="number">5000</span>;</div><div class="line"></div><div class="line">  <span class="comment">// ç†”æ–­æ§åˆ¶</span></div><div class="line">  refreshLoginFuse(): <span class="built_in">Promise</span>&lt;<span class="keyword">void</span>&gt; &#123;</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.refreshLoginFuseLocked) &#123;</div><div class="line">      <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(<span class="string">'åˆ·æ–°ç™»å½•-ä¿é™©ä¸å·²ç†”æ–­ï¼Œè¯·ç¨å'</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.refreshLoginFuseLine &gt; <span class="number">0</span>) &#123;</div><div class="line">      <span class="keyword">this</span>.refreshLoginFuseLine = <span class="keyword">this</span>.refreshLoginFuseLine - <span class="number">1</span>;</div><div class="line">      <span class="keyword">return</span> <span class="built_in">Promise</span>.resolve();</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      <span class="keyword">this</span>.refreshLoginFuseLocked = <span class="literal">true</span>;</div><div class="line">      setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">        <span class="keyword">this</span>.refreshLoginFuseLocked = <span class="literal">false</span>;</div><div class="line">        <span class="keyword">this</span>.refreshLoginFuseLine = REFRESH_LOGIN_FUSELINE_DEFAULT;</div><div class="line">        logger.info(<span class="string">'åˆ·æ–°ç™»å½•-ä¿é™©ä¸ç†”æ–­è§£é™¤'</span>);</div><div class="line">      &#125;, <span class="keyword">this</span>.refreshLoginFuseRestoreTime);</div><div class="line">      <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(<span class="string">'åˆ·æ–°ç™»å½•-ä¿é™©ä¸ç†”æ–­!!'</span>);</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="comment">// å¹¶å‘å›è°ƒé˜Ÿåˆ—</span></div><div class="line">  refreshLoginQueueMaxLength = <span class="number">100</span>;</div><div class="line">  refreshLoginQueue: any[] = [];</div><div class="line">  refreshLoginLocked = <span class="literal">false</span>;</div><div class="line"></div><div class="line">  <span class="comment">// åˆ·æ–°ç™»å½•æ€</span></div><div class="line">  refreshLogin(): <span class="built_in">Promise</span>&lt;<span class="keyword">void</span>&gt; &#123;</div><div class="line">    <span class="keyword">return</span> <span class="built_in">Promise</span>.resolve()</div><div class="line">    </div><div class="line">      <span class="comment">// å›è°ƒé˜Ÿåˆ— + ç†”æ–­ æ§åˆ¶</span></div><div class="line">      .then(<span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">this</span>.refreshLoginFuse())</div><div class="line">      .then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.refreshLoginLocked) &#123;</div><div class="line">          <span class="keyword">const</span> maxLength = <span class="keyword">this</span>.refreshLoginQueueMaxLength;</div><div class="line">          <span class="keyword">if</span> (<span class="keyword">this</span>.refreshLoginQueue.length &gt;= maxLength) &#123;</div><div class="line">            <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(<span class="string">`refreshLoginQueue è¶…å‡ºå®¹é‡ï¼š<span class="subst">$&#123;maxLength&#125;</span>`</span>);</div><div class="line">          &#125;</div><div class="line">          <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</div><div class="line">            <span class="keyword">this</span>.refreshLoginQueue.push([resolve, reject]);</div><div class="line">          &#125;);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">this</span>.refreshLoginLocked = <span class="literal">true</span>;</div><div class="line">      &#125;)</div><div class="line"></div><div class="line">      <span class="comment">// é€šè¿‡å‰ç½®æ§åˆ¶ä¹‹åï¼Œå‘èµ·ç™»å½•è¿‡ç¨‹</span></div><div class="line">      .then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">        <span class="keyword">this</span>.clearSession();</div><div class="line">        wx.showLoading(&#123; <span class="attr">title</span>: <span class="string">'åˆ·æ–°ç™»å½•æ€ä¸­'</span>, <span class="attr">mask</span>: <span class="literal">true</span> &#125;);</div><div class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.login()</div><div class="line">          .then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">            wx.hideLoading();</div><div class="line">            wx.showToast(&#123; <span class="attr">icon</span>: <span class="string">'none'</span>, <span class="attr">title</span>: <span class="string">'ç™»å½•æˆåŠŸ'</span> &#125;);</div><div class="line">            <span class="keyword">this</span>.refreshLoginQueue.forEach(<span class="function">(<span class="params">[resolve]</span>) =&gt;</span> resolve());</div><div class="line">            <span class="keyword">this</span>.refreshLoginLocked = <span class="literal">false</span>;</div><div class="line">          &#125;)</div><div class="line">          .catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</div><div class="line">            wx.hideLoading();</div><div class="line">            wx.showToast(&#123; <span class="attr">icon</span>: <span class="string">'none'</span>, <span class="attr">title</span>: <span class="string">'ç™»å½•å¤±è´¥'</span> &#125;);</div><div class="line">            <span class="keyword">this</span>.refreshLoginQueue.forEach(<span class="function">(<span class="params">[, reject]</span>) =&gt;</span> reject());</div><div class="line">            <span class="keyword">this</span>.refreshLoginLocked = <span class="literal">false</span>;</div><div class="line">            <span class="keyword">throw</span> err;</div><div class="line">          &#125;);</div><div class="line">      &#125;);</div><div class="line"></div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="3-1-4-å¾®ä¿¡-session-key-è¿‡æœŸçš„å®¹é”™å¤„ç†"><a href="#3-1-4-å¾®ä¿¡-session-key-è¿‡æœŸçš„å®¹é”™å¤„ç†" class="headerlink" title="3.1.4 å¾®ä¿¡ session_key è¿‡æœŸçš„å®¹é”™å¤„ç†"></a>3.1.4 å¾®ä¿¡ session_key è¿‡æœŸçš„å®¹é”™å¤„ç†</h3><p>æˆ‘ä»¬ä»ä¸Šé¢çš„ã€Œé™é»˜ç™»å½•ã€ä¹‹åï¼Œå¾®ä¿¡æœåŠ¡å™¨ç«¯ä¼šä¸‹å‘ä¸€ä¸ª <code>session_key</code> ç»™åç«¯ï¼Œè€Œè¿™ä¸ªä¼šåœ¨éœ€è¦è·å–<a href="https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/signature.html" target="_blank" rel="external">å¾®ä¿¡å¼€æ”¾æ•°æ®</a>çš„æ—¶å€™ä¼šç”¨åˆ°ã€‚</p>
<p><img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/img/20201016110824.png" alt="å¾®ä¿¡å¼€æ”¾æ•°æ®"></p>
<p>è€Œ <code>session_key</code> æ˜¯æœ‰æ—¶æ•ˆæ€§çš„ï¼Œä»¥ä¸‹æ‘˜è‡ªå¾®ä¿¡å®˜æ–¹æè¿°ï¼š</p>
<blockquote>
<h4 id="ä¼šè¯å¯†é’¥-session-key-æœ‰æ•ˆæ€§"><a href="#ä¼šè¯å¯†é’¥-session-key-æœ‰æ•ˆæ€§" class="headerlink" title="ä¼šè¯å¯†é’¥ session_key æœ‰æ•ˆæ€§"></a>ä¼šè¯å¯†é’¥ session_key æœ‰æ•ˆæ€§</h4><p>å¼€å‘è€…å¦‚æœé‡åˆ°å› ä¸º session_key ä¸æ­£ç¡®è€Œæ ¡éªŒç­¾åå¤±è´¥æˆ–è§£å¯†å¤±è´¥ï¼Œè¯·å…³æ³¨ä¸‹é¢å‡ ä¸ªä¸ session_key æœ‰å…³çš„æ³¨æ„äº‹é¡¹ã€‚</p>
<ol>
<li><a href="https://developers.weixin.qq.com/miniprogram/dev/api/open-api/login/wx.login.html" target="_blank" rel="external">wx.login</a> è°ƒç”¨æ—¶ï¼Œç”¨æˆ·çš„ session_key <strong>å¯èƒ½</strong>ä¼šè¢«æ›´æ–°è€Œè‡´ä½¿æ—§ session_key å¤±æ•ˆï¼ˆåˆ·æ–°æœºåˆ¶å­˜åœ¨æœ€çŸ­å‘¨æœŸï¼Œå¦‚æœåŒä¸€ä¸ªç”¨æˆ·çŸ­æ—¶é—´å†…å¤šæ¬¡è°ƒç”¨ <a href="https://developers.weixin.qq.com/miniprogram/dev/api/open-api/login/wx.login.html" target="_blank" rel="external">wx.login</a>ï¼Œå¹¶éæ¯æ¬¡è°ƒç”¨éƒ½å¯¼è‡´ session_key åˆ·æ–°ï¼‰ã€‚å¼€å‘è€…åº”è¯¥åœ¨æ˜ç¡®éœ€è¦é‡æ–°ç™»å½•æ—¶æ‰è°ƒç”¨ <a href="https://developers.weixin.qq.com/miniprogram/dev/api/open-api/login/wx.login.html" target="_blank" rel="external">wx.login</a>ï¼ŒåŠæ—¶é€šè¿‡ <a href="https://developers.weixin.qq.com/miniprogram/dev/api-backend/open-api/login/auth.code2Session.html" target="_blank" rel="external">auth.code2Session</a> æ¥å£æ›´æ–°æœåŠ¡å™¨å­˜å‚¨çš„ session_keyã€‚</li>
<li>å¾®ä¿¡ä¸ä¼šæŠŠ session_key çš„æœ‰æ•ˆæœŸå‘ŠçŸ¥å¼€å‘è€…ã€‚æˆ‘ä»¬ä¼šæ ¹æ®ç”¨æˆ·ä½¿ç”¨å°ç¨‹åºçš„è¡Œä¸ºå¯¹ session_key è¿›è¡Œç»­æœŸã€‚ç”¨æˆ·è¶Šé¢‘ç¹ä½¿ç”¨å°ç¨‹åºï¼Œsession_key æœ‰æ•ˆæœŸè¶Šé•¿ã€‚</li>
<li>å¼€å‘è€…åœ¨ session_key å¤±æ•ˆæ—¶ï¼Œå¯ä»¥é€šè¿‡é‡æ–°æ‰§è¡Œç™»å½•æµç¨‹è·å–æœ‰æ•ˆçš„ session_keyã€‚ä½¿ç”¨æ¥å£ <a href="https://developers.weixin.qq.com/miniprogram/dev/api/open-api/login/wx.checkSession.html" target="_blank" rel="external">wx.checkSession</a>å¯ä»¥æ ¡éªŒ session_key æ˜¯å¦æœ‰æ•ˆï¼Œä»è€Œé¿å…å°ç¨‹åºåå¤æ‰§è¡Œç™»å½•æµç¨‹ã€‚</li>
<li>å½“å¼€å‘è€…åœ¨å®ç°è‡ªå®šä¹‰ç™»å½•æ€æ—¶ï¼Œå¯ä»¥è€ƒè™‘ä»¥ session_key æœ‰æ•ˆæœŸä½œä¸ºè‡ªèº«ç™»å½•æ€æœ‰æ•ˆæœŸï¼Œä¹Ÿå¯ä»¥å®ç°è‡ªå®šä¹‰çš„æ—¶æ•ˆæ€§ç­–ç•¥ã€‚</li>
</ol>
</blockquote>
<p>ç¿»è¯‘æˆç®€å•çš„ä¸¤å¥è¯ï¼š</p>
<ol>
<li><code>session_key</code> æ—¶æ•ˆæ€§ç”±å¾®ä¿¡æ§åˆ¶ï¼Œå¼€å‘è€…ä¸å¯é¢„æµ‹ã€‚</li>
<li><code>wx.login</code> å¯èƒ½ä¼šå¯¼è‡´ <code>session_key</code> è¿‡æœŸï¼Œå¯ä»¥åœ¨ä½¿ç”¨æ¥å£ä¹‹å‰ç”¨<code>wx.checkSession</code> æ£€æŸ¥ä¸€ä¸‹ã€‚</li>
</ol>
<p>è€Œå¯¹äºç¬¬äºŒç‚¹ï¼Œæˆ‘ä»¬é€šè¿‡å®éªŒå‘ç°ï¼Œå¶å‘æ€§çš„åœ¨ <code>session_key</code> å·²è¿‡æœŸçš„æƒ…å†µä¸‹ï¼Œ<code>wx.checkSession</code> ä¼šæ¦‚ç‡æ€§è¿”å› <code>true</code></p>
<p>ç¤¾åŒºä¹Ÿæœ‰ç›¸å…³çš„åé¦ˆæœªå¾—åˆ°è§£å†³ï¼š</p>
<ul>
<li><a href="https://developers.weixin.qq.com/community/develop/doc/000424005b89983f337a622c751000?highLine=wx.checkSession" target="_blank" rel="external">å°ç¨‹åºè§£å¯†æ‰‹æœºå·,éš”ä¸€å°æ®µæ—¶é—´å,checksession:ok,ä½†æ˜¯è§£å¯†å¤±è´¥</a></li>
<li><a href="https://developers.weixin.qq.com/community/develop/doc/0008e429bd0c886e10699f59c51000?_at=1602745291452" target="_blank" rel="external">wx.checkSessionæœ‰æ•ˆï¼Œä½†æ˜¯è§£å¯†æ•°æ®å¤±è´¥</a></li>
<li><a href="https://developers.weixin.qq.com/community/develop/doc/000a04ab4546d80d5428ffcee51800?_at=1602745291452" target="_blank" rel="external">checkSessionåˆ¤æ–­session_keyæœªå¤±æ•ˆï¼Œä½†æ˜¯è§£å¯†æ‰‹æœºå·å¤±è´¥</a></li>
</ul>
<p><strong>æ‰€ä»¥ç»“è®ºæ˜¯ï¼š<code>wx.checkSession</code>å¯é æ€§æ˜¯ä¸è¾¾ 100% çš„ã€‚</strong></p>
<p>åŸºäºä»¥ä¸Šï¼Œæˆ‘ä»¬éœ€è¦å¯¹ <code>session_key</code> çš„è¿‡æœŸåšä¸€äº›å®¹é”™å¤„ç†ï¼š</p>
<ol>
<li>å‘èµ·éœ€è¦ä½¿ç”¨ <code>session_key</code> çš„è¯·æ±‚å‰ï¼Œåšä¸€æ¬¡ <code>wx.checkSession</code> æ“ä½œï¼Œå¦‚æœå¤±è´¥äº†åˆ·æ–°ç™»å½•æ€ã€‚</li>
<li>åç«¯ä½¿ç”¨ <code>session_key</code> è§£å¯†å¼€æ”¾æ•°æ®å¤±è´¥ä¹‹åï¼Œè¿”å›ç‰¹å®šé”™è¯¯ç ï¼ˆå¦‚ï¼š<code>DECRYPT_WX_OPEN_DATA_FAIL</code>ï¼‰ï¼Œå‰ç«¯åˆ·æ–°ç™»å½•æ€ã€‚</li>
</ol>
<p>ç¤ºä¾‹ä»£ç ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// å®šä¹‰æ£€æŸ¥ session_key æœ‰æ•ˆæ€§çš„æ“ä½œ</span></div><div class="line"><span class="keyword">const</span> ensureSessionKey = <span class="keyword">async</span> () =&gt; &#123;</div><div class="line">  <span class="keyword">const</span> hasSession = <span class="keyword">await</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> &#123;</div><div class="line">    wx.checkSession(&#123;</div><div class="line">      <span class="attr">success</span>: <span class="function"><span class="params">()</span> =&gt;</span> resolve(<span class="literal">true</span>),</div><div class="line">      <span class="attr">fail</span>: <span class="function"><span class="params">()</span> =&gt;</span> resolve(<span class="literal">false</span>),</div><div class="line">    &#125;);</div><div class="line">  &#125;);</div><div class="line">  </div><div class="line">  <span class="keyword">if</span> (!hasSession) &#123;</div><div class="line">    logger.info(<span class="string">'sessionKey å·²è¿‡æœŸï¼Œåˆ·æ–°ç™»å½•æ€'</span>);</div><div class="line"></div><div class="line">    <span class="comment">// æ¥ä¸Šé¢æåˆ°çš„åˆ·æ–°ç™»å½•é€»è¾‘</span></div><div class="line">    <span class="keyword">return</span> session.refreshLogin();</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">return</span> <span class="built_in">Promise</span>.resolve();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// åœ¨å‘èµ·è¯·æ±‚çš„æ—¶å€™ï¼Œå…ˆåšä¸€æ¬¡ç¡®ä¿ session_key æœ€æ–°çš„æ“ä½œï¼ˆä»¥ fly.js ä½œä¸ºç½‘ç»œè¯·æ±‚å±‚ä¸ºä¾‹ï¼‰</span></div><div class="line"><span class="keyword">const</span> updatePhone = <span class="keyword">async</span> (params) =&gt; &#123;</div><div class="line">  <span class="keyword">await</span> ensureSessionKey();</div><div class="line">  <span class="keyword">const</span> res = <span class="keyword">await</span> fly.post(<span class="string">'https://xxx'</span>, params);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// æ·»åŠ å“åº”æ‹¦æˆªå™¨, ç›‘å¬ç½‘ç»œè¯·æ±‚è¿”å›</span></div><div class="line">fly.interceptors.response.use(</div><div class="line">    <span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</div><div class="line">      <span class="keyword">const</span> code = res.data;</div><div class="line">        </div><div class="line">      <span class="comment">// ç™»å½•æ€è¿‡æœŸæˆ–å¤±æ•ˆ</span></div><div class="line">      <span class="keyword">if</span> ( [<span class="string">'DECRYPT_WX_OPEN_DATA_FAIL'</span>].includes(code)) &#123;</div><div class="line"></div><div class="line">        <span class="comment">// åˆ·æ–°ç™»å½•æ€</span></div><div class="line">        <span class="keyword">await</span> session.refreshLogin();</div><div class="line">        </div><div class="line">        <span class="comment">// ç”±äºåŠ å¯†åœºæ™¯çš„åŠ å¯†æ•°æ®ç”±ç”¨æˆ·ç‚¹å‡»äº§ç”Ÿï¼Œsession_key å¯èƒ½å·²ç»æ›´æ”¹ï¼Œéœ€è¦ç”¨æˆ·é‡æ–°ç‚¹å‡»ä¸€éã€‚</span></div><div class="line">        wx.showToast(&#123; <span class="attr">title</span>: <span class="string">'ç½‘ç»œå‡ºå°å·®äº†ï¼Œè¯·ç¨åé‡è¯•'</span>, <span class="attr">icon</span>: <span class="string">'none'</span> &#125;);</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">)</div></pre></td></tr></table></figure>
<h2 id="3-2-æˆæƒçš„å®ç°"><a href="#3-2-æˆæƒçš„å®ç°" class="headerlink" title="3.2 æˆæƒçš„å®ç°"></a>3.2 æˆæƒçš„å®ç°</h2><h3 id="3-2-1-ç»„ä»¶æ‹†åˆ†ä¸è®¾è®¡"><a href="#3-2-1-ç»„ä»¶æ‹†åˆ†ä¸è®¾è®¡" class="headerlink" title="3.2.1 ç»„ä»¶æ‹†åˆ†ä¸è®¾è®¡"></a>3.2.1 ç»„ä»¶æ‹†åˆ†ä¸è®¾è®¡</h3><p>åœ¨ç”¨æˆ·ä¿¡æ¯å’Œæ‰‹æœºå·è·å–çš„æ–¹å¼ä¸Šï¼Œå¾®ä¿¡æ˜¯ä»¥ <code>&lt;button open-type=&#39;xxx&#39; /&gt;</code> çš„æ–¹å¼ï¼Œè®©ç”¨æˆ·ä¸»åŠ¨ç‚¹å‡»æˆæƒçš„ã€‚</p>
<p>é‚£ä¹ˆä¸ºäº†è®©ä»£ç æ›´è§£è€¦ï¼Œæˆ‘ä»¬è®¾è®¡è¿™æ ·ä¸‰ä¸ªç»„ä»¶ï¼š</p>
<ol>
<li><code>&lt;user-contaienr getUserInfo=&quot;onUserInfoAuth&quot;&gt;</code>: åŒ…è£…ç‚¹å‡»äº¤äº’ï¼Œé€šè¿‡ <code>&lt;slot&gt;</code> æ”¯æŒç‚¹å‡»åŒºåŸŸçš„è‡ªå®šä¹‰UIã€‚</li>
<li><code>&lt;phone-container getPhonenNmber=&quot;onPhoneAuth&quot;&gt;</code> : ä¸ <code>&lt;user-container&gt;</code> åŒç†ã€‚</li>
<li><code>&lt;auth-flow&gt;</code>: æ ¹æ®ä¸šåŠ¡éœ€è¦ï¼Œç»„åˆ <code>&lt;user-container&gt;</code>ã€<code>&lt;phone-container&gt;</code> ç»„åˆæ¥å®šä¹‰ä¸åŒçš„æˆæƒæµç¨‹ã€‚</li>
</ol>
<p>ä»¥å¼€å¤´çš„ä¸šåŠ¡åœºæ™¯çš„æµç¨‹ä¸ºä¾‹ï¼Œå®ƒæœ‰è¿™æ ·çš„è¦æ±‚ï¼š</p>
<ol>
<li>æœ‰å¤šä¸ªæ­¥éª¤ã€‚</li>
<li>å¦‚æœä¸­é€”æ–­æ‰äº†ï¼Œå¯ä»¥ä»ä¸­é—´æ¥ä¸Šã€‚</li>
<li>æœ‰äº›åœºæ™¯ä¸­ï¼Œåªè¦æ±‚è¾¾åˆ°ã€Œç”¨æˆ·ä¿¡æ¯æˆæƒã€ï¼Œè€Œä¸éœ€è¦å®Œæˆã€Œç”¨æˆ·æ‰‹æœºå·ã€ã€‚</li>
</ol>
<p><img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/img/20201016111006.jpg" alt="å®Œæ•´æˆæƒæµç¨‹"></p>
<p>é‚£ä¹ˆæˆæƒçš„é˜¶æ®µå¯ä»¥åˆ†ä¸‰å±‚ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ç”¨æˆ·ç™»å½•çš„é˜¶æ®µ</span></div><div class="line"><span class="keyword">export</span> enum AuthStep &#123;</div><div class="line">  <span class="comment">// é˜¶æ®µä¸€ï¼šåªæœ‰ç™»å½•æ€ï¼Œæ²¡æœ‰ç”¨æˆ·ä¿¡æ¯ï¼Œæ²¡æœ‰æ‰‹æœºå·</span></div><div class="line">  ONE = <span class="number">1</span>,</div><div class="line"></div><div class="line">  <span class="comment">// é˜¶æ®µäºŒï¼šæœ‰ç”¨æˆ·ä¿¡æ¯ï¼Œæ²¡æœ‰æ‰‹æœºå·</span></div><div class="line">  TWO = <span class="number">2</span>,</div><div class="line"></div><div class="line">  <span class="comment">// é˜¶æ®µä¸‰ï¼šæœ‰ç”¨æˆ·ä¿¡æ¯ï¼Œæœ‰æ‰‹æœºå·</span></div><div class="line">  THREE = <span class="number">3</span>,</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>AuthStep</code> çš„æ¨è¿›è¿‡ç¨‹æ˜¯ä¸å¯é€†çš„ï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ª <code>nextStep</code> å‡½æ•°æ¥å°è£… AuthStep æ›´æ–°çš„é€»è¾‘ã€‚å¤–éƒ¨ä½¿ç”¨çš„è¯ï¼Œåªè¦æ— è„‘è°ƒç”¨ <code>nextStep</code> æ–¹æ³•ï¼Œç­‰å¾…å›è°ƒç»“æœå°±è¡Œã€‚</p>
<p>ç¤ºä¾‹ä¼ªä»£ç ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// auth-flow component</span></div><div class="line"></div><div class="line">Component(&#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">  </div><div class="line">  data: &#123;</div><div class="line">    <span class="comment">// é»˜è®¤æƒ…å†µä¸‹ï¼Œåªéœ€è¦åˆ°è¾¾é˜¶æ®µäºŒã€‚</span></div><div class="line">    mustAuthStep: AuthStep.TWO</div><div class="line">  &#125;,</div><div class="line">  </div><div class="line">  <span class="comment">// å…è®¸ä¸´æ—¶æ›´æ”¹ç»„ä»¶çš„éœ€è¦è¾¾åˆ°çš„é˜¶æ®µã€‚</span></div><div class="line">  setMustAuthStep(mustAuthStep: AuthStep) &#123;</div><div class="line">    <span class="keyword">this</span>.setData(&#123; mustAuthStep &#125;);</div><div class="line">  &#125;,</div><div class="line">  </div><div class="line">  <span class="comment">// æ ¹æ®ç”¨æˆ·å½“å‰çš„ä¿¡æ¯ï¼Œè®¡ç®—ç”¨æˆ·å¤„åœ¨æˆæƒçš„é˜¶æ®µ</span></div><div class="line">  getAuthStep() &#123;</div><div class="line">    <span class="keyword">let</span> currAuthStep;</div><div class="line">    </div><div class="line">    <span class="comment">// æ²¡æœ‰ç”¨æˆ·ä¿¡æ¯ï¼Œå°šåœ¨ç¬¬ä¸€æ­¥</span></div><div class="line">    <span class="keyword">if</span> (!session.hasUser() || !session.hasUnionId()) &#123;</div><div class="line">      currAuthStep = AuthStepType.ONE;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// æ²¡æœ‰æ‰‹æœºå·ï¼Œå°šåœ¨ç¬¬äºŒæ­¥</span></div><div class="line">    <span class="keyword">if</span> (!session.hasPhone()) &#123;</div><div class="line">      currAuthStep = AuthStepType.TWO;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// éƒ½æœ‰ï¼Œå°šåœ¨ç¬¬ä¸‰æ­¥</span></div><div class="line">    currAuthStep = AuthStepType.THREE;</div><div class="line">    <span class="keyword">return</span> currAuthStep;</div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  <span class="comment">// å‘èµ·ä¸‹ä¸€æ­¥æˆæƒï¼Œå¦‚æœéƒ½å·²ç»å®Œæˆï¼Œå°±ç›´æ¥è¿”å›æˆåŠŸã€‚</span></div><div class="line">  nextStep(e) &#123;</div><div class="line">    <span class="keyword">const</span> &#123; mustAuthStep &#125; = <span class="keyword">this</span>.data;</div><div class="line">    <span class="keyword">const</span> currAuthStep = <span class="keyword">this</span>.updateAuthStep();</div><div class="line">  </div><div class="line">    <span class="comment">// å·²å®Œæˆæˆæƒ</span></div><div class="line">    <span class="keyword">if</span> (currAuthStep &gt;= mustAuthStep || currAuthStep === AuthStepType.THREE) &#123;</div><div class="line">      <span class="comment">// æ›´æ–°å…¨å±€çš„æˆæƒçŠ¶æ€æœºï¼Œå¹¿æ’­æ¶ˆæ¯ç»™è®¢é˜…è€…ã€‚</span></div><div class="line">      <span class="keyword">return</span> getApp().status.auth.success();</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// ç¬¬ä¸€æ­¥ï¼šæ›´æ–°ç”¨æˆ·ä¿¡æ¯</span></div><div class="line">    <span class="keyword">if</span> (currAuthStep === AuthStepType.ONE) &#123;</div><div class="line">      <span class="comment">// å·²æœ‰å¯†æ–‡ä¿¡æ¯ï¼Œæ›´æ–°ç”¨æˆ·ä¿¡æ¯</span></div><div class="line">      <span class="keyword">if</span> (e) session.updateUser(e);</div><div class="line"></div><div class="line">      <span class="comment">// æ›´æ–°åˆ°è§†å›¾å±‚ï¼Œå±•ç¤ºå¯¹åº”UIï¼Œç­‰å¾…è·å–ç”¨æˆ·ä¿¡æ¯</span></div><div class="line">      <span class="keyword">else</span> <span class="keyword">this</span>.setData(&#123; currAuthStep &#125;);</div><div class="line">      <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// ç¬¬äºŒæ­¥ï¼šæ›´æ–°æ‰‹æœºä¿¡æ¯</span></div><div class="line">    <span class="keyword">if</span> (currAuthStep === AuthStepType.TWO) &#123;</div><div class="line">      <span class="comment">// å·²æœ‰å¯†æ–‡ä¿¡æ¯ï¼Œæ›´æ–°æ‰‹æœºå·</span></div><div class="line">      <span class="keyword">if</span> (e) <span class="keyword">this</span>.bindPhone(e);</div><div class="line"></div><div class="line">      <span class="comment">// æœªæœ‰å¯†æ–‡ä¿¡æ¯ï¼Œå¼¹å‡ºè·å–çª—å£</span></div><div class="line">      <span class="keyword">else</span> <span class="keyword">this</span>.setData(&#123; currAuthStep &#125;);</div><div class="line">      <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="built_in">console</span>.warn(<span class="string">'auth.nextStep é”™è¯¯'</span>, &#123; currAuthStep, mustAuthStep &#125;);</div><div class="line">  &#125;,</div><div class="line">  </div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>é‚£ä¹ˆæˆ‘ä»¬çš„ <code>&lt;auth-flow&gt;</code> ä¸­å°±å¯ä»¥æ ¹æ® <code>currAuthStep</code> å’Œ <code>mustAuthStep</code> æ¥å»åšä¸åŒçš„ UI å±•ç¤ºã€‚éœ€è¦æ³¨æ„çš„æ˜¯ä½¿ç”¨ <code>&lt;user-container&gt;</code>ã€<code>&lt;phone-container&gt;</code> çš„æ—¶å€™è¿æ¥ä¸Š <code>nextStep(e)</code> å‡½æ•°ã€‚</p>
<p>ç¤ºä¾‹ä¼ªä»£ç ï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"auth-flow"</span>&gt;</span></div><div class="line"></div><div class="line">  <span class="comment">&lt;!-- å·²å®Œæˆæˆæƒ --&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">block</span> <span class="attr">wx:if</span>=<span class="string">"&#123;&#123;currAuthStep === mustAuthStep || currAuthStep === AuthStep.THREE&#125;&#125;"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">view</span>&gt;</span>å·²å®Œæˆæˆæƒ<span class="tag">&lt;/<span class="name">view</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">block</span>&gt;</span></div><div class="line"></div><div class="line">  <span class="comment">&lt;!-- æœªå®Œæˆæˆæƒï¼Œç¬¬ä¸€æ­¥ï¼šæˆæƒç”¨æˆ·ä¿¡æ¯ --&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">block</span> <span class="attr">wx:elif</span>=<span class="string">"&#123;&#123;currAuthStep === AuthStep.ONE&#125;&#125;"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">user-container</span> <span class="attr">bind:getuserinfo</span>=<span class="string">"nextStep"</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">view</span>&gt;</span>æˆæƒç”¨æˆ·ä¿¡æ¯<span class="tag">&lt;/<span class="name">view</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">user-container</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">block</span>&gt;</span></div><div class="line"></div><div class="line">  <span class="comment">&lt;!-- æœªå®Œæˆæˆæƒï¼Œç¬¬äºŒæ­¥ï¼šæˆæƒæ‰‹æœºå· --&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">block</span> <span class="attr">wx:elif</span>=<span class="string">"&#123;&#123;currAuthStep === AuthStep.TWO&#125;&#125;"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">phone-container</span> <span class="attr">bind:getphonenumber</span>=<span class="string">"nextStep"</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">view</span>&gt;</span>æˆæƒæ‰‹æœºå·<span class="tag">&lt;/<span class="name">view</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">phone-container</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">block</span>&gt;</span></div><div class="line">  </div><div class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></div></pre></td></tr></table></figure>
<h3 id="3-2-2-æƒé™æ‹¦æˆªçš„å¤„ç†"><a href="#3-2-2-æƒé™æ‹¦æˆªçš„å¤„ç†" class="headerlink" title="3.2.2 æƒé™æ‹¦æˆªçš„å¤„ç†"></a>3.2.2 æƒé™æ‹¦æˆªçš„å¤„ç†</h3><p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬åˆ¶ä½œå¥½äº†ç”¨æ¥æ‰¿è½½æˆæƒæµç¨‹çš„ç»„ä»¶ <code>&lt;auth-flow&gt;</code> ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥å°±æ˜¯å†³å®šè¦ä½¿ç”¨å®ƒçš„æ—¶æœºäº†ã€‚</p>
<p>æˆ‘ä»¬æ¢³ç†éœ€è¦æˆæƒçš„åœºæ™¯ï¼š</p>
<ol>
<li><p>ç‚¹å‡»æŸä¸ªæŒ‰é’®ï¼Œä¾‹å¦‚ï¼šè´­ä¹°æŸä¸ªå•†å“ã€‚</p>
<p>å¯¹äºè¿™ç§åœºæ™¯ï¼Œå¸¸è§çš„æ˜¯é€šè¿‡å¼¹çª—å®Œæˆæˆæƒï¼Œç”¨æˆ·å¯ä»¥é€‰æ‹©å…³é—­ã€‚</p>
</li>
</ol>
<p>   <img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/img/20201016113312.png" alt="æˆæƒæ¨¡å‹-å¼¹çª—"></p>
<ol>
<li><p>æµè§ˆæŸä¸ªé¡µé¢ï¼Œä¾‹å¦‚ï¼šè®¿é—®ä¸ªäººä¸­å¿ƒã€‚</p>
<p>å¯¹äºè¿™ç§åœºæ™¯ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç‚¹å‡»è·³è½¬æŸä¸ªé¡µé¢çš„æ—¶å€™ï¼Œè¿›è¡Œæ‹¦æˆªï¼Œå¼¹çª—å¤„ç†ã€‚ä½†è¿™æ ·çš„ç¼ºç‚¹æ˜¯ï¼Œè·³è½¬åˆ°ç›®æ ‡é¡µé¢çš„åœ°æ–¹å¯èƒ½ä¼šå¾ˆå¤šï¼Œæ¯ä¸ªéƒ½æ‹¦æˆªï¼Œéš¾å…ä¼šé”™æ¼ã€‚è€Œä¸”å½“ç›®æ ‡é¡µé¢ä½œä¸ºã€Œå°ç¨‹åºè½åœ°é¡µé¢ã€çš„æ—¶å€™ï¼Œå°±é¿å…ä¸äº†ã€‚</p>
<p>è¿™æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡é‡å®šå‘åˆ°æˆæƒé¡µé¢æ¥å®Œæˆæˆæƒæµç¨‹ï¼Œå®Œæˆä¹‹åï¼Œå†å›æ¥ã€‚</p>
</li>
</ol>
<p>   <img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/img/20201016113324.png" alt="æˆæƒæ¨¡å‹-é¡µé¢"></p>
<p>é‚£ä¹ˆæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªæšä¸¾å˜é‡ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æˆæƒçš„å±•ç¤ºå½¢å¼</span></div><div class="line"><span class="keyword">export</span> enum AuthDisplayMode &#123;</div><div class="line">  <span class="comment">// ä»¥å¼¹çª—å½¢å¼</span></div><div class="line">  POPUP = <span class="string">'button'</span>,</div><div class="line"></div><div class="line">  <span class="comment">// ä»¥é¡µé¢å½¢å¼</span></div><div class="line">  PAGE = <span class="string">'page'</span>,</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>æˆ‘ä»¬å¯ä»¥è®¾è®¡ä¸€ä¸ª <code>mustAuth</code> æ–¹æ³•ï¼Œåœ¨ç‚¹å‡»æŸä¸ªæŒ‰é’®ï¼Œæˆ–è€…é¡µé¢åŠ è½½çš„æ—¶å€™ï¼Œè¿›è¡Œæˆæƒæ§åˆ¶ã€‚</p>
<p>ä¼ªä»£ç ç¤ºä¾‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Session</span> </span>&#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">  </div><div class="line">  mustAuth(&#123;</div><div class="line">    mustAuthStep = AuthStepType.TWO, <span class="comment">// éœ€è¦æˆæƒçš„LEVELï¼Œé»˜è®¤éœ€è¦è·å–ç”¨æˆ·èµ„æ–™</span></div><div class="line">    popupCompName = <span class="string">'auth-popup'</span>,	<span class="comment">// æˆæƒå¼¹çª—ç»„ä»¶çš„ id</span></div><div class="line">    mode = AuthDisplayMode.POPUP, <span class="comment">// é»˜è®¤ä»¥å¼¹çª—æ¨¡å¼</span></div><div class="line">  &#125; = &#123;&#125;): <span class="built_in">Promise</span>&lt;<span class="keyword">void</span>&gt; &#123;</div><div class="line">    </div><div class="line">    <span class="comment">// å¦‚æœå½“å‰çš„æˆæƒæ­¥éª¤å·²ç»è¾¾æ ‡ï¼Œåˆ™è¿”å›æˆåŠŸ</span></div><div class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.currentAuthStep() &gt;= mustAuthStep) <span class="keyword">return</span> <span class="built_in">Promise</span>.resolve();</div><div class="line"></div><div class="line">    <span class="comment">// å°è¯•è·å–å½“å‰é¡µé¢çš„ &lt;auth-popup id="auth-popup" /&gt; ç»„ä»¶å®ä¾‹</span></div><div class="line">    <span class="keyword">const</span> pages = getCurrentPages();</div><div class="line">    <span class="keyword">const</span> curPage = pages[pages.length - <span class="number">1</span>];</div><div class="line">    <span class="keyword">const</span> popupComp = curPage.selectComponent(<span class="string">`#<span class="subst">$&#123;popupCompName&#125;</span>`</span>);</div><div class="line"></div><div class="line">    <span class="comment">// ç»„ä»¶ä¸å­˜åœ¨æˆ–è€…æ˜¾ç¤ºæŒ‡å®šé¡µé¢ï¼Œè·³è½¬åˆ°æˆæƒé¡µé¢</span></div><div class="line">    <span class="keyword">if</span> (!popupComp || mode === AuthDisplayMode.PAGE) &#123;</div><div class="line">      <span class="keyword">const</span> curRoute = curPage.route;</div><div class="line"></div><div class="line">      <span class="comment">// è·³è½¬åˆ°æˆæƒé¡µé¢ï¼Œå¸¦ä¸Šå½“å‰é¡µé¢è·¯ç”±ï¼Œæˆæƒå®Œæˆä¹‹åï¼Œå›åˆ°å½“å‰é¡µé¢ã€‚</span></div><div class="line">      wx.redirectTo(&#123; <span class="attr">url</span>: <span class="string">`authPage?backTo=<span class="subst">$&#123;<span class="built_in">encodeURIComponent</span>(curRoute)&#125;</span>`</span> &#125;);</div><div class="line">      <span class="keyword">return</span> <span class="built_in">Promise</span>.resolve();</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">// è®¾ç½®æˆæƒ LEVELï¼Œç„¶åè°ƒç”¨ &lt;auth-popup&gt; çš„ nextStep æ–¹æ³•ï¼Œè¿›è¡Œè¿›ä¸€æ­¥çš„æˆæƒã€‚</span></div><div class="line">    popupComp.setMustAuthStep(mustAuthStep);</div><div class="line">    popupComp.nextStep();</div><div class="line"></div><div class="line">    <span class="comment">// ç­‰å¾…æˆåŠŸå›è°ƒæˆ–è€…å¤±è´¥å›è°ƒ</span></div><div class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</div><div class="line">      <span class="keyword">const</span> authStatus = getApp().status.auth;</div><div class="line">      authStatus.onceSuccess(resolve);</div><div class="line">      authStatus.onceFail(reject);</div><div class="line">    &#125;);</div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>é‚£ä¹ˆæˆ‘ä»¬å°±èƒ½åœ¨æŒ‰é’®ç‚¹å‡»ï¼Œæˆ–è€…é¡µé¢åŠ è½½çš„æ—¶å€™è¿›è¡Œæˆæƒæ‹¦æˆªï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">Page(&#123;</div><div class="line">  onLoad() &#123;</div><div class="line">    session.mustAuth().then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">      <span class="comment">// å¼€å§‹åˆå§‹åŒ–é¡µé¢...</span></div><div class="line">    &#125;)ï¼›</div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  onClick(e) &#123;</div><div class="line">    session.mustAuth().then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">      <span class="comment">// å¼€å§‹å¤„ç†å›è°ƒé€»è¾‘...</span></div><div class="line">    &#125;)ï¼›</div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>å½“ç„¶ï¼Œå¦‚æœé¡¹ç›®ä½¿ç”¨äº† TS çš„è¯ï¼Œæˆ–è€…æ”¯æŒ ES7 Decorator ç‰¹æ€§çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥ä¸º <code>mustAuth</code> æä¾›ä¸€ä¸ªè£…é¥°å™¨ç‰ˆæœ¬ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">mustAuth</span>(<span class="params">option = &#123;&#125;</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span></span></div><div class="line">    _target,</div><div class="line">    _propertyName,</div><div class="line">    descriptor,</div><div class="line">  ) &#123;</div><div class="line">    <span class="comment">// åŠ«æŒç›®æ ‡æ–¹æ³•</span></div><div class="line">    <span class="keyword">const</span> method = descriptor.value;</div><div class="line">    </div><div class="line">    <span class="comment">// é‡å†™ç›®æ ‡æ–¹æ³•</span></div><div class="line">    descriptor.value = <span class="function"><span class="keyword">function</span>(<span class="params">...args: any[]</span>) </span>&#123;</div><div class="line">      <span class="keyword">return</span> session.mustAuth(option).then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">        <span class="comment">// ç™»å½•å®Œæˆä¹‹åï¼Œé‡æ”¾åŸæ¥æ–¹æ³•</span></div><div class="line">        <span class="keyword">if</span> (method) <span class="keyword">return</span> method.apply(<span class="keyword">this</span>, args);</div><div class="line">      &#125;);</div><div class="line">    &#125;;</div><div class="line">  &#125;;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>é‚£ä¹ˆä½¿ç”¨æ–¹å¼å°±ç®€å•ä¸€äº›äº†ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">Page(&#123;</div><div class="line">  @mustAuth();</div><div class="line">  onLoad() &#123;</div><div class="line">    <span class="comment">// å¼€å§‹åˆå§‹åŒ–é¡µé¢...</span></div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  @mustAuth();</div><div class="line">  onClick(e) &#123;</div><div class="line">    <span class="comment">// å¼€å§‹å¤„ç†å›è°ƒé€»è¾‘...</span></div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<h2 id="3-3-å‰åç«¯äº¤äº’åè®®æ•´ç†"><a href="#3-3-å‰åç«¯äº¤äº’åè®®æ•´ç†" class="headerlink" title="3.3. å‰åç«¯äº¤äº’åè®®æ•´ç†"></a>3.3. å‰åç«¯äº¤äº’åè®®æ•´ç†</h2><p>ä½œä¸ºä¸€å¥—å¯å¤ç”¨çš„å°ç¨‹åºç™»å½•æ–¹æ¡ˆï¼Œå½“ç„¶éœ€è¦å»å®šä¹‰å¥½å‰åç«¯çš„äº¤äº’åè®®ã€‚</p>
<p>é‚£ä¹ˆæ•´å¥—ç™»å½•æµç¨‹ä¸‹æ¥ï¼Œéœ€è¦çš„æ¥å£æœ‰è¿™ä¹ˆå‡ ä¸ªï¼š</p>
<p><img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/img/20201016162606.png" alt="ç™»å½•æ³¨å†Œå‰åç«¯æ¥å£åè®®"></p>
<ol>
<li><p><strong>é™é»˜ç™»å½• silentLogin</strong></p>
<ol>
<li>å…¥å‚ï¼š<ol>
<li>code: äº§è‡ª wx.login()</li>
</ol>
</li>
<li>å‡ºå‚ï¼š<ol>
<li>token: è‡ªå®šä¹‰ç™»å½•æ€å‡­è¯</li>
<li>userInfo: ç”¨æˆ·ä¿¡æ¯</li>
</ol>
</li>
<li>è¯´æ˜ï¼š<ol>
<li>åç«¯åˆ©ç”¨ code è·Ÿå¾®ä¿¡å®¢æˆ·ç«¯æ¢å–ç”¨æˆ·æ ‡è¯†ï¼Œç„¶åæ³¨å†Œå¹¶ç™»å½•ç”¨æˆ·ï¼Œè¿”å›è‡ªå®šä¹‰ç™»å½•æ€ <code>token</code> ç»™å‰ç«¯</li>
<li><code>token</code> å‰ç«¯ä¼šå­˜èµ·æ¥ï¼Œæ¯ä¸ªè¯·æ±‚éƒ½ä¼šå¸¦ä¸Š</li>
<li>userInfo éœ€è¦åŒ…å«<code>nickname</code>å’Œ<code>phone</code>å­—æ®µï¼Œå‰ç«¯ç”¨äºè®¡ç®—å½“å‰ç”¨æˆ·çš„æˆæƒé˜¶æ®µã€‚å½“ç„¶è¿™ä¸ªçŠ¶æ€çš„è®°å½•å¯ä»¥æ”¾åœ¨åç«¯ï¼Œä½†æ˜¯æˆ‘ä»¬è®¤ä¸ºæ”¾åœ¨å‰ç«¯ï¼Œä¼šæ›´åŠ çµæ´»ã€‚</li>
</ol>
</li>
</ol>
</li>
<li><strong>æ›´æ–°ç”¨æˆ·ä¿¡æ¯ updateUser</strong><ol>
<li>å…¥å‚ï¼š<ol>
<li>nickname: ç”¨æˆ·æ˜µç§°</li>
<li>encrypt: å¾®ä¿¡å¼€æ”¾æ•°æ®ç›¸å…³çš„ <code>iv</code>, <code>encryptedData</code></li>
<li>ä»¥åŠå…¶ä»–å¦‚æ€§åˆ«åœ°å€ç­‰éå¿…è¦å­—æ®µ</li>
</ol>
</li>
<li>å‡ºå‚ï¼š<ol>
<li>userInfoï¼šæ›´æ–°åçš„æœ€æ–°ç”¨æˆ·ä¿¡æ¯</li>
</ol>
</li>
<li>è¯´æ˜ï¼š<ol>
<li>åç«¯è§£å¯†å¾®ä¿¡å¼€æ”¾æ•°æ®ï¼Œè·å–éšè”½æ•°æ®ï¼Œå¦‚ï¼š<code>unionId</code>ç­‰</li>
<li>åç«¯æ”¯æŒæ›´æ–°åŒ…æ‹¬ <code>nickname</code>ç­‰ç”¨æˆ·åŸºæœ¬ä¿¡æ¯ã€‚</li>
<li>å‰ç«¯ä¼šæŠŠ userInfo ä¿¡æ¯æ›´æ–°åˆ° <code>session</code> ä¸­ï¼Œç”¨äºè®¡ç®—æˆæƒé˜¶æ®µã€‚</li>
</ol>
</li>
</ol>
</li>
<li><strong>æ›´æ–°ç”¨æˆ·æ‰‹æœºå· updatePhone</strong><ol>
<li>å…¥å‚ï¼š<ol>
<li>encryptï¼šå¾®ä¿¡å¼€æ”¾æ•°æ®ç›¸å…³çš„ <code>iv</code>, <code>encryptedData</code></li>
</ol>
</li>
<li>å‡ºå‚ï¼š<ol>
<li>userInfoï¼šæ›´æ–°åçš„æœ€æ–°ç”¨æˆ·ä¿¡æ¯</li>
</ol>
</li>
<li>è¯´æ˜ï¼š<ol>
<li>åç«¯è§£å¯†å¼€æ”¾å¼å±€ï¼Œè·å–æ‰‹æœºå·ï¼Œå¹¶æ›´æ–°åˆ°ç”¨æˆ·ä¿¡æ¯ä¸­ã€‚ </li>
<li>å‰ç«¯ä¼šæŠŠ userInfo ä¿¡æ¯æ›´æ–°åˆ° <code>session</code> ä¸­ï¼Œç”¨äºè®¡ç®—æˆæƒé˜¶æ®µã€‚</li>
</ol>
</li>
</ol>
</li>
<li><strong>è§£ç»‘æ‰‹æœºå· unbindPhone</strong><ol>
<li>å…¥å‚ï¼š-</li>
<li>å‡ºå‚ï¼š-</li>
<li>è¯´æ˜ï¼šåç«¯è§£ç»‘ç”¨æˆ·æ‰‹æœºå·ï¼ŒæˆåŠŸä¸å¦ï¼Œèµ°ä¸šåŠ¡å®šä¹‰çš„å‰åç«¯åè®®ã€‚</li>
</ol>
</li>
<li><strong>ç™»å½• logout</strong><ol>
<li>å…¥å‚ï¼š-</li>
<li>å‡ºå‚ï¼š-</li>
<li>è¯´æ˜ï¼šåç«¯ä¸»åŠ¨è¿‡æœŸç™»å½•æ€ï¼ŒæˆåŠŸä¸å¦ï¼Œèµ°ä¸šåŠ¡å®šä¹‰çš„å‰åç«¯åè®®ã€‚</li>
</ol>
</li>
</ol>
<h1 id="äº”-æ¶æ„å›¾"><a href="#äº”-æ¶æ„å›¾" class="headerlink" title="äº”. æ¶æ„å›¾"></a>äº”. æ¶æ„å›¾</h1><p>æœ€åæˆ‘ä»¬æ¥æ¢³ç†ä¸€ä¸‹æ•´ä½“çš„ã€Œç™»å½•æœåŠ¡ã€çš„æ¶æ„å›¾ï¼š</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gjqk8sm9dbj30v60fp0uc.jpg" alt="å¾®ä¿¡å°ç¨‹åºç™»å½•æœåŠ¡æ¶æ„å›¾"></p>
<p>ç”±ã€Œç™»å½•æœåŠ¡ã€å’Œã€Œåº•å±‚å»ºè®¾ã€ç»„åˆæä¾›çš„é€šç”¨æœåŠ¡ï¼Œä¸šåŠ¡å±‚åªéœ€è¦å»æ ¹æ®äº§å“éœ€æ±‚ï¼Œå®šåˆ¶æˆæƒçš„æµç¨‹ <code>&lt;auth-flow&gt;</code> ï¼Œå°±èƒ½æ»¡è¶³å¤§éƒ¨åˆ†åœºæ™¯äº†ã€‚</p>
<h1 id="å…­-æ€»ç»“"><a href="#å…­-æ€»ç»“" class="headerlink" title="å…­. æ€»ç»“"></a>å…­. æ€»ç»“</h1><p>æœ¬ç¯‡æ–‡ç« é€šè¿‡ä¸€äº›å¸¸è§çš„ç™»å½•æˆæƒåœºæ™¯æ¥å±•å¼€æ¥æè¿°ç»†èŠ‚ç‚¹ã€‚</p>
<p>æ•´ç†äº†ã€Œç™»å½•ã€ã€ã€Œæˆæƒã€çš„æ¦‚å¿µã€‚</p>
<p>ç„¶ååˆ†åˆ«é’ˆå¯¹ã€Œç™»å½•ã€ä»‹ç»äº†ä¸€äº›å…³é”®çš„æŠ€æœ¯å®ç°ï¼š</p>
<ol>
<li>é™é»˜ç™»å½•</li>
<li>é™é»˜ç™»å½•å¼‚æ­¥çŠ¶æ€çš„å¤„ç†</li>
<li>è‡ªå®šä¹‰ç™»å½•æ€è¿‡æœŸçš„å®¹é”™å¤„ç†</li>
<li>å¾®ä¿¡ <code>session_key</code> è¿‡æœŸçš„å®¹é”™å¤„ç†</li>
</ol>
<p>è€Œå¯¹äºã€Œæˆæƒã€ï¼Œä¼šæœ‰è®¾è®¡UIéƒ¨åˆ†çš„é€»è¾‘ï¼Œè¿˜éœ€è¦æ¶‰åŠåˆ°ç»„ä»¶çš„æ‹†åˆ†ï¼š</p>
<ol>
<li>ç»„ä»¶æ‹†åˆ†ä¸è®¾è®¡</li>
<li>æƒé™æ‹¦æˆªçš„å¤„ç†</li>
</ol>
<p>ç„¶åï¼Œæ¢³ç†äº†è¿™å¥—ç™»å½•æˆæƒæ–¹æ¡ˆæ‰€ä¾èµ–çš„åç«¯æ¥å£ï¼Œå’Œç»™å‡ºæœ€ç®€å•çš„å‚è€ƒåè®®ã€‚</p>
<p>æœ€åï¼Œç«™åœ¨ã€Œç§‰ç€æ²‰æ·€ä¸€å¥—é€šç”¨çš„å°ç¨‹åºç™»å½•æ–¹æ¡ˆå’ŒæœåŠ¡ä¸ºç›®æ ‡ã€çš„è§’åº¦ï¼Œæ¢³ç†äº†ä¸€ä¸‹æ¶æ„å±‚é¢ä¸Šçš„åˆ†å±‚ã€‚</p>
<ol>
<li>ä¸šåŠ¡å®šåˆ¶å±‚</li>
<li>ç™»å½•æœåŠ¡å±‚</li>
<li>åº•å±‚å»ºè®¾</li>
</ol>
<h1 id="ä¸ƒ-å‚è€ƒ"><a href="#ä¸ƒ-å‚è€ƒ" class="headerlink" title="ä¸ƒ. å‚è€ƒ"></a>ä¸ƒ. å‚è€ƒ</h1><ol>
<li><a href="https://wendux.github.io/dist/#/doc/flyio/readme" target="_blank" rel="external">fly.js å®˜ç½‘</a></li>
<li><a href="https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/authorize.html" target="_blank" rel="external">å¾®ä¿¡å®˜æ–¹æ–‡æ¡£-æˆæƒ</a></li>
<li><a href="https://developers.weixin.qq.com/miniprogram/dev/framework/open-ability/signature.html" target="_blank" rel="external">å¾®ä¿¡å®˜æ–¹æ–‡æ¡£-æœåŠ¡ç«¯è·å–å¼€æ”¾æ•°æ®</a></li>
<li>å¾®ä¿¡å®˜æ–¹ç¤¾åŒº<ol>
<li><a href="https://developers.weixin.qq.com/community/develop/doc/000424005b89983f337a622c751000?highLine=wx.checkSession" target="_blank" rel="external">å°ç¨‹åºè§£å¯†æ‰‹æœºå·,éš”ä¸€å°æ®µæ—¶é—´å,checksession:ok,ä½†æ˜¯è§£å¯†å¤±è´¥</a></li>
<li><a href="https://developers.weixin.qq.com/community/develop/doc/0008e429bd0c886e10699f59c51000?_at=1602745291452" target="_blank" rel="external">wx.checkSessionæœ‰æ•ˆï¼Œä½†æ˜¯è§£å¯†æ•°æ®å¤±è´¥</a></li>
<li><a href="https://developers.weixin.qq.com/community/develop/doc/000a04ab4546d80d5428ffcee51800?_at=1602745291452" target="_blank" rel="external">checkSessionåˆ¤æ–­session_keyæœªå¤±æ•ˆï¼Œä½†æ˜¯è§£å¯†æ‰‹æœºå·å¤±è´¥</a></li>
</ol>
</li>
</ol>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;ä¸€-å‰è¨€&quot;&gt;&lt;a href=&quot;#ä¸€-å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;ä¸€. å‰è¨€&quot;&gt;&lt;/a&gt;ä¸€. å‰è¨€&lt;/h1&gt;&lt;p&gt;å¯¹äºç™»å½•/æ³¨å†Œçš„è®¾è®¡å¦‚æ­¤ç²¾é›•ç»†ç¢çš„ç›®çš„ï¼Œå½“ç„¶æ˜¯æƒ³è®©è¿™ä¸ªä½œä¸ºåº”ç”¨çš„åŸºç¡€èƒ½åŠ›ï¼Œæœ‰è¶³å¤Ÿçš„å¥å£®æ€§ï¼Œé¿å…å‡ºç°å…¨ç«™æ€§çš„é˜»å¡ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="æ¬ç –ç å†œ" scheme="http://huang-jerryc.com/categories/%E6%90%AC%E7%A0%96%E7%A0%81%E5%86%9C/"/>
    
    
      <category term="ç™»å½• å¾®ä¿¡å°ç¨‹åº" scheme="http://huang-jerryc.com/tags/%E7%99%BB%E5%BD%95-%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/"/>
    
  </entry>
  
  <entry>
    <title>ä¸€ä¸ªå¤±çœ å¤œçš„èƒ¡æ€ä¹±æƒ³</title>
    <link href="http://huang-jerryc.com/2019/08/17/a-thinking-on-insomnia-night/"/>
    <id>http://huang-jerryc.com/2019/08/17/a-thinking-on-insomnia-night/</id>
    <published>2019-08-16T19:25:13.977Z</published>
    <updated>2019-08-16T19:26:22.736Z</updated>
    
    <content type="html"><![CDATA[<p>ç°åœ¨æ˜¯å‡Œæ™¨ 2:06ï¼Œä»Šæ™šå–äº†ä¸¤ç“¶ç§‘ç½—å¨œã€‚<br>ä»¥ä¸ºå–äº†é…’èƒ½å¥½å¥½ç¡ï¼Œç»“æœï¼Œè¿˜æ˜¯å¤±çœ äº†ã€‚</p>
<p>æ˜¯å…´å¥‹ä¹Ÿç½¢ï¼Œæ˜¯ç„¦è™‘ä¹Ÿç½¢ã€‚æ—¢ç„¶æ˜å¤©ä¸ç”¨ä¸Šç­ï¼Œé‚£ä¹ˆå°±è®©è¿™ä¸ªå¤±çœ å¤œæ¥çš„æ›´æ”¾çºµäº›ã€‚</p>
<p>åˆšæ‰èººåœ¨åºŠä¸Šï¼Œç«Ÿç„¶åœ¨æ„æƒ³èµ·è‡ªå·±çš„é€€ä¼‘ç”Ÿæ´»ã€‚<br>å¸Œæœ›è‡ªå·±çš„é€€ä¼‘ç”Ÿæ´»ï¼Œä¼šæ›´æœ‰è¶£äº›ï¼Œåœ¨è¡£é£Ÿä¸Šæ²¡æœ‰åŸºæœ¬çš„æ‹…å¿§ï¼Œèº«ä½“è™½ç„¶æœ‰äº›æ¯›ç—…ï¼Œä½†è¿˜æ˜¯èƒ½å¥åº·çš„æ´»ç€ï¼Œç„¶åå’Œè€ä¼´æŒç»­çš„äºŒäººä¸–ç•Œã€‚æœ‰ä¸€ä¸ªç‹¬ç«‹çš„å­©å­ï¼Œæœ‰ç©ºå¯ä»¥æ¥çœ‹çœ‹æˆ‘ä»¬ã€‚ä»¥åŠæœ‰ä¸€ä¸¤ä¸ªèƒ½æŒç»­ä»¥æ’çš„çˆ±å¥½ã€‚ç„¶åï¼Œè¿˜é¡ºåˆ©çš„å…»æˆäº†ç»ˆèº«å­¦ä¹ çš„ä¹ æƒ¯ï¼Œä½œä¸ºä¸€ä¸ª fasion çš„è€å¤´ã€‚</p>
<p>åŸ¹å…»ä¸ªå•¥å…´è¶£å¥½å‘¢ï¼Ÿå›é¡¾è¿‡å»çš„ä¼—å¤šçˆ±å¥½ï¼Œæ‰¾ä¸€ä¸ªèƒ½æŒç»­å‘å±•çš„ã€‚å°±æ‹¿éŸ³ä¹æ¥è¯´ï¼Œå‡å¦‚æˆ‘èƒ½æŠŠéŸ³ä¹è¿™ä»¶äº‹å­¦æ·±äº†ï¼Œå­¦å¹¿äº†ï¼ŒæŠŠç©å‡ é—¨ä¹å™¨ï¼Œå°±ç®—æ˜¯ä¸ªç³Ÿè€å¤´ï¼Œä¹Ÿèƒ½ææåˆ›ä½œå§ã€‚ç„¶åæœ‰äº›ç§¯è“„ï¼Œç»“åˆç€å¹´è½»æ—¶çš„é˜…å†å’Œæœ‹å‹ï¼Œä¹Ÿèƒ½åšäº›å°ç”Ÿæ„å§ï¼Ÿåˆæˆ–è€…ä¹Ÿèƒ½åšåšæ•™è‚²å§ï¼Ÿ</p>
<p>é¡ºç€æ€è€ƒå¦‚ä½•å»è¿‡ä¸Šå–œæ¬¢çš„é€€ä¼‘ç”Ÿæ´»ï¼Œä¼¼ä¹æœ‰äº†ä¸ªæ›´é•¿è¿œçš„ç›®æ ‡ï¼Œæ—¶é—´è·¨åº¦æ›´å¤§çš„ç›®æ ‡ã€‚</p>
<p>äºæ˜¯ä¹ï¼Œæ‰æ„è¯†åˆ°è¿™å‡ å¹´æ¥ï¼Œåªå‡­å€Ÿç€å¹´å°‘è½»ç‹‚çš„é‚£è‚¡åŠ²åœ¨å¥”è·‘ï¼Œå´æ²¡æœ‰ä¸€ä¸ªå¯ä»¥é•¿è¿œè¿½é€çš„æ„¿æ™¯ã€‚</p>
<p>ä»¥è‡³äºï¼Œåœ¨ç¢°åˆ°äººç”Ÿå¤§äº‹ä¸Šï¼Œå¦‚ç»“å©šã€ä¹°æˆ¿ã€å°å­©è¿™äº›é—®é¢˜ä¸Šï¼Œå´æœ‰äº†ä¸€ç§å´æ­¥æ„Ÿã€‚åœ¨ç¢°åˆ°èŒä¸šå‘å±•ç“¶é¢ˆä¸Šï¼Œä¼šæ»¡æ»¡çš„ç„¦è™‘æ„Ÿã€‚è¿˜å¸¸å¸¸å›å¿†è¿‡å»ï¼Œç•™æ‹è¿‡å»ã€‚</p>
<p>çœ‹è¿‡ä¸€ä¸ªè¯´æ³•ï¼š20 å²å¹´è½»äººå’Œ 50 å²è€äººåšè®¡åˆ’ï¼Œå¹´è½»äººæœ€å¤šåªèƒ½åš 2 å¹´è®¡åˆ’ï¼Œè€äººå´å¯ä»¥åš 5 å¹´ç”šè‡³ 10 å¹´è®¡åˆ’ã€‚å› ä¸º 5 å¹´ï¼Œå¯¹å¹´è½»äººæ¥è¯´æ˜¯ä»–ç”Ÿå‘½çš„ 1/4ï¼Œè€Œå¯¹è€äººæ¥è¯´åªæ˜¯ä»–ç”Ÿå‘½çš„ 1/10ã€‚ å”¯ä¸€å¿§æ¡‘çš„æ˜¯ï¼Œè€äººæ‰€å‰©çš„ç”Ÿå‘½æ—¶é—´ä¸æ•Œå¹´è½»çš„ã€‚</p>
<p>ä»è¿™ä¸ªä¾‹å­æ¥çœ‹ï¼Œæˆ‘è®¤ä¸ºäººç±»å¯¹æ—¶é—´çš„æ„Ÿå—ï¼Œæ˜¯ç›¸å¯¹çš„ï¼Œå¹¶ä¸”æ˜¯å¯å˜åŒ–çš„ã€‚<br>é‚£ä¹ˆå‡å¦‚å¹´è½»äººèƒ½å¤Ÿå»æ¨¡æ‹Ÿæ„Ÿå—è€äººå¯¹æ—¶é—´ç»´åº¦çš„æ„Ÿå—ï¼Œæ˜¯ä¸æ˜¯ä¹Ÿèƒ½åšå‡ºæ›´é•¿è¿œäº›çš„è®¡åˆ’ï¼Ÿç„¶åæ›´åŠ æ·¡å®šï¼Ÿ</p>
<p>å€˜è‹¥æŠŠæ—¶é—´ç»´åº¦æ‹‰é•¿ï¼Œå¦‚æœ 30 å¹´åæ¥çœ‹ä»Šå¤©ï¼Œå´ç¨ç¨æœ‰ä¸€ç§è±è¾¾çš„æ„Ÿè§‰ã€‚è™½ç„¶ç¦»æƒ³æ¸…æ¥šï¼Œæƒ³æ˜ç™½ï¼Œè¿˜æœ‰äº›è·ç¦»ã€‚</p>
<p>è¿™æ ·å›å»çœ‹ï¼Œæ‰€è°“çš„ä¸­å¹´å±æœºï¼Œäº’è”ç½‘ 35 å²å‘½åŠ«ï¼Œåœ¨ä¸€ä¸ªæ›´é•¿è¿œçš„æ—¶é—´è·¨åº¦ä¸­ï¼Œä¹Ÿåªèƒ½æ˜¯ä»¶å°äº‹æƒ…ï¼Œé‚£ä¹ˆä¸€è·¨ï¼Œå°±è¿‡å»äº†ã€‚</p>
<p>é‚£ä¹ˆå¦‚ä½•å›æ¥çœ‹å½“ä¸‹ï¼Ÿ<br>æ¯•ç«Ÿæˆ‘è¿˜æ˜¯ 27 å²çš„å¹´é¾„ï¼Œé‚£å°±åº”è¯¥åœ¨è¿™ä¸ªæ—¶æœŸï¼Œå»å¥½å¥½æ„Ÿå—å±äºè¿™ä¸ªæ—¶æœŸçš„ç”Ÿæ´»ã€‚<br>å¥½å¥½å»æ„Ÿå—èŒåœºï¼ŒæŒç»­æé«˜ä¸ªä½“ä»·å€¼ï¼Œç»™è¿™ä¸ªç¤¾ä¼šè¾“å‡ºè´¡çŒ®ï¼Œä»¥æ¢å–ä¸ªä½“ç”Ÿæ´»æ¡ä»¶ã€‚<br>å¥½å¥½å»æ„Ÿå—ç”Ÿæ´»ï¼Œç»“å©šã€ä¹°æˆ¿ã€ç”Ÿå­ã€èµ¡å…»è€äººï¼Œå»æ„Ÿå—äººç”Ÿè¿™ä¸ªé˜¶æ®µå¿…é¡»ç»å†çš„ç”Ÿæ´»ã€‚<br>è¿˜æœ‰ï¼Œå¥½å¥½çˆ±æƒœèº«ä½“ï¼Œæ¯•ç«Ÿç”Ÿå‘½åªæœ‰ä¸€æ¬¡ã€‚</p>
<p>åœ¨å†å²é•¿æµçš„ç»´åº¦æ¥çœ‹ï¼Œä¸€ä¸ªäººå°±å‡ åå¹´å…‰æ™¯çš„å¯¿å‘½ï¼Œè¯ç”Ÿã€æˆé•¿ã€è¡°è€ï¼Œç„¶åå›å½’è‡ªç„¶ã€‚<br>é‚£ä¹ˆï¼Œè¿™çŸ­çŸ­çš„ç”Ÿå‘½ï¼Œè¯¥æ€ä¹ˆæ¼”ç»ï¼Ÿ<br>ç¬¬ä¸€ï¼Œæ„Ÿè°¢çˆ¶æ¯äº²æŠŠæˆ‘ä»¬å¸¦åˆ°è¿™ä¸ªä¸–ç•Œä¸Šã€‚<br>ç¬¬äºŒï¼Œå»å¥½å¥½æ„Ÿå—ç”Ÿå‘½çš„æ•´ä¸ªå‘¨æœŸã€‚</p>
<p>ç°åœ¨æ˜¯å‡Œæ™¨ 3:16ï¼Œç¥æ™šå®‰ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç°åœ¨æ˜¯å‡Œæ™¨ 2:06ï¼Œä»Šæ™šå–äº†ä¸¤ç“¶ç§‘ç½—å¨œã€‚&lt;br&gt;ä»¥ä¸ºå–äº†é…’èƒ½å¥½å¥½ç¡ï¼Œç»“æœï¼Œè¿˜æ˜¯å¤±çœ äº†ã€‚&lt;/p&gt;
&lt;p&gt;æ˜¯å…´å¥‹ä¹Ÿç½¢ï¼Œæ˜¯ç„¦è™‘ä¹Ÿç½¢ã€‚æ—¢ç„¶æ˜å¤©ä¸ç”¨ä¸Šç­ï¼Œé‚£ä¹ˆå°±è®©è¿™ä¸ªå¤±çœ å¤œæ¥çš„æ›´æ”¾çºµäº›ã€‚&lt;/p&gt;
&lt;p&gt;åˆšæ‰èººåœ¨åºŠä¸Šï¼Œç«Ÿç„¶åœ¨æ„æƒ³èµ·è‡ªå·±çš„é€€ä¼‘ç”Ÿæ´»ã€‚&lt;br&gt;å¸Œæœ›è‡ªå·±çš„é€€ä¼‘ç”Ÿæ´»ï¼Œä¼šæ›´æœ‰è¶£äº›
    
    </summary>
    
      <category term="ä¸‰çœå¾èº«" scheme="http://huang-jerryc.com/categories/%E4%B8%89%E7%9C%81%E5%90%BE%E8%BA%AB/"/>
    
    
  </entry>
  
  <entry>
    <title>å…³äº OKR çš„ä¸€äº›æ–¹æ³•è®º</title>
    <link href="http://huang-jerryc.com/2019/07/06/about-okr/"/>
    <id>http://huang-jerryc.com/2019/07/06/about-okr/</id>
    <published>2019-07-06T14:53:00.000Z</published>
    <updated>2019-07-06T15:10:30.994Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>OKR æ˜¯ç”±å‰ Intel CEOï¼Œ<a href="https://www.wikiwand.com/zh-hk/%E5%AE%89%E8%BF%AA%C2%B7%E8%91%9B%E6%B4%9B%E5%A4%AB" target="_blank" rel="external">å®‰è¿ªÂ·è‘›æ´›å¤«</a> æ„å»ºçš„åŸºæœ¬æ¡†æ¶ã€‚</p>
<p>å…¨ç§°æ˜¯ï¼šã€ŒObjective - Key Resultã€ï¼Œæ—¢å¼ºè°ƒã€Œç›®æ ‡ã€ä¸è¡¡é‡ç›®æ ‡çš„ã€Œå…³é”®ç»“æœã€</p>
<p>å®ƒæ˜¯ä¸€å¥—ç®¡ç†ç›®æ ‡ï¼Œè®©ç›®æ ‡èƒ½è½åœ°çš„å·¥å…·ã€‚<br>å®ƒåœ¨ç¡…è°·ç§‘æŠ€å…¬å¸ä¸­å¹¿ä¸ºäººçŸ¥ï¼Œå¹¶è¢«ä¸–ç•Œå„åœ°çš„è®¸å¤šç»„ç»‡é‡‡ç”¨ã€‚<br>å®ƒå¯ä»¥åº”ç”¨åœ¨ç»„ç»‡ä¸­ï¼Œä¹Ÿå¯ä»¥åº”ç”¨åœ¨ä¸ªäººçš„ç”Ÿæ´»ä¸­ï¼Œå°±åƒä¸€ç§æ€è€ƒçš„æ¨¡å¼ã€‚</p>
<p>è¿‡å»ä¸¤å¹´å¤šçš„ OKR å®è·µï¼Œæœ‰ä¸€äº›ä½“ä¼šã€‚<br>ä½œä¸ºä¸€ä¸ªç¨‹åºå‘˜ï¼Œä¼šè‡ªç„¶çš„å»å¯»æ‰¾ä¸€ä¸ªå·¥å…·çš„æœ€ä½³å®è·µã€‚</p>
<p>äºæ˜¯ï¼Œæœ‰äº†è¿™ç¯‡æ–‡ç« ã€‚</p>
<h1 id="åŸºæœ¬åŸç†"><a href="#åŸºæœ¬åŸç†" class="headerlink" title="åŸºæœ¬åŸç†"></a>åŸºæœ¬åŸç†</h1><p>OKR åŸç†å¾ˆç®€å•ã€‚</p>
<p>è¦ç”¨å¥½ OKRï¼Œæˆ‘çš„ç†è§£ï¼Œéœ€è¦æŠŠæ¡ä¸‰ä¸ªæ ¸å¿ƒï¼š</p>
<ul>
<li>ç›®æ ‡</li>
<li>å…³é”®ç»“æœ</li>
<li>è¿‡ç¨‹ç®¡ç†</li>
</ul>
<p>å®ƒä»¬åˆ†åˆ«å›ç­”äº†ä¸‰ä¸ªé—®é¢˜ï¼š</p>
<ul>
<li>åº”è¯¥åšä»€ä¹ˆï¼Ÿ</li>
<li>å¦‚ä½•è¡¡é‡åšåˆ°äº†ï¼Ÿ</li>
<li>æ€ä¹ˆè½åœ°ï¼Ÿ</li>
</ul>
<p>ç„¶åï¼Œæ€è€ƒ OKRï¼Œæˆ‘è®¤ä¸ºè¿˜éœ€è¦ cover åˆ°ä¸¤ç‚¹ï¼š</p>
<ul>
<li>çœ‹å¾—åˆ°çš„ç»“æœ</li>
<li>è¯´å¾—å‡ºçš„ä»·å€¼</li>
</ul>
<p><strong>å…ˆæŠ›ä¸€ä¸ªä¸å¥½çš„ä¾‹å­</strong></p>
<p>æ¥è‡ªäºæˆ‘æ›¾ç»å®šè¿‡çš„ä¸€ä¸ª OKRï¼š</p>
<blockquote>
<p>O: æŒç»­å­¦ä¹ ï¼Œæé«˜è‡ªèº«æˆ˜æ–—åŠ›</p>
<ul>
<li>KR1: CSS3 å­¦ä¹ ï¼Œé˜…è¯»ã€ŠCSSæ­ç§˜ã€‹äº§å‡ºé˜…è¯»ç¬”è®°ã€‚</li>
<li>KR2: æé«˜è‹±æ–‡é˜…è¯»èƒ½åŠ›ï¼Œé˜…è¯»ã€ŠSecurity Your NodeJS Applicationã€‹ï¼Œäº§å‡ºä¸€ç¯‡è¯‘æ–‡ã€‚</li>
<li>KR3: å¯¹ Eggjs æˆ– Vue2 æ¡†æ¶çš„æºç è¿›è¡Œè§£è¯»ï¼Œäº§å‡ºä¸€ç¯‡æºç è§£æã€‚</li>
</ul>
</blockquote>
<p>æˆ‘æƒ³å…ˆæŒ‰é¡ºåºæ¥è®²è®²ã€Œç›®æ ‡ã€ã€ã€Œå…³é”®ç»“æœã€ã€ã€Œè¿‡ç¨‹ç®¡ç†ã€ã€‚<br>ç„¶åï¼Œå†å›è¿‡å¤´æ¥ï¼Œçœ‹çœ‹è¿™ä¸ªä¾‹å­ä¸ºå•¥ç³Ÿç³•ï¼Œå¯ä»¥æ€æ ·ä¿®æ”¹ã€‚</p>
<h3 id="ç›®æ ‡-Objective"><a href="#ç›®æ ‡-Objective" class="headerlink" title="ç›®æ ‡ Objective"></a>ç›®æ ‡ Objective</h3><blockquote>
<p>æ¬²æœ›è®©æˆ‘ä»¬èµ·èˆªï¼Œä½†åªæœ‰ä¸“æ³¨ã€è§„åˆ’å’Œå­¦ä¹ æ‰èƒ½åˆ°è¾¾æˆåŠŸçš„å½¼å²¸</p>
</blockquote>
<h5 id="ç»„ç»‡çš„è¯ç”Ÿ"><a href="#ç»„ç»‡çš„è¯ç”Ÿ" class="headerlink" title="ç»„ç»‡çš„è¯ç”Ÿ"></a>ç»„ç»‡çš„è¯ç”Ÿ</h5><p>å›åˆ°æœ€åˆçš„æ—¶å€™ï¼Œä¸€ä¸ªç»„ç»‡çš„è¯ç”Ÿï¼Œç»å¤§å¤šæ•°æƒ…å†µæ˜¯ç”±äºä¸€ä¸¤ä¸ªäººçš„æƒ³æ³•ï¼Œç„¶åä»¥æ­¤ä¸ºä¸­å¿ƒï¼Œå¼€å§‹èšæ‹¢æ›´å¤šæœ‰å…±åŒç›®æ ‡çš„äººåŠ å…¥è¿›æ¥ã€‚</p>
<p>1976å¹´ï¼Œä¹”å¸ƒæ–¯æˆåŠŸè¯´æœæ²ƒèŒ²å°¼å…‹çµ„è£æœºå™¨ä¹‹åå†æ‹¿å»æ¨é”€ï¼Œä»–ä»¬çš„å¦ä¸€ä½æœ‹å‹éŸ¦æ©éšååŠ å…¥ï¼Œä¸‰äººåœ¨1976å¹´4æœˆ1æ—¥æˆç«‹è‹¹æœç”µè„‘å…¬å¸ã€‚æœ€åˆï¼ŒApple ä»…ä»…æ˜¯åœ¨å–ç»„è£…ç”µè„‘ã€‚</p>
<p>1996å¹´ï¼Œä½©å¥‡å’Œå¸ƒæ—åœ¨å­¦æ ¡å¼€å§‹ä¸€é¡¹å…³äºæœç´¢çš„ç ”ç©¶é¡¹ç›®ï¼Œå¼€å‘å‡ºäº†æœç´¢å¼•æ“ PageRankï¼Œåç»­æ”¹å Googleã€‚æœ€åˆï¼ŒGoogle ä»…ä»…æ˜¯ä¸€ä¸ªæœç´¢å¼•æ“ã€‚</p>
<h5 id="ç»„ç»‡çš„ä½¿å‘½"><a href="#ç»„ç»‡çš„ä½¿å‘½" class="headerlink" title="ç»„ç»‡çš„ä½¿å‘½"></a>ç»„ç»‡çš„ä½¿å‘½</h5><p>éšç€ç»„ç»‡å‘å±•ï¼Œäººå‘˜å£®å¤§ï¼Œè¿™ä¸ªèƒ½èšæ‹¢äººçš„ç›®æ ‡ï¼Œå¿…é¡»è¦çœ‹å¾—è¿œã€‚ç„¶åè¿™ä¸ªç›®æ ‡æå‡åˆ°ç”¨å¦ä¸€ä¸ªè¯æ¥å½¢å®¹ â€”ã€Œä½¿å‘½ã€ã€‚</p>
<p>Apple çš„ä½¿å‘½ï¼šã€Œè—‰æ¨å¹¿å…¬å¹³çš„èµ„æ–™ä½¿ç”¨æƒ¯ä¾‹ï¼Œå»ºç«‹ç”¨æˆ·å¯¹äº’è”ç½‘ä¹‹ä¿¡ä»»å’Œä¿¡å¿ƒã€<br>Google çš„ä½¿å‘½ï¼šã€Œæ•´åˆå…¨çƒä¿¡æ¯ï¼Œä½¿äººäººçš†å¯è®¿é—®å’Œæ”¶ç›Šã€<br>é˜¿é‡Œå·´å·´çš„ä½¿å‘½ï¼šã€Œè®©å¤©ä¸‹æ²¡æœ‰éš¾åšçš„ç”Ÿæ„ã€<br>æœ‰èµçš„ä½¿å‘½ï¼šã€Œå¸®åŠ©æ¯ä¸€ä½é‡è§†äº§å“å’ŒæœåŠ¡çš„å•†å®¶æˆåŠŸã€<br>ä»¥åŠæœ€è¿‘æˆ‘ä»¬å›¢é˜Ÿçš„å‰ç«¯æŠ€æœ¯å§”å‘˜çš„ä½¿å‘½ï¼šã€Œä»¥æè‡´çš„æŠ€æœ¯é«˜æ•ˆæ”¯æ’‘ä¸šåŠ¡ã€</p>
<p>ä½¿å‘½æè¿°ä¸€èˆ¬éƒ½å¾ˆç®€æ´ï¼Œå¹¶ä¸”å®¹æ˜“è®°å¿†ï¼Œåƒä¸€å¥å¹¿å‘Šè¯ï¼Œèƒ½æ·±æ·±çš„åˆ»åœ¨è„‘æµ·é‡Œã€‚<br>åœ¨å·¥ä½œä¸­é‡åˆ°é—®é¢˜çš„æ—¶å€™ï¼Œè¿™ä¸ªä½¿å‘½å°±ä¼šä¸€ä¸‹å­ä»è„‘æµ·é‡Œè¹¦å‡ºæ¥æŒ‡å¼•ä½ æ‰¾åˆ°ç­”æ¡ˆã€‚</p>
<p>å…¶å®åœ¨æŸä¸ªå¸‚åœºé—²é€›éƒ½æœ‰å¯èƒ½è®©ä½ æ„è¯†åˆ°è¿™ä¸ªå¸‚åœºæœ‰æŸä¸ªé—®é¢˜éœ€è¦è§£å†³ï¼Œè€Œå¸®å¸‚åœºè§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå°±æ˜¯ä¸€ä¸ªä½¿å‘½ã€‚</p>
<h5 id="é˜¶æ®µæ€§çš„ç›®æ ‡"><a href="#é˜¶æ®µæ€§çš„ç›®æ ‡" class="headerlink" title="é˜¶æ®µæ€§çš„ç›®æ ‡"></a>é˜¶æ®µæ€§çš„ç›®æ ‡</h5><p>ä¸ºäº†ä¸€æ­¥æ­¥çš„è¾¾æˆã€Œä½¿å‘½ã€ï¼Œæˆ‘ä»¬éœ€è¦æœ‰ç›®æ ‡ã€‚ç›¸å¯¹äºä½¿å‘½ï¼Œå®ƒç²’åº¦æ›´å°ï¼Œä¸”æœ‰æ—¶é—´é™åˆ¶ã€‚</p>
<p>æ‰€ä»¥ï¼Œç›®æ ‡ï¼ˆObjectiveï¼‰åº”è¯¥ï¼š</p>
<ul>
<li>æ˜¯é˜¶æ®µæ€§çš„</li>
<li>æ˜¯æœ‰ä¼˜å…ˆçº§çš„</li>
<li>å®ƒéœ€è¦èƒ½æ˜ç¡®æ–¹å‘ä¸”é¼“èˆäººå¿ƒ</li>
</ul>
<p>ç›®æ ‡ï¼Œæ˜¯ OKR ä¸­æœ€é‡è¦ï¼Œæœ€éœ€è¦æƒ³æ¸…æ¥šï¼Œæœ€é¦–è¦ç¡®å®šçš„ã€‚<br>åœ¨è¿™é‡Œï¼Œéœ€è¦å›ç­”ï¼šä½ æœ‰ä»€ä¹ˆï¼Ÿä½ è¦ä»€ä¹ˆï¼Ÿä½ èƒ½æ”¾å¼ƒä»€ä¹ˆï¼Ÿ</p>
<h5 id="é‡è¦ä¸ç´§æ€¥"><a href="#é‡è¦ä¸ç´§æ€¥" class="headerlink" title="é‡è¦ä¸ç´§æ€¥"></a>é‡è¦ä¸ç´§æ€¥</h5><p>ã€Œé±¼ä¸ç†ŠæŒä¸å¯å¾—å…¼ã€ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æœ‰æ‰€å–èˆï¼Œäº‹æƒ…æ’ä¸ªä¼˜å…ˆçº§ã€‚<br>ã€Œé‡è¦-ç´§æ€¥è±¡é™ã€æ˜¯ä¸€ä¸ªä¸é”™çš„æŒ‡å¯¼å·¥å…·ï¼Œç¬¬ä¸€æ¬¡çœ‹åˆ°å®ƒæ˜¯åœ¨æŸ¯ç»´ã€Šé«˜æ•ˆèƒ½äººå£«çš„7ä¸ªä¹ æƒ¯ã€‹ä¸­çš„ç¬¬ä¸‰ä¸ªä¹ æƒ¯ã€Œè¦äº‹ç¬¬ä¸€ã€ã€‚</p>
<p><img src="https://img.yzcdn.cn/public_files/2019/07/06/e5ce3614f98f98d538944350bd505993.png" alt="é‡è¦-ç´§æ€¥"></p>
<p>ä½†åœ¨å®æ–½çš„è¿‡ç¨‹ä¸­ä¸­å¾ˆæœ‰å¯èƒ½ä¼šé‡åˆ°è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼Œç´§æ€¥ä¸é‡è¦çš„äº‹æƒ…å¾ˆç´§æ€¥ï¼Œæ€»éœ€è¦èŠ±æ—¶é—´å’Œç²¾åŠ›å»å¤„ç†å®ƒã€‚ç„¶åé‡è¦ä¸ç´§æ€¥çš„äº‹æƒ…ï¼Œä¼šå¸¸å¸¸åˆ†é…ä¸åˆ°æ—¶é—´å’Œç²¾åŠ›ã€‚</p>
<p><strong>é‚£ä¹ˆå°±è®©é‡è¦ä¸ç´§æ€¥çš„äº‹æƒ…ä¹Ÿå˜å¾—ç´§æ€¥èµ·æ¥ã€‚</strong></p>
<h5 id="ç›®æ ‡éœ€è¦è‡ªä¸Šè€Œä¸‹çš„å…³è”"><a href="#ç›®æ ‡éœ€è¦è‡ªä¸Šè€Œä¸‹çš„å…³è”" class="headerlink" title="ç›®æ ‡éœ€è¦è‡ªä¸Šè€Œä¸‹çš„å…³è”"></a>ç›®æ ‡éœ€è¦è‡ªä¸Šè€Œä¸‹çš„å…³è”</h5><p>å¦‚æœåŸºç¡€çš„å•†ä¸šé—®é¢˜æ²¡æœ‰è§£å†³ï¼Œä¸è®ºå®ç°å¤šå°‘äº§å“åŠŸèƒ½ï¼Œå›¢é˜Ÿæ•´ä½“çš„ç»©æ•ˆä¸€å®šä¼šå¤§æ‰“æŠ˜æ‰£ã€‚</p>
<p>åœ¨ä¸€ä¸ªç»„ç»‡ä¸­ï¼Œå¦‚æœæ²¡æœ‰å……åˆ†çš„ç†è§£ä¸Šä¸€å±‚çš„ç›®æ ‡ï¼Œå°±å¾ˆå®¹æ˜“è·‘åï¼Œæ²¡æœ‰çœŸæ­£åœ¨åˆ€åˆƒä¸Šä½¿åŠ›ï¼Œé€ æˆæ•ˆç‡ä¸Šçš„æµªè´¹ã€‚</p>
<p>è¾¾åˆ°å……åˆ†çš„ç†è§£ç›®æ ‡ï¼Œæ˜¯æœ‰éš¾åº¦çš„ï¼Œå¯¹äººçš„çœ¼ç•Œã€ç›®æ ‡ç†è§£èƒ½åŠ›æœ‰å¾ˆé«˜çš„è¦æ±‚ã€‚è¿™ä¸ä»…ä»…æ˜¯æ‰§è¡Œè€…è´£ä»»ï¼Œæ›´æ˜¯ç®¡ç†è€…çš„è´£ä»»ã€‚</p>
<h3 id="å…³é”®ç»“æœ-Key-Result"><a href="#å…³é”®ç»“æœ-Key-Result" class="headerlink" title="å…³é”®ç»“æœ Key Result"></a>å…³é”®ç»“æœ Key Result</h3><h5 id="è¡¡é‡ç›®æ ‡æ˜¯å¦è¾¾æˆ"><a href="#è¡¡é‡ç›®æ ‡æ˜¯å¦è¾¾æˆ" class="headerlink" title="è¡¡é‡ç›®æ ‡æ˜¯å¦è¾¾æˆ"></a>è¡¡é‡ç›®æ ‡æ˜¯å¦è¾¾æˆ</h5><p>ç›®æ ‡å®šä¸‹æ¥äº†ï¼Œå¦‚æœä¸å»æ‰§è¡Œå’Œè½åœ°ï¼Œé‚£ä¹ˆå®ƒæ°¸è¿œå°±åªæ˜¯ä¸€ä¸ªç›®æ ‡ã€‚å¦‚ä½•å»è¡¡é‡ç›®æ ‡æ˜¯å¦è¾¾åˆ°äº†ï¼Œå°±æ˜¯ã€Œå…³é”®ç»“æœã€çš„ä»»åŠ¡ã€‚</p>
<p>åœ¨äº’è”ç½‘äº§å“ä¸­ï¼Œé€šå¸¸å¯ä»¥é‡åŒ–çš„æ¡ä»¶æœ‰ï¼šç”¨æˆ·å¢é•¿ã€ç”¨æˆ·æ¿€æ´»ã€æ”¶å…¥å¢é•¿ã€äº§å“æ€§èƒ½ã€äº§å“è´¨é‡ã€‚</p>
<p>ä½œä¸ºæŠ€æœ¯å›¢é˜Ÿï¼Œä¼šæ›´åŠ é›†ä¸­æ³¨æ„åŠ›åœ¨äº§å“æ€§èƒ½å’Œäº§å“è´¨é‡ä¸Šé¢ï¼Œé‚£ä¹ˆå¦‚ä½•å»æ‰¾åˆ°è¿™äº›æ–¹å‘çš„è¡¡é‡æŒ‡æ ‡ï¼Œå°±è¦ä»å®é™…å‡ºå‘äº†ã€‚</p>
<p>æ¯”å¦‚æˆ‘ä»¬å›¢é˜Ÿä¼šç”¨ã€Œè´¨é‡ç³»æ•° = BUGæ•°/ä¼°æ—¶ã€ï¼Œæ¥æ„Ÿå—ä¸€ä¸ªé¡¹ç›®çš„è´¨é‡æƒ…å†µã€‚è™½ç„¶å®ƒä¼šæœ‰äº›æ¼æ´ï¼Œä½†å¦‚æœå»ºç«‹åœ¨äº’ç›¸ä¿¡ä»»çš„åŸºç¡€ä¸Šï¼Œå¯ä»¥æä¾›ä¸€å®šçš„å‚è€ƒä»·å€¼ã€‚</p>
<h5 id="æœ‰äº›æŒ‘æˆ˜æ€§"><a href="#æœ‰äº›æŒ‘æˆ˜æ€§" class="headerlink" title="æœ‰äº›æŒ‘æˆ˜æ€§"></a>æœ‰äº›æŒ‘æˆ˜æ€§</h5><blockquote>
<p>å½“è¾¾åˆ°æˆç»“æœçš„æ—¶å€™ï¼Œæˆ‘ä»¬åº”è¯¥æ˜¯æ¬¢å‘¼é›€è·ƒèˆ¬çš„å…´å¥‹ï¼Œè€Œä¸æ˜¯ç†æ‰€åº”å½“çš„æ·¡å®šã€‚</p>
</blockquote>
<p>å®šä¸‹ä¸€ä¸ªå…³é”®ç»“æœä¹‹åï¼Œé—®ä¸€ä¸‹è‡ªå·±ï¼Œæœ‰å¤šå°‘ä¿¡å¿ƒå¯ä»¥å®Œæˆã€‚å¦‚æœä¿¡å¿ƒçˆ†æ£šï¼Œå°±æŠŠç›®æ ‡å®šé«˜äº›ã€‚å¦‚æœä¿¡å¿ƒä¸è¶³ï¼Œå°±æŠŠç›®æ ‡è°ƒä½äº›ã€‚å› ä¸º OKR çš„æ„ä¹‰ä¸åœ¨äºå®Œæˆç›®æ ‡ï¼Œæ›´é‡è¦çš„æ˜¯å®ƒèƒ½æŒ–æ˜å›¢é˜Ÿä»¥åŠä¸ªäººçš„æ½œåŠ›ã€‚</p>
<p>å¦‚æœè§‰å¾—æœ‰å¿…è¦çš„è¯ï¼Œæˆ‘ä»¬å¯ä»¥å»ºç«‹ä¸€ä¸ªã€Œä¿¡å¿ƒæŒ‡æ•°ã€ï¼Œç”¨æ¥å¸®åŠ©ç¡®å®šç»“æœæœ‰è¶³å¤Ÿçš„æŒ‘æˆ˜æ€§è€Œä¸ä¼šè®©äººå¤±å»ä¿¡å¿ƒã€‚è¿™ä¸ªæŒ‡æ•°çš„å¼€å§‹å€¼æœ€å¥½æ˜¯ 50%ï¼Œç„¶åé€šè¿‡è¿‡ç¨‹ç®¡ç†æ¥åŠ¨æ€å˜æ›´å’Œè¿½è¸ªã€‚</p>
<p>æ¯”å¦‚å»å¹´æˆ‘è´Ÿè´£çš„ä¸€ä¸ªã€Œä¼˜åŒ–å¾®ä¿¡å°ç¨‹åºåŠ è½½æ€§èƒ½ã€é¡¹ç›®ä¸­çš„å…³é”®ç»“æœï¼š</p>
<ul>
<li>é¦–å±åŠ è½½æ—¶é—´ 3s å†…</li>
</ul>
<p>æœªä¼˜åŒ–çš„åŠ è½½æ—¶é—´æ˜¯ 6s+ï¼Œå›é¡¾å½“æ—¶å¯¹ç›®æ ‡çš„ä¿¡å¿ƒæŒ‡æ•°çš„è¯ï¼Œå¤§æ¦‚æ˜¯ 20%ã€‚è™½ç„¶æœ€åå› ä¸ºéƒ¨åˆ†ä¸å¯æ§å› ç´ æ²¡æœ‰è¾¾åˆ°è¿™ä¸ªç›®æ ‡ï¼Œåªèƒ½ç»´æŒåœ¨ 3s-4s ä¹‹é—´ã€‚ä½†æ˜¯è¿™ä¸ªè¿‡ç¨‹ä¸­èƒ½è®©äººè´¹å°½è„‘æ±çš„æ‰¾åˆ°å„ç§æ–¹æ³•ï¼Œå¤§å¹…çš„æå‡äº†é™¤é¦–å±åŠ è½½ä»¥å¤–å…¶ä»–æ–¹é¢çš„åŠ è½½ä½“éªŒï¼Œè¿™ä¹Ÿæ˜¯é¢å¤–çš„æ”¶è·ã€‚</p>
<p>ä½œä¸ºç®¡ç†è€…ï¼Œä½ è¦æ¸…æ¥šçš„çŸ¥é“å“ªäº›äººæ¨ä¸€æ¨ä¼šæœ‰æ›´é«˜çš„äº§å‡ºï¼Œå“ªäº›äººå®é™…æ‰§è¡Œæƒ…å†µä¼šå‡ºç°é—®é¢˜ï¼Œè¦èƒ½çœ‹å¾—åˆ°çœ‹å¾—æ‡‚ç›®å‰ç»„ç»‡çš„ç›®æ ‡å’Œè¿›åº¦ï¼Œå¹¶ä¸æˆå‘˜è¿›è¡ŒåŒæ­¥ã€‚</p>
<h3 id="è¿‡ç¨‹ç®¡ç†"><a href="#è¿‡ç¨‹ç®¡ç†" class="headerlink" title="è¿‡ç¨‹ç®¡ç†"></a>è¿‡ç¨‹ç®¡ç†</h3><p>OKR å®šä¸‹æ¥äº†ï¼Œåœ¨æœŸé™å†…ï¼Œå°±è¦å¥”ç€ç›®æ ‡åŠªåŠ›å¥‹è¿›ã€‚å°½ç®¡ä¸­é€”å‘ç°é—®é¢˜ï¼Œä¹Ÿå°½é‡ä¸è¦åœ¨ä¸­é€”æ›´æ”¹ OKRï¼Œè®©æˆ‘ä»¬å°½åŠ›è·‘å®Œè®¡åˆ’çš„é˜¶æ®µå†å›æ¥æ€»ç»“ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠæ—¶é—´ç»´åº¦åˆ‡å°ï¼Œæ¯”å¦‚æŠŠå¹´åº¦åˆ‡åˆ†ä¸ºåŠå¹´åº¦ï¼ŒæŠŠåŠå¹´åº¦åˆ‡åˆ†ä¸ºå­£åº¦ã€‚</p>
<p>å¹¶ä¸”ï¼Œç›®æ ‡å®šä¸‹æ¥ä¹‹åï¼Œè¦ç»å¸¸å®šæœŸå…±åŒå›é¡¾ï¼Œå…±åŒçœ‹è§ã€‚è€Œä¸æ˜¯å®šä¸‹æ¥äº†ï¼Œå°±æ”¾åœ¨é‚£é‡Œï¼Œå¦åˆ™è¿‡ç¨‹ä¸­å›¢é˜Ÿå‘ç”Ÿäº†é—®é¢˜ï¼Œæˆå‘˜é‡åˆ°äº†å›°éš¾ï¼Œå¾ˆå¤§å¯èƒ½ä¼šä¸è¢«çœ‹åˆ°ã€‚</p>
<p>æ¯”è¾ƒå¥½çš„å½¢å¼æ˜¯æ¯å‘¨éƒ½ä¸€èµ·åä¸‹æ¥çœ‹çœ‹ï¼Œæ¯ä¸ªäººåˆ†äº«ä¸€ä¸‹æˆæœï¼Œæˆ–è€…è¯´è¯´é‡åˆ°çš„å›°éš¾ï¼Œçœ‹èƒ½ä¸èƒ½å¾—åˆ°å…¶ä»–äººçš„å¸®åŠ©ã€‚è¿™ä¸ªè¿‡ç¨‹ï¼Œèƒ½åŠæ—¶çš„çœ‹åˆ°é—®é¢˜ï¼Œä¹Ÿèƒ½è®©æˆå‘˜å¯¹ç›®æ ‡æœ‰æ›´å¼ºçš„å‚ä¸æ„Ÿã€‚</p>
<p>é‚£ä¹ˆï¼ŒOKRåº”è¯¥ä»¥ä»€ä¹ˆæ–¹å¼æ¥å‘ˆç°ï¼Ÿã€ŠOKRå·¥ä½œæ³•ã€‹ä¸€ä¹¦ä¸­æä¾›äº†ä¸€ç§å‚è€ƒï¼šã€Œå››è±¡é™å‘ˆç°å½¢å¼ã€</p>
<p><img src="https://img.yzcdn.cn/public_files/2019/07/06/989bdd617bc44bab7dcfdd18120ac8a8.jpeg" alt="å››è±¡é™å‘ˆç°"></p>
<ul>
<li>ç¬¬ä¸€è±¡é™ï¼šæœ¬å‘¨3-4ä»¶æœ€é‡è¦çš„äº‹æƒ…ï¼Œå¹¶ä¸”è¿›è¡Œä¼˜å…ˆçº§çš„æ’åº</li>
<li>ç¬¬äºŒè±¡é™ï¼šæŠŠOKRå†…å®¹ç½—åˆ—å‡ºæ¥ï¼Œå…³æ³¨å’Œæ›´æ–°æ¯ä¸€é¡¹KRçš„ä¿¡å¿ƒæŒ‡æ•°</li>
<li>ç¬¬ä¸‰è±¡é™ï¼šæœªæ¥ä¸­é•¿æ®µæ—¶é—´ä¸­çš„è®¡åˆ’ï¼Œèƒ½è®©æˆ‘ä»¬ç¨å¾®çœ‹è¿œä¸€äº›ã€‚</li>
<li>ç¬¬å››è±¡é™ï¼šå…³æ³¨é‚£äº›å½±å“ç›®æ ‡çš„å…³é”®å› ç´ ä¼šä¸ä¼šæ‰é“¾å­ï¼Œä¾‹å¦‚å›¢é˜ŸçŠ¶æ€ï¼Œç³»ç»ŸçŠ¶æ€ç­‰ã€‚ä¹Ÿå¯ä»¥ç”¨çº¢è“é»„é¢œè‰²è¡¨ç¤ºå‡ºæ¥ã€‚</li>
</ul>
<h1 id="å›è¿‡å¤´çœ‹çœ‹é‚£ä¸ªç³Ÿç³•çš„ä¾‹å­"><a href="#å›è¿‡å¤´çœ‹çœ‹é‚£ä¸ªç³Ÿç³•çš„ä¾‹å­" class="headerlink" title="å›è¿‡å¤´çœ‹çœ‹é‚£ä¸ªç³Ÿç³•çš„ä¾‹å­"></a>å›è¿‡å¤´çœ‹çœ‹é‚£ä¸ªç³Ÿç³•çš„ä¾‹å­</h1><p>ç³Ÿç³•çš„ä¾‹å­ï¼š</p>
<blockquote>
<p>O: æŒç»­å­¦ä¹ ï¼Œæé«˜è‡ªèº«æˆ˜æ–—åŠ›</p>
<ul>
<li>KR1:CSS3 å­¦ä¹ ï¼Œé˜…è¯»ã€ŠCSSæ­ç§˜ã€‹ äº§å‡ºé˜…è¯»ç¬”è®°ã€‚</li>
<li>KR2:æé«˜è‹±æ–‡é˜…è¯»èƒ½åŠ›ï¼Œé˜…è¯»ã€ŠSecurity Your NodeJS Applicationã€‹ï¼Œäº§å‡ºä¸€ç¯‡è¯‘æ–‡ã€‚</li>
<li>KR3: Vue2 æ¡†æ¶çš„æºç è¿›è¡Œè§£è¯»ï¼Œäº§å‡ºä¸€ç¯‡æºç è§£æã€‚</li>
</ul>
</blockquote>
<p>è¿™ä¸ªä¾‹å­çš„èƒŒæ™¯æ˜¯æˆ‘ 2017 å¹´ 4 æœˆä»½åŠ å…¥åˆ°æœ‰èµï¼Œå½“æ—¶å®šçš„è¯•ç”¨æœŸå†…çš„å…¶ä¸­ä¸€ä¸ªç›®æ ‡ã€‚é‚£æ—¶æ˜¯æˆ‘ç¬¬ä¸€æ¬¡è®¤è¯†å’Œä½¿ç”¨ OKRï¼Œåªæ˜¯å•çº¯çš„æŠŠè‡ªèº«çš„æŠ€èƒ½æå‡è®¡åˆ’ç»™ç½—åˆ—äº†å‡ºæ¥ï¼Œçœ‹èµ·æ¥æ›´åƒæ˜¯ä¸€ä¸ª Todo List</p>
<p>ç°åœ¨å›è¿‡å¤´æ¥çœ‹è¿™ä¸€ä»½ OKRï¼Œæœ‰ä¸å°‘é—®é¢˜ï¼š</p>
<ol>
<li>ç›®æ ‡æ²¡æœ‰æè¿°å‡ºæ¥ä»·å€¼ï¼Œæå‡äº†è‡ªèº«æˆ˜æ–—åŠ›ï¼Œç„¶åå‘¢ï¼Ÿå¹¶æ²¡æœ‰è‡ªä¸Šè€Œä¸‹çš„å…³è”å›¢é˜Ÿå’Œç»„ç»‡çš„ç›®æ ‡ã€‚æ‰€ä»¥ä»ç›®æ ‡ä¸Šï¼Œå°±å·²ç»èµ°åäº†ã€‚</li>
<li>å‡è®¾ç›®æ ‡æ­£ç¡®ï¼ŒKR ä¹Ÿæ²¡æœ‰èµ·åˆ°èƒ½è¡¡é‡ç›®æ ‡æ˜¯å¦è¾¾æˆçš„ä½œç”¨ã€‚ä¾‹å¦‚ KR1 å®Œæˆäº†ï¼Œå¯¹ç›®æ ‡çš„æ¨è¿›ï¼Œå¹¶æ²¡æœ‰è¯´æœåŠ›ã€‚</li>
<li>æœ€åæŠŠ OKR ç”¨æˆäº† Todo Listã€‚</li>
</ol>
<p>é‚£ä¹ˆæˆ‘ä»¬ä»ç›®æ ‡å¼€å§‹åˆ†æï¼Œå½“æ—¶ä½œä¸ºä¸€ä¸ªæ–°äººåŠ å…¥åˆ°ä¸€ä¸ªæ–°çš„å›¢é˜Ÿï¼Œå¯¹å›¢é˜Ÿçš„æŠ€æœ¯æ ˆå’Œé¡¹ç›®éƒ½å¾ˆé™Œç”Ÿï¼Œéœ€è¦å¡«è¡¥éƒ¨åˆ†ç©ºç™½ï¼Œå¿«é€Ÿä¸Šæ‰‹ã€‚æ‰€ä»¥æå‡è‡ªèº«å®åŠ›çš„åº•å±‚è¯‰æ±‚æ˜¯ï¼šå¿«é€Ÿä¸Šæ‰‹ï¼Œèƒœä»»å¼€å‘å·¥ä½œã€‚</p>
<p>ç„¶åæ€ä¹ˆè¡¡é‡ç›®çš„è¾¾åˆ°äº†å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥é€šè¿‡é¡¹ç›®è´¨é‡ç›´æ¥è¡¡é‡ï¼Œé€šè¿‡é¡¹ç›®çš„ç†Ÿæ‚‰ç¨‹åº¦æ¥é—´æ¥è¡¡é‡ã€‚</p>
<p>ä¿®æ­£åï¼š</p>
<blockquote>
<p>O: å¿«é€Ÿä¸Šæ‰‹ï¼Œä»¥ä¸“ä¸šçš„å§¿æ€èƒœä»»å¼€å‘å·¥ä½œã€‚</p>
<ul>
<li>KR1: è´¨é‡ç³»æ•°å¹³å‡åœ¨ 0.3 ä»¥å†…ã€‚ï¼ˆè´¨é‡ç³»æ•° = BUGæ•°/ä¼°æ—¶ï¼‰</li>
<li>KR2: ä»£ç è¯„å®¡è¯„åˆ†å¹³å‡ 3.5 ä»¥ä¸Šã€‚ï¼ˆæˆ‘ä»¬æœ‰ Code Review æœºåˆ¶ï¼Œå¹¶ä¸”æœ‰è¯„åˆ†ç¯èŠ‚ï¼‰</li>
<li>KR3: æ‰€å‚ä¸é¡¹ç›®è¯„åˆ†åœ¨ 4 ä»¥ä¸Šã€‚ï¼ˆé¡¹ç›®ä¹Ÿæœ‰è¯„åˆ†ç¯èŠ‚ï¼‰</li>
<li>KR4: è¿›è¡Œä¸¤æ¬¡çš„é¡¹ç›®åˆ†äº«ã€‚</li>
</ul>
</blockquote>
<p>é‚£ä¹ˆå¦‚æœè¾¾åˆ°è¿™äº›å…³é”®ç»“æœï¼Œè¦é€šè¿‡å­¦ä¹ æ¡†æ¶ï¼Œè¿˜æ˜¯ç ”ç©¶é¡¹ç›®ï¼Œè¿˜æ˜¯ç†Ÿæ‚‰ä¸šåŠ¡ï¼Œé‚£å°±æ˜¯æ ¹æ®å®é™…è¿åˆƒè€Œè§£çš„äº‹æƒ…äº†ã€‚</p>
<h1 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h1><blockquote>
<p>å‡¡äº‹é¢„åˆ™ç«‹ï¼Œä¸é¢„åˆ™åºŸ â€”â€”ã€Šç¤¼è®°Â·ä¸­åº¸ã€‹</p>
</blockquote>
<p>æœ€åè¦æ³¨æ„çš„æ˜¯ï¼ŒOKR åªæ˜¯ä¸€ä¸ªå·¥å…·ï¼Œå½“ä½ æœ‰ä¸€ä¸ªç›®æ ‡ï¼Œå®ƒä¼šç»™ä½ ä¸€ç§è½å®ç›®æ ‡çš„æ–¹æ³•è®ºã€‚è€Œå¦‚æœä¸€å¼€å§‹ç›®æ ‡æ²¡æœ‰æƒ³æ¸…æ¥šï¼Œæƒ³æ˜ç™½ï¼Œé‚£å°±å¾ˆå®¹æ˜“åœ¨é”™çš„è·¯ä¸Šè¶Šèµ°è¶Šè¿œã€‚</p>
<p>æ¯ä¸ªå›¢é˜Ÿéƒ½ä¼šæœ‰ä¸åŒçš„é£æ ¼ï¼Œå’Œä¸åŒçš„å®é™…æƒ…å†µã€‚ç†è§£æ–¹æ³•å’Œå·¥å…·çš„åŸç†ï¼Œæ˜ç™½è¿™ä¹ˆåšæ˜¯ä¸ºäº†è§£å†³ä»€ä¹ˆé—®é¢˜ï¼Œç„¶åå†è°ƒæ•´å®šåˆ¶çœŸæ­£é€‚åˆæ­¤æ—¶æ­¤åˆ»çš„å›¢é˜Ÿï¼Œæ‰æ˜¯æœ€å¥½çš„æ–¹æ³•ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;OKR æ˜¯ç”±å‰ Intel CEOï¼Œ&lt;a href=&quot;https://www.wikiwand.com/zh-hk/%E5%AE%89%E8
    
    </summary>
    
      <category term="ä¸‰çœå¾èº«" scheme="http://huang-jerryc.com/categories/%E4%B8%89%E7%9C%81%E5%90%BE%E8%BA%AB/"/>
    
    
  </entry>
  
  <entry>
    <title>BeautyWe.js ä¸€å¥—ä¸“æ³¨äºå¾®ä¿¡å°ç¨‹åºçš„å¼€å‘èŒƒå¼</title>
    <link href="http://huang-jerryc.com/2019/06/11/beautywe-intro/"/>
    <id>http://huang-jerryc.com/2019/06/11/beautywe-intro/</id>
    <published>2019-06-11T06:22:25.000Z</published>
    <updated>2019-07-09T07:38:18.010Z</updated>
    
    <content type="html"><![CDATA[<p><img src="https://raw.githubusercontent.com/beautywe/docs/master/docs/assets/images/logo-V4.png" alt></p>
<blockquote>
<p>å®˜ç½‘ï¼š<a href="http://beautywejs.com" target="_blank" rel="external">beautywejs.com</a><br>Repo: <a href="https://github.com/beautywe/beautywe" target="_blank" rel="external">beautywe</a></p>
</blockquote>
<h1 id="ä¸€ä¸ªç®€å•çš„ä»‹ç»"><a href="#ä¸€ä¸ªç®€å•çš„ä»‹ç»" class="headerlink" title="ä¸€ä¸ªç®€å•çš„ä»‹ç»"></a>ä¸€ä¸ªç®€å•çš„ä»‹ç»</h1><p><strong>BeautyWe.js æ˜¯ä»€ä¹ˆï¼Ÿ</strong></p>
<p>å®ƒæ˜¯ä¸€å¥—ä¸“æ³¨äºå¾®ä¿¡å°ç¨‹åºçš„ä¼ä¸šçº§å¼€å‘èŒƒå¼ï¼Œå®ƒçš„æ„¿æ™¯æ˜¯ï¼š</p>
<blockquote>
<p>è®©ä¼ä¸šçº§çš„å¾®ä¿¡å°ç¨‹åºé¡¹ç›®ä¸­çš„ä»£ç ï¼Œæ›´åŠ ç®€å•ã€æ¼‚äº®ã€‚</p>
</blockquote>
<p><strong>ä¸ºä»€ä¹ˆè¦è¿™æ ·å‘½åå‘¢ï¼Ÿ</strong></p>
<blockquote>
<p>Write <strong>beautiful</strong> code for <strong>we</strong>chat mini program by the <strong>beautiful</strong> <strong>we</strong>!</p>
</blockquote>
<p>ã€ŒWeã€ æ—¢æ˜¯æˆ‘ä»¬çš„ <strong>We</strong>ï¼Œä¹Ÿæ˜¯å¾®ä¿¡çš„ <strong>We</strong>ï¼ŒBoth beautifulï¼</p>
<p><strong>é‚£ä¹ˆå®ƒæœ‰ä»€ä¹ˆå–ç‚¹å‘¢ï¼Ÿ</strong></p>
<ol>
<li>ä¸“æ³¨äºå¾®ä¿¡å°ç¨‹åºç¯å¢ƒï¼Œå†™åŸæ±åŸå‘³çš„å¾®ä¿¡å°ç¨‹åºä»£ç ã€‚</li>
<li>ç”±äºåªä¸“æ³¨äºå¾®ä¿¡å°ç¨‹åºï¼Œå®ƒçš„æºç ä¹Ÿå¾ˆç®€å•ã€‚</li>
<li>æ’ä»¶åŒ–çš„ç¼–ç¨‹æ–¹å¼ï¼Œè®©å¤æ‚é€»è¾‘æ›´å®¹æ˜“å°è£…ã€‚</li>
<li>å†åŠ ä¸Šä¸€äº›é…å¥—è®¾æ–½ï¼š<ol>
<li>ä¸€äº›å®˜æ–¹æ’ä»¶ã€‚</li>
<li>ä¸€å¥—å¼€ç®±å³ç”¨ï¼ŒåŒ…å«äº†å·¥ç¨‹åŒ–ã€é¡¹ç›®è§„èŒƒä»¥åŠå¾®ä¿¡å°ç¨‹åºç¯å¢ƒç‹¬ç‰¹é—®é¢˜è§£å†³æ–¹æ¡ˆçš„æ¡†æ¶ã€‚</li>
<li>ä¸€ä¸ªCLIå·¥å…·ï¼Œå¸®ä½ å¿«é€Ÿåˆ›å»ºåº”ç”¨ï¼Œé¡µé¢ï¼Œç»„ä»¶ç­‰ã€‚</li>
</ol>
</li>
</ol>
<p><strong>å®ƒç”±ä»¥ä¸‹å‡ éƒ¨åˆ†ç»„æˆï¼š</strong></p>
<ul>
<li><p><strong>ä¸€ä¸ªæ’ä»¶åŒ–çš„æ ¸å¿ƒ</strong> - <a href="https://github.com/beautywe/beautywe" target="_blank" rel="external">BeautyWe Core</a><br>  å¯¹ Appã€Page è¿›è¡ŒæŠ½è±¡å’ŒåŒ…è£…ï¼Œä¿æŒä¼ ç»Ÿå¾®ä¿¡å°ç¨‹åºå¼€å‘å§¿åŠ¿ï¼ŒåŒæ—¶å¼€æ”¾éƒ¨åˆ†åŸç”Ÿèƒ½åŠ›ï¼Œè®©å…¶å…·æœ‰ã€Œå¯æ’ä»¶åŒ–ã€çš„èƒ½åŠ›ã€‚</p>
</li>
<li><p><strong>ä¸€äº›å®˜æ–¹æ’ä»¶</strong> â€” <a href="https://www.npmjs.com/search?q=keywords%3Abeautywe-plugin" target="_blank" rel="external">BeautyWe Plugins</a><br>  å¾—ç›Šäº Core çš„ã€Œå¯æ’ä»¶åŒ–ã€ç‰¹æ€§ï¼Œå°è£…å¤æ‚é€»è¾‘ï¼Œå®ç°å¯æ’æ‹”ã€‚å®˜æ–¹å¯¹äºå¸¸è§çš„éœ€æ±‚æä¾›äº†ä¸€äº›æ’ä»¶ï¼šå¦‚å¢å¼ºå­˜å‚¨ã€å‘å¸ƒ/è®¢é˜…ã€çŠ¶æ€æœºã€Loggerã€ç¼“å­˜ç­–ç•¥ç­‰ã€‚</p>
</li>
<li><p><strong>ä¸€å¥—å¼€ç®±å³ç”¨çš„é¡¹ç›®æ¡†æ¶</strong> - <a href="https://user-gold-cdn.xitu.io/2019/6/10/16b40250bcbe53fb#/contents/framework/introduce" target="_blank" rel="external">BeautyWe Framework</a><br>  æè¿°äº†ä¸€ç§é¡¹ç›®çš„ç»„ç»‡å½¢å¼ï¼Œå¼€ç®±å³ç”¨ï¼Œé›†æˆäº† <code>BeautyWe Core</code> ï¼Œå¹¶ä¸”æä¾›äº†å¦‚ï¼šå…¨å±€çª—å£ã€å¼€å‘è§„èŒƒã€å¤šç¯å¢ƒå¼€å‘ã€å…¨å±€é…ç½®ã€NPM ç­‰è§£å†³æ–¹æ¡ˆã€‚</p>
</li>
<li><p><strong>ä¸€ä¸ªCLIå·¥å…·</strong> - <a href="https://user-gold-cdn.xitu.io/2019/6/10/16b40250bcbe53fb#/remote/cli" target="_blank" rel="external">BeautyWe Cli</a><br>  æä¾›å¿«é€Ÿåˆ›å»ºåº”ç”¨ã€é¡µé¢ã€æ’ä»¶ï¼Œä»¥åŠé¡¹ç›®æ„å»ºåŠŸèƒ½çš„å‘½ä»¤è¡Œå·¥å…·ã€‚å¹¶ä¸”è¿˜æ”¯æŒè‡ªå®šä¹‰çš„åˆ›å»ºæ¨¡æ¿ã€‚</p>
</li>
</ul>
<h1 id="ä¸€ä¸ªç®€å•çš„ä¾‹å­"><a href="#ä¸€ä¸ªç®€å•çš„ä¾‹å­" class="headerlink" title="ä¸€ä¸ªç®€å•çš„ä¾‹å­"></a>ä¸€ä¸ªç®€å•çš„ä¾‹å­</h1><p>ä¸‹è½½</p>
<p><img src="https://raw.githubusercontent.com/JerryC8080/figure-bed/master/img/20190707181427" alt></p>
<p>ç”¨ BeautyWe åŒ…è£…ä½ çš„åº”ç”¨</p>
<p><img src="https://raw.githubusercontent.com/JerryC8080/figure-bed/master/img/20190707181445" alt></p>
<p>ä¹‹åï¼Œä½ å°±èƒ½ä½¿ç”¨ BeautyWe Plugin æä¾›çš„èƒ½åŠ›äº†ã€‚</p>
<p><img src="https://raw.githubusercontent.com/JerryC8080/figure-bed/master/img/20190707181337" alt></p>
<h1 id="å¼€æ”¾åŸç”ŸApp-Pageï¼Œæ”¯æŒæ’ä»¶åŒ–"><a href="#å¼€æ”¾åŸç”ŸApp-Pageï¼Œæ”¯æŒæ’ä»¶åŒ–" class="headerlink" title="å¼€æ”¾åŸç”ŸApp/Pageï¼Œæ”¯æŒæ’ä»¶åŒ–"></a>å¼€æ”¾åŸç”ŸApp/Pageï¼Œæ”¯æŒæ’ä»¶åŒ–</h1><p><code>new BtApp({...})</code> çš„æ‰§è¡Œç»“æœæ˜¯å¯¹åŸç”Ÿçš„åº”ç”¨è¿›è¡ŒåŒ…è£…ï¼Œå…¶ä¸­åŒ…å«äº†ã€Œæ’ä»¶åŒ–ã€çš„å¤„ç†ï¼Œç„¶åè¿”å›ä¸€ä¸ªæ–°çš„å®ä¾‹ï¼Œè¿™ä¸ªå®ä¾‹é€‚é…åŸç”Ÿçš„ <code>App()</code> æ–¹æ³•ã€‚</p>
<p>ä¸‹é¢æ¥è®²è®²ã€Œæ’ä»¶åŒ–ã€åˆ°åº•åšäº†ä»€ä¹ˆäº‹æƒ…ã€‚</p>
<p>é¦–å…ˆï¼Œæ’ä»¶åŒ–å¼€æ”¾äº†åŸç”Ÿ App çš„å››ç§èƒ½åŠ›ï¼š</p>
<ol>
<li><p><strong>Data åŸŸ</strong><br> æŠŠæ’ä»¶çš„ Data åŸŸåˆå¹¶åˆ°åŸç”Ÿ App çš„ Data åŸŸä¸­ï¼Œè¿™ä¸€å—å¾ˆå®¹æ˜“ç†è§£ã€‚</p>
</li>
<li><p><strong>åŸç”Ÿé’©å­å‡½æ•°</strong><br> ä½¿åŸç”Ÿé’©å­å‡½æ•°ï¼ˆå¦‚ <code>onShow</code>, <code>onLoad</code>ï¼‰å¯æ’ä»¶åŒ–ã€‚è®©åŸç”ŸAppä¸å¤šä¸ªæ’ä»¶å¯ä»¥åŒæ—¶ç›‘å¬åŒä¸€ä¸ªé’©å­å‡½æ•°ã€‚å¦‚ä½•å·¥ä½œçš„ï¼Œä¸‹é¢ä¼šç»†è¯´ã€‚</p>
</li>
<li><p><strong>äº‹ä»¶é’©å­å‡½æ•°</strong><br> ä½¿äº‹ä»¶é’©å­å‡½æ•°ï¼ˆä¸ view å±‚äº¤äº’çš„é’©å­å‡½æ•°ï¼‰ï¼Œå°½ç®¡åœ¨å®ç°ä¸Šæœ‰ä¸€äº›å·®å¼‚ï¼Œä½†æ˜¯å®ç°åŸç†è·Ÿã€ŒåŸç”Ÿé’©å­å‡½æ•°ã€ä¸€æ ·çš„ã€‚</p>
</li>
<li><p><strong>è‡ªå®šä¹‰æ–¹æ³•</strong><br> è®©æ’ä»¶èƒ½å¤Ÿç»™ä½¿ç”¨è€…æä¾› APIã€‚ä¸ºäº†ä¿è¯æ’ä»¶æä¾›çš„ API è¶³å¤Ÿçš„ä¼˜é›…ï¼Œæ”¯æŒå½“è°ƒç”¨æ’ä»¶ API çš„æ—¶å€™ï¼ˆå¦‚ event æ’ä»¶ <code>this.event.on(...)</code>)ï¼ŒAPI æ–¹æ³•å†…éƒ¨ä»ç„¶èƒ½é€šè¿‡ <code>this</code> è·å–åˆ°åŸç”Ÿå®ä¾‹ã€‚</p>
</li>
</ol>
<h4 id="é’©å­å‡½æ•°çš„æ’ä»¶åŒ–"><a href="#é’©å­å‡½æ•°çš„æ’ä»¶åŒ–" class="headerlink" title="é’©å­å‡½æ•°çš„æ’ä»¶åŒ–"></a>é’©å­å‡½æ•°çš„æ’ä»¶åŒ–</h4><p>åŸç”Ÿé’©å­å‡½æ•°ï¼Œäº‹ä»¶é’©å­å‡½æ•°æˆ‘ä»¬ç»Ÿä¸€ç§°ä¸ºã€Œé’©å­å‡½æ•°ã€ã€‚</p>
<p>å¯¹äºæ¯ä¸€ä¸ªé’©å­å‡½æ•°ï¼Œå†…éƒ¨æ˜¯ç»´æŠ¤ä¸€ä¸ªä»¥ Series Promise æ–¹å¼æ‰§è¡Œçš„æ‰§è¡Œé˜Ÿåˆ—ã€‚</p>
<p>ä»¥ <code>onShow</code> ä¸ºä¾‹ï¼Œå°†ä¼šä»¥è¿™æ ·çš„å½¢å¼æ‰§è¡Œï¼š</p>
<blockquote>
<p>native.onShow â†’ pluginA.onShow â†’ pluginB.onShow â†’ â€¦</p>
</blockquote>
<p><strong>ä¸‹é¢æ·±å…¥ä¸€ä¸‹æ’ä»¶åŒ–çš„åŸç†</strong>ï¼š</p>
<p><img src="https://raw.githubusercontent.com/JerryC8080/figure-bed/master/img/20190707181648" alt="beautywe pluggable"></p>
<p>å·¥ä½œåŸç†æ˜¯è¿™æ ·çš„ï¼š    </p>
<ol>
<li>ç»è¿‡ <code>new BtApp(...)</code> åŒ…è£…ï¼Œæ‰€æœ‰çš„é’©å­å‡½æ•°ï¼Œéƒ½ä¼šæœ‰ä¸€ä¸ªç‹¬ç«‹çš„æ‰§è¡Œé˜Ÿåˆ—ï¼Œ    </li>
<li>é¦–å…ˆä¼šæŠŠåŸç”Ÿçš„å„ä¸ªé’©å­å‡½æ•° <code>push</code> åˆ°å¯¹åº”çš„é˜Ÿåˆ—ä¸­ã€‚ç„¶åæ¯ <code>use</code> æ’ä»¶çš„æ—¶å€™ï¼Œéƒ½ä¼šåˆ†è§£æ’ä»¶çš„é’©å­å‡½æ•°ï¼Œå¾€å¯¹åº”çš„é˜Ÿåˆ— <code>push</code>ã€‚    </li>
<li>å½“ <code>Native App</code>ï¼ˆåŸç”Ÿï¼‰è§¦å‘æŸä¸ªé’©å­çš„æ—¶å€™ï¼Œ<code>BtApp</code> ä¼šä»¥ Promise Series çš„å½¢å¼æŒ‰å¾ªåºæ‰§è¡Œå¯¹åº”é˜Ÿåˆ—é‡Œé¢çš„å‡½æ•°ã€‚    </li>
<li>ç‰¹æ®Šçš„ï¼Œ<code>onLaunch</code> å’Œ <code>onLoad</code> çš„æ‰§è¡Œé˜Ÿåˆ—ä¸­ï¼Œä¼šåœ¨é˜Ÿåˆ—é¡¶éƒ¨æ’å…¥ä¸€ä¸ªåˆå§‹åŒ–çš„ä»»åŠ¡ï¼ˆ<code>initialize</code>ï¼‰ï¼Œå®ƒä¼šä»¥åŒæ­¥çš„æ–¹å¼æŒ‰å¾ªåºæ‰§è¡Œ <code>Initialize Queue</code> é‡Œé¢çš„å‡½æ•°ã€‚è¿™æ­£æ˜¯æ’ä»¶ç”Ÿå‘½å‘¨æœŸå‡½æ•°ä¸­çš„ <code>plugin.initialize</code>ã€‚</li>
</ol>
<p>è¿™ç§è®¾è®¡èƒ½æä¾›ä»¥ä¸‹åŠŸèƒ½ï¼š</p>
<ol>
<li><p>å¯æ’ä»¶åŒ–ã€‚<br> åªéœ€è¦å¾€å¯¹åº”é’©å­å‡½æ•°çš„äº‹ä»¶é˜Ÿåˆ—ä¸­æ’å…¥ä»»åŠ¡ã€‚</p>
</li>
<li><p>æ”¯æŒå¼‚æ­¥ã€‚<br> ç”±äºæ˜¯ä»¥ Promise Series æ–¹å¼è¿è¡Œçš„ï¼Œå…¶ä¸­ä¸€ä¸ªä»»åŠ¡è¿”å›ä¸€ä¸ª Promiseï¼Œä¸‹ä¸€ä¸ªä»»åŠ¡ä¼šç­‰å¾…è¿™ä¸ªä»»åŠ¡å®Œæˆå†å¼€å§‹ã€‚å¦‚æœå‘ç”Ÿé”™è¯¯ï¼Œä¼šæµè½¬åˆ°åŸç”Ÿçš„ <code>onError()</code> ä¸­ã€‚</p>
</li>
<li><p>è§£å†³äº†å¾®ä¿¡å°ç¨‹åº <code>app.js</code> ä¸­ <code>getApp() === undefinded</code>é—®é¢˜ã€‚<br> é€ æˆè¿™ä¸ªé—®é¢˜ï¼Œæœ¬è´¨æ˜¯å› ä¸º <code>App()</code> çš„æ—¶å€™ï¼ŒåŸç”Ÿå®ä¾‹æœªåˆ›å»ºã€‚ä½†æ˜¯ç”±äº Promise åœ¨ event loop ä¸­æ˜¯ä¸€ä¸ªå¾®ä»»åŠ¡ï¼Œè¢«æ³¨å†Œåœ¨ä¸‹ä¸€æ¬¡å¾ªç¯ã€‚æ‰€ä»¥ Promise æ‰§è¡Œçš„æ—¶å€™ <code>App()</code> æ—©å·²ç»å®Œæˆäº†ã€‚</p>
</li>
</ol>
<h1 id="ä¸€äº›å®˜æ–¹æ’ä»¶"><a href="#ä¸€äº›å®˜æ–¹æ’ä»¶" class="headerlink" title="ä¸€äº›å®˜æ–¹æ’ä»¶"></a>ä¸€äº›å®˜æ–¹æ’ä»¶</h1><p>BeautyWe å®˜æ–¹æä¾›äº†ä¸€ç³»åˆ—çš„æ’ä»¶ï¼š</p>
<ol>
<li>å¢å¼ºå­˜å‚¨: Storage</li>
<li>æ•°æ®åˆ—è¡¨ï¼šList Page</li>
<li>ç¼“å­˜ç­–ç•¥ï¼šCache</li>
<li>æ—¥å¿—ï¼šLogger</li>
<li>äº‹ä»¶å‘å¸ƒ/è®¢é˜…ï¼šEvent</li>
<li>çŠ¶æ€æœºï¼šStatus</li>
</ol>
<p>å®ƒä»¬çš„ä½¿ç”¨å¾ˆç®€å•ï¼Œå“ªé‡Œéœ€è¦æ’å“ªé‡Œã€‚<br>ç”±äºç¯‡å¹…çš„åŸå› ï¼Œä¸‹é¢æŒ‘å‡ ä¸ªæ¯”è¾ƒæœ‰è¶£çš„æ¥è®²è®²ï¼Œæ›´å¤šçš„å¯ä»¥çœ‹çœ‹å®˜æ–¹æ–‡æ¡£ï¼š<a href="http://beautywejs.com" target="_blank" rel="external">BeautyWe</a></p>
<h2 id="å¢å¼ºå­˜å‚¨-Storage"><a href="#å¢å¼ºå­˜å‚¨-Storage" class="headerlink" title="å¢å¼ºå­˜å‚¨ Storage"></a>å¢å¼ºå­˜å‚¨ Storage</h2><p>è¯¥åŠŸèƒ½ç”± <a href="https://github.com/beautywe/plugin-storage" target="_blank" rel="external">@beautywe/plugin-storage</a> æä¾›ã€‚</p>
<p>ç”±äºå¾®ä¿¡å°ç¨‹åºåŸç”Ÿçš„æ•°æ®å­˜å‚¨ç”Ÿå‘½å‘¨æœŸè·Ÿå°ç¨‹åºæœ¬èº«ä¸€è‡´ï¼Œå³é™¤ç”¨æˆ·ä¸»åŠ¨åˆ é™¤æˆ–è¶…è¿‡ä¸€å®šæ—¶é—´è¢«è‡ªåŠ¨æ¸…ç†ï¼Œå¦åˆ™æ•°æ®éƒ½ä¸€ç›´å¯ç”¨ã€‚</p>
<p>æ‰€ä»¥è¯¥æ’ä»¶åœ¨ <code>wx.getStorage/setStorage</code> çš„åŸºç¡€ä¸Šï¼Œæä¾›äº†ä¸¤ç§æ‰©å±•èƒ½åŠ›ï¼š</p>
<ol>
<li>è¿‡æœŸæ§åˆ¶</li>
<li>ç‰ˆæœ¬éš”ç¦»</li>
</ol>
<p><strong>ä¸€äº›ç®€å•çš„ä¾‹å­</strong></p>
<p>å®‰è£…<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; BtApp &#125; <span class="keyword">from</span> <span class="string">'@beautywe/core'</span>;</span><br><span class="line"><span class="keyword">import</span> storage <span class="keyword">from</span> <span class="string">'@beautywe/plugin-storage'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> BtApp();</span><br><span class="line">app.use(storage());</span><br></pre></td></tr></table></figure></p>
<p>è¿‡æœŸæ§åˆ¶<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 7å¤©åè¿‡æœŸ</span></span><br><span class="line">app.storage.set(<span class="string">'name'</span>, <span class="string">'jc'</span>, &#123; <span class="attr">expire</span>: <span class="number">7</span> &#125;)ï¼›</span><br></pre></td></tr></table></figure></p>
<p>ç‰ˆæœ¬éš”ç¦»<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">app.use(&#123; <span class="attr">appVersion</span>: <span class="string">'0.0.1'</span> &#125;);</span><br><span class="line">app.set(<span class="string">'name'</span>, <span class="string">'jc'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿”å› jc</span></span><br><span class="line">app.get(<span class="string">'name'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å½“ç‰ˆæœ¬æ›´æ–°å</span></span><br><span class="line">app.use(&#123; <span class="attr">appVersion</span>: <span class="string">'0.0.2'</span> &#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿”å› undefined;</span></span><br><span class="line">app.get(<span class="string">'name'</span>);</span><br></pre></td></tr></table></figure></p>
<p>æ›´å¤šçš„æŸ¥çœ‹ <a href="https://github.com/beautywe/plugin-storage" target="_blank" rel="external">@beautywe/plugin-storage å®˜æ–¹æ–‡æ¡£</a></p>
<h2 id="æ•°æ®åˆ—è¡¨-List-Page"><a href="#æ•°æ®åˆ—è¡¨-List-Page" class="headerlink" title="æ•°æ®åˆ—è¡¨ List Page"></a>æ•°æ®åˆ—è¡¨ List Page</h2><p>å¯¹äºååˆ†å¸¸è§çš„æ•°æ®åˆ—è¡¨åˆ†é¡µçš„ä¸šåŠ¡åœºæ™¯ï¼Œ<code>@beautywe/plugin-listpage</code> æä¾›äº†ä¸€å¥—æ‰“åŒ…æ–¹æ¡ˆï¼š</p>
<ol>
<li>æ»¡è¶³å¸¸ç”¨ã€Œæ•°æ®åˆ—è¡¨åˆ†é¡µã€çš„ä¸šåŠ¡åœºæ™¯</li>
<li>æ”¯æŒåˆ†é¡µ</li>
<li>æ”¯æŒå¤šä¸ªæ•°æ®åˆ—è¡¨</li>
<li>è‡ªåŠ¨æ•æ‰ä¸‹æ‹‰é‡è½½ï¼š<code>onPullDownRefresh</code></li>
<li>è‡ªåŠ¨æ•æ‰ä¸Šæ‹‰åŠ è½½ï¼š<code>onReachBottom</code></li>
<li>è‡ªå¸¦è¯·æ±‚é”ï¼Œé˜²æ­¢å¸•é‡‘æ£®æ°æ‰‹æŠ–ç”¨æˆ·</li>
<li>ç®€å•ä¼˜é›…çš„ API</li>
</ol>
<p>ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> BeautyWe <span class="keyword">from</span> <span class="string">'@beautywe/core'</span>;</span><br><span class="line"><span class="keyword">import</span> listpage <span class="keyword">from</span> <span class="string">'@beautywe/plugin-listpage'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> page = <span class="keyword">new</span> BeautyWe.BtPage();</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä½¿ç”¨ listpage æ’ä»¶</span></span><br><span class="line">page.use(listpage(&#123;</span><br><span class="line">    lists: [&#123;</span><br><span class="line">        name: <span class="string">'goods'</span>,  <span class="comment">// æ•°æ®å</span></span><br><span class="line">        pageSize: <span class="number">20</span>,   <span class="comment">// æ¯é¡µå¤šå°‘æ¡æ•°æ®ï¼Œé»˜è®¤ 10</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ¯ä¸€é¡µçš„æ•°æ®æºï¼Œæ²¡æ¬¡åŠ è½½é¡µé¢æ—¶ï¼Œä¼šè°ƒç”¨å‡½æ•°ï¼Œç„¶åå–è¿”å›çš„æ•°æ®ã€‚</span></span><br><span class="line">        fetchPageData(&#123; pageNo, pageSize &#125;) &#123;</span><br><span class="line">        </span><br><span class="line">            <span class="comment">// è·å–æ•°æ®</span></span><br><span class="line">            <span class="keyword">return</span> API.getGoodsList(&#123; pageNo, pageSize &#125;)</span><br><span class="line">            </span><br><span class="line">                <span class="comment">// æœ‰æ—¶å€™ï¼Œéœ€è¦å¯¹æœåŠ¡å™¨çš„æ•°æ®è¿›è¡Œå¤„ç†ï¼ŒdataCooker æ˜¯ä½ å®šä¹‰çš„å‡½æ•°ã€‚</span></span><br><span class="line">                .then(<span class="function">(<span class="params">rawData</span>) =&gt;</span> dataCooker(rawData));</span><br><span class="line">        &#125;,</span><br><span class="line">    &#125;],</span><br><span class="line">    enabledPullDownRefresh: <span class="literal">true</span>,    <span class="comment">// å¼€å¯ä¸‹æ‹‰é‡è½½ï¼Œ é»˜è®¤ false</span></span><br><span class="line">    enabledReachBottom: <span class="literal">true</span>,    <span class="comment">// å¼€å¯ä¸Šæ‹‰åŠ è½½ï¼Œ é»˜è®¤ false</span></span><br><span class="line">&#125;));</span><br><span class="line"></span><br><span class="line"><span class="comment">// goods æ•°æ®ä¼šè¢«åŠ è½½åˆ°ï¼Œgoods ä¸ºä¸Šé¢å®šä¹‰çš„ name</span></span><br><span class="line"><span class="comment">// this.data.listPage.goods = &#123;</span></span><br><span class="line"><span class="comment">//     data: [...],     // è§†å›¾å±‚ï¼Œé€šè¿‡è¯¥å­—æ®µæ¥è·å–å…·ä½“çš„æ•°æ®</span></span><br><span class="line"><span class="comment">//     hasMore: true,   // è§†å›¾å±‚ï¼Œé€šè¿‡è¯¥å­—æ®µæ¥è¯†åˆ«æ˜¯å¦æœ‰ä¸‹ä¸€é¡µ</span></span><br><span class="line"><span class="comment">//     currentPage: 1,  // è§†å›¾å±‚ï¼Œé€šè¿‡è¯¥å­—æ®µæ¥è¯†åˆ«å½“å‰ç¬¬å‡ é¡µ</span></span><br><span class="line"><span class="comment">//     totalPage: undefined,</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br></pre></td></tr></table></figure>
<p>åªéœ€è¦å‘Šè¯‰ <code>listpage</code> å¦‚ä½•è·å–æ•°æ®ï¼Œå®ƒä¼šè‡ªåŠ¨å¤„ç†ã€Œä¸‹æ‹‰é‡è½½ã€ã€ã€Œä¸Šæ‹‰ç¿»é¡µã€çš„æ“ä½œï¼Œç„¶åæŠŠæ•°æ®æ›´æ–°åˆ° <code>this.data.listPage.goods</code> ä¸‹ã€‚</p>
<p>View å±‚åªéœ€è¦æè¿°æ•°æ®æ€ä¹ˆå±•ç¤ºï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"good"</span> <span class="attr">wx:for</span>=<span class="string">"listPage.goods.data"</span>&gt;</span></span><br><span class="line">    ...</span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">view</span> <span class="attr">class</span>=<span class="string">"no-more"</span> <span class="attr">wx:if</span>=<span class="string">"listPage.goods.hasMore === false"</span>&gt;</span></span><br><span class="line">    æ²¡æœ‰æ›´å¤šäº†</span><br><span class="line"><span class="tag">&lt;/<span class="name">view</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><code>listpage</code> è¿˜æ”¯æŒå¤šæ•°æ®åˆ—è¡¨ç­‰å…¶ä»–æ›´å¤šé…ç½®ï¼Œè¯¦æƒ…çœ‹ï¼š<a href="https://github.com/beautywe/plugin-listpage" target="_blank" rel="external">@beautywe/plugin-listpage</a></p>
<h2 id="ç¼“å­˜ç­–ç•¥-Cache"><a href="#ç¼“å­˜ç­–ç•¥-Cache" class="headerlink" title="ç¼“å­˜ç­–ç•¥ Cache"></a>ç¼“å­˜ç­–ç•¥ Cache</h2><p><code>@beautywe/plugin-cache</code> æä¾›äº†ä¸€ä¸ªå¾®ä¿¡å°ç¨‹åºç«¯ç¼“å­˜ç­–ç•¥ï¼Œå…¶åº•å±‚ç”± <a href="https://github.com/JerryC8080/super-cache" target="_blank" rel="external">super-cache</a> æä¾›æ”¯æŒã€‚</p>
<h4 id="ç‰¹æ€§"><a href="#ç‰¹æ€§" class="headerlink" title="ç‰¹æ€§"></a>ç‰¹æ€§</h4><ol>
<li>æä¾›ä¸€å¥—ã€ŒæœåŠ¡ç«¯æ¥å£è€—æ—¶æ…¢ï¼Œä½†åŠ è½½æ€§èƒ½è¦æ±‚é«˜ã€åœºæ™¯çš„è§£å†³æ–¹æ¡ˆ</li>
<li>æ»¡è¶³æœ€åŸºæœ¬çš„ç¼“å­˜éœ€æ±‚ï¼Œè¯»å–ï¼ˆgetï¼‰å’Œä¿å­˜ï¼ˆsetï¼‰</li>
<li>æ”¯æŒé’ˆå¯¹ç¼“å­˜è¿›è¡Œé€»è¾‘ä»£ç†</li>
<li>çµæ´»å¯é…ç½®çš„æ•°æ®å­˜å‚¨æ–¹å¼</li>
</ol>
<h4 id="How-it-work"><a href="#How-it-work" class="headerlink" title="How it work"></a>How it work</h4><p>ä¸€èˆ¬çš„è¯·æ±‚æ•°æ®çš„å½¢å¼æ˜¯ï¼Œé¡µé¢åŠ è½½çš„æ—¶å€™ï¼Œä»æœåŠ¡ç«¯è·å–æ•°æ®ï¼Œç„¶åç­‰å¾…æ•°æ®è¿”å›ä¹‹åï¼Œè¿›è¡Œé¡µé¢æ¸²æŸ“ï¼š</p>
<p><img src="https://raw.githubusercontent.com/JerryC8080/figure-bed/master/img/20190707181755" alt></p>
<p>ä½†è¿™ç§æ¨¡å¼ï¼Œä¼šå—åˆ°æœåŠ¡ç«¯æ¥å£è€—æ—¶ï¼Œç½‘ç»œç¯å¢ƒç­‰å› ç´ å½±å“åˆ°åŠ è½½æ€§èƒ½ã€‚   </p>
<p>å¯¹äºåŠ è½½æ€§èƒ½è¦æ±‚é«˜çš„é¡µé¢ï¼ˆå¦‚é¦–é¡µï¼‰ï¼Œä¸€èˆ¬çš„ Web å¼€å‘æˆ‘ä»¬æœ‰å¾ˆå¤šè§£å†³æ–¹æ¡ˆï¼ˆå¦‚æœåŠ¡ç«¯æ¸²æŸ“ï¼ŒæœåŠ¡ç«¯ç¼“å­˜ï¼ŒSSR ç­‰ï¼‰ã€‚<br>ä½†æ˜¯ä¹Ÿæœ‰ä¸€äº›ç¯å¢ƒä¸èƒ½ä½¿ç”¨è¿™ç§æŠ€æœ¯ï¼ˆå¦‚å¾®ä¿¡å°ç¨‹åºï¼‰ã€‚</p>
<p>Super Cache æä¾›äº†ä¸€ä¸ªä¸­é—´æ•°æ®ç¼“å­˜çš„è§£å†³æ–¹æ¡ˆï¼š</p>
<p><img src="https://raw.githubusercontent.com/JerryC8080/figure-bed/master/img/20190707181847" alt></p>
<p>æ€è·¯ï¼š    </p>
<ol>
<li>å½“ä½ éœ€è¦è·å–ä¸€ä¸ªæ•°æ®çš„æ—¶å€™ï¼Œå¦‚æœæœ‰ç¼“å­˜ï¼Œå…ˆæŠŠæ—§çš„æ•°æ®ç»™ä½ ã€‚</li>
<li>ç„¶åå†ä»æœåŠ¡ç«¯è·å–æ–°çš„æ•°æ®ï¼Œåˆ·æ–°ç¼“å­˜ã€‚</li>
<li>å¦‚æœä¸€å¼€å§‹æ²¡æœ‰ç¼“å­˜ï¼Œåˆ™è¯·æ±‚æœåŠ¡ç«¯æ•°æ®ï¼Œå†æŠŠæ•°æ®è¿”å›ã€‚</li>
<li>ä¸‹ä¸€æ¬¡è¯·æ±‚ç¼“å­˜ï¼Œä»ç¬¬ä¸€æ­¥å¼€å§‹ã€‚</li>
</ol>
<p>è¿™ç§è§£å†³æ–¹æ¡ˆï¼Œèˆå¼ƒäº†ä¸€ç‚¹æ•°æ®çš„å®æ—¶æ€§ï¼ˆéç¬¬ä¸€æ¬¡è¯·æ±‚ï¼Œåªèƒ½è·å–ä¸Šä¸€æ¬¡æœ€æ–°æ•°æ®ï¼‰ï¼Œå¤§å¤§æé«˜äº†å‰ç«¯çš„åŠ è½½æ€§èƒ½ã€‚<br>é€‚åˆçš„åœºæ™¯ï¼š    </p>
<ol>
<li>æ•°æ®å®æ—¶æ€§è¦æ±‚ä¸é«˜ã€‚</li>
<li>æœåŠ¡ç«¯æ¥å£è€—æ—¶é•¿ã€‚</li>
</ol>
<h4 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; BtApp &#125; <span class="keyword">from</span> <span class="string">'@beautywe/core'</span>;</span><br><span class="line"><span class="keyword">import</span> cache <span class="keyword">from</span> <span class="string">'@beautywe/plugin-cache'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> app = <span class="keyword">new</span> BtApp();</span><br><span class="line">app.use(cache(&#123;</span><br><span class="line">    adapters: [&#123;</span><br><span class="line">        key: <span class="string">'name'</span>,</span><br><span class="line">        data() &#123;</span><br><span class="line">            <span class="keyword">return</span> API.fetch(<span class="string">'xxx/name'</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;]</span><br><span class="line">&#125;));</span><br></pre></td></tr></table></figure>
<p>å‡è®¾ <code>API.fetch(&#39;xxx/name&#39;)</code> æ˜¯è¯·æ±‚æœåŠ¡å™¨æ¥å£ï¼Œè¿”å›æ•°æ®ï¼š<code>data_from_server</code></p>
<p>é‚£ä¹ˆï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">app.cache.get(<span class="string">'name'</span>).then(<span class="function">(<span class="params">value</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// value: 'data_from_server'  </span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>æ›´å¤šçš„é…ç½®ï¼Œè¯¦æƒ…çœ‹ï¼š<a href="https://github.com/beautywe/plugin-cache" target="_blank" rel="external">@beautywe/plugin-cache</a></p>
<h2 id="æ—¥å¿—-Logger"><a href="#æ—¥å¿—-Logger" class="headerlink" title="æ—¥å¿— Logger"></a>æ—¥å¿— Logger</h2><p>ç”± <code>@beautywe/logger-plugin</code> æä¾›çš„ä¸€ä¸ªè½»é‡çš„æ—¥å¿—å¤„ç†æ–¹æ¡ˆï¼Œå®ƒæ”¯æŒï¼š</p>
<ol>
<li>å¯æ§çš„ log level</li>
<li>è‡ªå®šä¹‰å‰ç¼€</li>
<li>æ—¥å¿—ç»Ÿä¸€å¤„ç†</li>
</ol>
<h4 id="ä½¿ç”¨-1"><a href="#ä½¿ç”¨-1" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; BtApp &#125; <span class="keyword">from</span> <span class="string">'@beautywe/core'</span>;</span><br><span class="line"><span class="keyword">import</span> logger <span class="keyword">from</span> <span class="string">'@beautywe/plugin-logger'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> page = <span class="keyword">new</span> BtApp();</span><br><span class="line"></span><br><span class="line">page.use(logger(&#123;</span><br><span class="line">    <span class="comment">// options</span></span><br><span class="line">&#125;));</span><br></pre></td></tr></table></figure>
<p><strong>API</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">page.logger.info(<span class="string">'this is info'</span>);</span><br><span class="line">page.logger.warn(<span class="string">'this is warn'</span>);</span><br><span class="line">page.logger.error(<span class="string">'this is error'</span>);</span><br><span class="line">page.logger.debug(<span class="string">'this is debug'</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¾“å‡º</span></span><br><span class="line"><span class="comment">// [info] this is info</span></span><br><span class="line"><span class="comment">// [warn] this is warn</span></span><br><span class="line"><span class="comment">// [error] this is error</span></span><br><span class="line"><span class="comment">// [debug] this is debug</span></span><br></pre></td></tr></table></figure>
<p><strong>Level control</strong></p>
<p>å¯é€šè¿‡é…ç½®æ¥æ§åˆ¶å“ªäº› level è¯¥æ‰“å°ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">page.use(logger(&#123;</span><br><span class="line">    level: <span class="string">'warn'</span>,</span><br><span class="line">&#125;));</span><br></pre></td></tr></table></figure>
<p>é‚£ä¹ˆ <code>warn</code> ä»¥ä¸Šçš„ log ï¼ˆ<code>info</code>, <code>debug</code>ï¼‰å°±ä¸ä¼šè¢«æ‰“å°ï¼Œè¿™ç§æ»¡è¶³äºå¼€å‘å’Œç”Ÿæˆç¯å¢ƒå¯¹ log çš„ä¸åŒéœ€æ±‚ã€‚</p>
<p>level ç­‰çº§å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Logger.LEVEL = &#123;</span><br><span class="line">    error: <span class="number">1</span>,</span><br><span class="line">    warn: <span class="number">2</span>,</span><br><span class="line">    info: <span class="number">3</span>,</span><br><span class="line">    debug: <span class="number">4</span>,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>æ›´å¤šçš„é…ç½®ï¼Œè¯¦æƒ…çœ‹ï¼š<a href="https://github.com/beautywe/plugin-logger" target="_blank" rel="external">@beautywe/plugin-logger</a></p>
<h1 id="BeautyWe-Framework"><a href="#BeautyWe-Framework" class="headerlink" title="BeautyWe Framework"></a>BeautyWe Framework</h1><p><code>@beautywe/core</code> å’Œ <code>@beautywe/plugin-...</code> ç»™å°ç¨‹åºæä¾›äº†ï¼š</p>
<ol>
<li>å¼€æ”¾åŸç”Ÿï¼Œæ”¯æŒæ’ä»¶åŒ– â€”â€” by core</li>
<li>å„ç§æ’ä»¶ â€”â€” by plugins</li>
</ol>
<p>ä½†æ˜¯ï¼Œè¿˜æœ‰å¾ˆå¤šçš„å¼€å‘ä¸­å®é™…è¿˜ä¼šé‡åˆ°çš„ç—›ç‚¹ï¼Œæ˜¯ä¸Šé¢ä¸¤ä¸ªè§£å†³ä¸åˆ°çš„ã€‚<br>å¦‚é¡¹ç›®çš„ç»„ç»‡ã€è§„èŒƒã€å·¥ç¨‹åŒ–ã€é…ç½®ã€å¤šç¯å¢ƒç­‰ç­‰</p>
<p>è¿™äº›å°±æ˜¯ï¼Œã€ŒBeautyWe Frameworkã€è¦è§£å†³çš„èŒƒç•´ã€‚</p>
<p>å®ƒä½œä¸ºä¸€å¥—å¼€ç®±å³ç”¨çš„é¡¹ç›®æ¡†æ¶ï¼Œæä¾›äº†è¿™äº›åŠŸèƒ½ï¼š</p>
<ul>
<li>é›†æˆ BeautyWe Core</li>
<li>NPM æ”¯æŒ</li>
<li>å…¨å±€çª—å£</li>
<li>å…¨å±€ Pageï¼ŒComponent</li>
<li>å…¨å±€é…ç½®æ–‡ä»¶</li>
<li>å¤šç¯å¢ƒå¼€å‘</li>
<li>Example Pages</li>
<li>æ­£å¸¸é¡¹ç›®éœ€è¦çš„æ ‡é…ï¼šES2015+,sass,uglify,watch ç­‰</li>
<li>ä»¥åŠæˆ‘ä»¬è®¤ä¸ºè‰¯å¥½çš„é¡¹ç›®è§„èŒƒï¼ˆeslintï¼Œcommit logï¼Œç›®å½•ç»“æ„ç­‰ï¼‰</li>
</ul>
<p>ä¹Ÿæ˜¯ç”±äºç¯‡å¹…åŸå› ï¼ŒæŒ‘å‡ ä¸ªæœ‰è¶£çš„æ¥è®²è®²ï¼Œæ›´å¤šçš„å¯ä»¥çœ‹çœ‹å®˜æ–¹æ–‡æ¡£ï¼š<a href="http://beautywejs.com" target="_blank" rel="external">BeautyWe</a></p>
<h2 id="å¿«é€Ÿåˆ›å»º"><a href="#å¿«é€Ÿåˆ›å»º" class="headerlink" title="å¿«é€Ÿåˆ›å»º"></a>å¿«é€Ÿåˆ›å»º</h2><p>é¦–å…ˆå®‰è£… <code>@beautywe/cli</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> npm i @beautywe/cli -g</span><br></pre></td></tr></table></figure>
<h4 id="åˆ›å»ºåº”ç”¨"><a href="#åˆ›å»ºåº”ç”¨" class="headerlink" title="åˆ›å»ºåº”ç”¨"></a>åˆ›å»ºåº”ç”¨</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> beautywe new app</span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;</span> appName: my-app</span><br><span class="line"><span class="meta">&gt;</span> version: 0.0.1</span><br><span class="line"><span class="meta">&gt;</span> appid: 123456</span><br><span class="line"><span class="meta">&gt;</span> è¿™æ ·å¯ä»¥ä¹ˆ:</span><br><span class="line"><span class="meta">&gt;</span> &#123;</span><br><span class="line"><span class="meta">&gt;</span>    "appName": "my-app",</span><br><span class="line"><span class="meta">&gt;</span>    "version": "0.0.1",</span><br><span class="line"><span class="meta">&gt;</span>    "appid": "123456"</span><br><span class="line"><span class="meta">&gt;</span> &#125;</span><br></pre></td></tr></table></figure>
<p>å›ç­”å‡ ä¸ªé—®é¢˜ä¹‹åï¼Œé¡¹ç›®å°±ç”Ÿæˆäº†ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">my-app</span><br><span class="line">â”œâ”€â”€ gulpfile.js</span><br><span class="line">â”œâ”€â”€ package.json</span><br><span class="line">â””â”€â”€ src</span><br><span class="line">    â”œâ”€â”€ app.js</span><br><span class="line">    â”œâ”€â”€ app.json</span><br><span class="line">    â”œâ”€â”€ app.scss</span><br><span class="line">    â”œâ”€â”€ assets</span><br><span class="line">    â”œâ”€â”€ components</span><br><span class="line">    â”œâ”€â”€ config</span><br><span class="line">    â”œâ”€â”€ examples</span><br><span class="line">    â”œâ”€â”€ libs</span><br><span class="line">    â”œâ”€â”€ npm</span><br><span class="line">    â”œâ”€â”€ pages</span><br><span class="line">    â””â”€â”€ project.config.json</span><br></pre></td></tr></table></figure>
<h4 id="åˆ›å»ºé¡µé¢ã€ç»„ä»¶ã€æ’ä»¶"><a href="#åˆ›å»ºé¡µé¢ã€ç»„ä»¶ã€æ’ä»¶" class="headerlink" title="åˆ›å»ºé¡µé¢ã€ç»„ä»¶ã€æ’ä»¶"></a>åˆ›å»ºé¡µé¢ã€ç»„ä»¶ã€æ’ä»¶</h4><p><strong>é¡µé¢</strong></p>
<ol>
<li>ä¸»åŒ…é¡µé¢ï¼š<code>beautywe new page &lt;path|name&gt;</code></li>
<li>åˆ†åŒ…é¡µé¢ï¼š<code>beautywe new page --subpkg &lt;subPackageName&gt; &lt;path|name&gt;</code></li>
</ol>
<p><strong>ç»„ä»¶</strong></p>
<ol>
<li><code>beautywe new component &lt;name&gt;</code></li>
</ol>
<p><strong>æ’ä»¶</strong></p>
<ol>
<li><code>beautywe new plugin &lt;name&gt;</code></li>
</ol>
<h4 id="è‡ªå®šä¹‰æ¨¡æ¿"><a href="#è‡ªå®šä¹‰æ¨¡æ¿" class="headerlink" title="è‡ªå®šä¹‰æ¨¡æ¿"></a>è‡ªå®šä¹‰æ¨¡æ¿</h4><p>åœ¨ <code>./.templates</code> ç›®å½•ä¸­ï¼Œå­˜æ”¾ç€å¿«é€Ÿåˆ›å»ºå‘½ä»¤çš„åˆ›å»ºæ¨¡æ¿ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> tree .templates</span><br><span class="line"></span><br><span class="line">.templates</span><br><span class="line">â”œâ”€â”€ component</span><br><span class="line">â”‚   â”œâ”€â”€ index.js</span><br><span class="line">â”‚   â”œâ”€â”€ index.json</span><br><span class="line">â”‚   â”œâ”€â”€ index.scss</span><br><span class="line">â”‚   â””â”€â”€ index.wxml</span><br><span class="line">â”œâ”€â”€ page</span><br><span class="line">â”‚   â”œâ”€â”€ index.js</span><br><span class="line">â”‚   â”œâ”€â”€ index.json</span><br><span class="line">â”‚   â”œâ”€â”€ index.scss</span><br><span class="line">â”‚   â””â”€â”€ index.wxml</span><br><span class="line">â””â”€â”€ plugin</span><br><span class="line">    â””â”€â”€ index.js</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥ä¿®æ”¹é‡Œé¢çš„æ¨¡æ¿ï¼Œæ¥æ»¡è¶³é¡¹ç›®çº§åˆ«çš„è‡ªå®šä¹‰æ¨¡æ¿åˆ›å»ºã€‚</p>
<h2 id="å…¨å±€çª—å£"><a href="#å…¨å±€çª—å£" class="headerlink" title="å…¨å±€çª—å£"></a>å…¨å±€çª—å£</h2><p>æˆ‘ä»¬éƒ½çŸ¥é“å¾®ä¿¡å°ç¨‹åºæ˜¯ã€Œå•çª—å£ã€çš„äº¤äº’å¹³å°ï¼Œä¸€ä¸ªé¡µé¢å¯¹åº”ä¸€ä¸ªçª—å£ã€‚<br>è€Œåœ¨ä¸šåŠ¡å¼€å‘ä¸­ï¼Œå¾€å¾€ä¼šæœ‰è¯¸å¦‚è¿™ç§è¿°æ±‚ï¼š</p>
<ol>
<li>è‡ªå®šä¹‰çš„ toast æ ·å¼</li>
<li>é¡µé¢åº•éƒ¨ copyright</li>
<li>å…¨å±€çš„ loading æ ·å¼</li>
<li>å…¨å±€çš„æ‚¬æµ®æ§ä»¶<br>â€¦â€¦</li>
</ol>
<p>ç¨å¾®ä¸ä¼˜é›…çš„å®ç°å¯ä»¥æ˜¯åˆ†åˆ«åšæˆç‹¬ç«‹çš„ç»„ä»¶ï¼Œç„¶åæ¯ä¸€ä¸ªé¡µé¢éƒ½å¼•å…¥è¿›æ¥ã€‚<br>è¿™ç§åšæ³•ï¼Œæˆ‘ä»¬ä¼šæœ‰å¾ˆå¤šçš„é‡å¤ä»£ç ï¼Œå¹¶ä¸”æ¯æ¬¡æ–°å»ºé¡µé¢ï¼Œéƒ½è¦å¼•å…¥ä¸€éï¼ŒåæœŸç»´æŠ¤ä¹Ÿä¼šå¾ˆç¹çã€‚</p>
<p>è€Œã€Œå…¨å±€çª—å£ã€çš„æ¦‚å¿µæ˜¯ï¼š<strong>å¸Œæœ›æ‰€æœ‰é¡µé¢ä¹‹ä¸Šæœ‰ä¸€å—åœ°æ–¹ï¼Œå…¨å±€æ€§çš„é€»è¾‘å’Œäº¤äº’ï¼Œå¯ä»¥å¾€é‡Œé¢æã€‚</strong></p>
<h4 id="global-view-ç»„ä»¶"><a href="#global-view-ç»„ä»¶" class="headerlink" title="global-view ç»„ä»¶"></a>global-view ç»„ä»¶</h4><p>è¿™æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰ç»„ä»¶ï¼Œæºç åœ¨ <code>/src/components/global-view</code></p>
<p>æ¯ä¸ªé¡µé¢çš„ wxml åªéœ€è¦åœ¨é¡¶å±‚åŒ…ä¸€å±‚ï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">global-view</span> <span class="attr">id</span>=<span class="string">"global-view"</span>&gt;</span></span><br><span class="line">    ...</span><br><span class="line"><span class="tag">&lt;/<span class="name">global-view</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>éœ€è¦å…¨å±€å®ç°çš„äº¤äº’ã€æ ·å¼ã€ç»„ä»¶ï¼Œåªéœ€è¦ç»´æŠ¤è¿™ä¸ªç»„ä»¶å°±è¶³å¤Ÿäº†ã€‚</p>
<h2 id="å…¨å±€é…ç½®æ–‡ä»¶"><a href="#å…¨å±€é…ç½®æ–‡ä»¶" class="headerlink" title="å…¨å±€é…ç½®æ–‡ä»¶"></a>å…¨å±€é…ç½®æ–‡ä»¶</h2><p>åœ¨ <code>src/config/</code> ç›®å½•ä¸­ï¼Œå¯ä»¥å­˜æ”¾å„ç§å…¨å±€çš„é…ç½®æ–‡ä»¶ï¼Œå¹¶ä¸”æ”¯æŒä»¥ Node.js çš„æ–¹å¼è¿è¡Œã€‚ï¼ˆå¾—ç›Šäº <a href="/contents/framework/concept/nodejs-power.md">Node.js Power ç‰¹æ€§</a>ï¼‰ã€‚</p>
<p>å¦‚ <code>src/config/logger.js</code>:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> env = process.env.RUN_ENV || <span class="string">'dev'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> logger = <span class="built_in">Object</span>.assign(&#123;</span><br><span class="line">    prefix: <span class="string">'BeautyWe'</span>,</span><br><span class="line">    level: <span class="string">'debug'</span>,</span><br><span class="line">&#125;, &#123;</span><br><span class="line">    <span class="comment">// å¼€å‘ç¯å¢ƒçš„é…ç½®</span></span><br><span class="line">    dev: &#123;</span><br><span class="line">        level: <span class="string">'debug'</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// æµ‹è¯•ç¯å¢ƒçš„é…ç½®</span></span><br><span class="line">    test: &#123;</span><br><span class="line">        level: <span class="string">'info'</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// çº¿ä¸Šç¯å¢ƒçš„é…ç½®</span></span><br><span class="line">    prod: &#123;</span><br><span class="line">        level: <span class="string">'warn'</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;[env] || &#123;&#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports.logger = logger;</span><br></pre></td></tr></table></figure>
<p>ç„¶åæˆ‘ä»¬å¯ä»¥è¿™æ ·è¯»å–åˆ° config å†…å®¹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; logger &#125; <span class="keyword">from</span> <span class="string">'/config/index'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// logger.level ä¼šæ ¹æ®ç¯å¢ƒä¸åŒè€Œä¸åŒã€‚</span></span><br></pre></td></tr></table></figure>
<p>Beautywe Framework é»˜è®¤ä¼šæŠŠ config é›†æˆåˆ° <code>getApp()</code> çš„ç¤ºä¾‹ä¸­ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">getApp().config;</span><br></pre></td></tr></table></figure>
<h2 id="å¤šç¯å¢ƒå¼€å‘"><a href="#å¤šç¯å¢ƒå¼€å‘" class="headerlink" title="å¤šç¯å¢ƒå¼€å‘"></a>å¤šç¯å¢ƒå¼€å‘</h2><p>BeautyWe Framework æ”¯æŒå¤šç¯å¢ƒå¼€å‘ï¼Œå…¶ä¸­é¢„è®¾äº†ä¸‰å¥—ç­–ç•¥ï¼š</p>
<ul>
<li>dev</li>
<li>test</li>
<li>prod</li>
</ul>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡å‘½ä»¤æ¥è¿è¡Œè¿™ä¸‰ä¸ªæ„å»ºç­–ç•¥ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">beautywe run dev</span><br><span class="line">beautywe run test</span><br><span class="line">beautywe run prod</span><br></pre></td></tr></table></figure>
<h2 id="ä¸‰å¥—ç¯å¢ƒçš„å·®å¼‚"><a href="#ä¸‰å¥—ç¯å¢ƒçš„å·®å¼‚" class="headerlink" title="ä¸‰å¥—ç¯å¢ƒçš„å·®å¼‚"></a>ä¸‰å¥—ç¯å¢ƒçš„å·®å¼‚</h2><p>Beautywe Framework æºç é»˜è®¤åœ¨ä¸¤æ–¹é¢ä½¿ç”¨äº†å¤šç¯å¢ƒï¼š</p>
<ul>
<li>æ„å»ºä»»åŠ¡ï¼ˆ<code>gulpfile.js/env/...</code>ï¼‰</li>
<li>å…¨å±€é…ç½®ï¼ˆ<code>src/config/...</code>ï¼‰</li>
</ul>
<h3 id="æ„å»ºä»»åŠ¡çš„å·®å¼‚"><a href="#æ„å»ºä»»åŠ¡çš„å·®å¼‚" class="headerlink" title="æ„å»ºä»»åŠ¡çš„å·®å¼‚"></a>æ„å»ºä»»åŠ¡çš„å·®å¼‚</h3><table>
<thead>
<tr>
<th>æ„å»ºä»»åŠ¡</th>
<th>è¯´æ˜</th>
<th style="text-align:center">dev</th>
<th style="text-align:center">test</th>
<th style="text-align:center">prod</th>
</tr>
</thead>
<tbody>
<tr>
<td>clean</td>
<td>æ¸…é™¤distæ–‡ä»¶</td>
<td style="text-align:center">âˆš</td>
<td style="text-align:center">âˆš</td>
<td style="text-align:center">âˆš</td>
</tr>
<tr>
<td>copy</td>
<td>å¤åˆ¶èµ„æºæ–‡ä»¶</td>
<td style="text-align:center">âˆš</td>
<td style="text-align:center">âˆš</td>
<td style="text-align:center">âˆš</td>
</tr>
<tr>
<td>scripts</td>
<td>ç¼–è¯‘JSæ–‡ä»¶</td>
<td style="text-align:center">âˆš</td>
<td style="text-align:center">âˆš</td>
<td style="text-align:center">âˆš</td>
</tr>
<tr>
<td>sass</td>
<td>ç¼–è¯‘scssæ–‡ä»¶</td>
<td style="text-align:center">âˆš</td>
<td style="text-align:center">âˆš</td>
<td style="text-align:center">âˆš</td>
</tr>
<tr>
<td>npm</td>
<td>ç¼–è¯‘npmæ–‡ä»¶</td>
<td style="text-align:center">âˆš</td>
<td style="text-align:center">âˆš</td>
<td style="text-align:center">âˆš</td>
</tr>
<tr>
<td>nodejs-power</td>
<td>ç¼–è¯‘Node.jsæ–‡ä»¶</td>
<td style="text-align:center">âˆš</td>
<td style="text-align:center">âˆš</td>
<td style="text-align:center">âˆš</td>
</tr>
<tr>
<td>watch</td>
<td>ç›‘å¬æ–‡ä»¶ä¿®æ”¹</td>
<td style="text-align:center">âˆš</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
</tr>
<tr>
<td>scripts-min</td>
<td>å‹ç¼©JSæ–‡ä»¶</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center">âˆš</td>
</tr>
<tr>
<td>sass-min</td>
<td>å‹ç¼©scssæ–‡ä»¶</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center">âˆš</td>
</tr>
<tr>
<td>npm-min</td>
<td>å‹ç¼©npmæ–‡ä»¶</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center">âˆš</td>
</tr>
<tr>
<td>image-min</td>
<td>å‹ç¼©å›¾ç‰‡æ–‡ä»¶</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center">âˆš</td>
</tr>
<tr>
<td>clean-example</td>
<td>æ¸…é™¤ç¤ºä¾‹é¡µé¢</td>
<td style="text-align:center"></td>
<td style="text-align:center"></td>
<td style="text-align:center">âˆš</td>
</tr>
</tbody>
</table>
<h3 id="Node-js-Power"><a href="#Node-js-Power" class="headerlink" title="Node.js Power"></a>Node.js Power</h3><p>Beautywe Framework çš„ä»£ç æœ‰ä¸¤ç§è¿è¡Œç¯å¢ƒï¼š</p>
<ol>
<li>Node.js è¿è¡Œç¯å¢ƒï¼Œå¦‚æ„å»ºä»»åŠ¡ç­‰ã€‚</li>
<li>å¾®ä¿¡å°ç¨‹åºè¿è¡Œç¯å¢ƒï¼Œå¦‚æ‰“åŒ…åˆ° <code>dist</code> æ–‡ä»¶å¤¹çš„ä»£ç ã€‚</li>
</ol>
<h4 id="è¿è¡Œè¿‡ç¨‹"><a href="#è¿è¡Œè¿‡ç¨‹" class="headerlink" title="è¿è¡Œè¿‡ç¨‹"></a>è¿è¡Œè¿‡ç¨‹</h4><blockquote>
<p>Node.js Power æœ¬è´¨æ˜¯ä¸€ç§é™æ€ç¼–è¯‘çš„å®ç°ã€‚<br>æŠŠæŸä¸ªæ–‡ä»¶åœ¨ Node.js ç¯å¢ƒè¿è¡Œçš„ç»“æœï¼Œè¾“å‡ºåˆ°å¾®ä¿¡å°ç¨‹åºè¿è¡Œç¯å¢ƒä¸­ï¼Œä»¥æ­¤æ¥æ»¡è¶³ç‰¹å®šçš„éœ€æ±‚ã€‚</p>
</blockquote>
<p>Node.js Power ä¼šæŠŠé¡¹ç›®ä¸­ <code>src</code> ç›®å½•ä¸‹ç±»ä¼¼ <code>xxx.nodepower.js</code> å‘½åçš„æ–‡ä»¶ï¼Œä»¥ Node.js æ¥è¿è¡Œï¼Œ<br>ç„¶åæŠŠè¿è¡Œçš„ç»“æœï¼Œä»¥ã€Œå­—é¢é‡å¯¹è±¡ã€çš„å½¢å¼å†™åˆ° <code>dist</code> ç›®å½•ä¸‹å¯¹åº”çš„åŒåæ–‡ä»¶ <code>xxx.nodepower.js</code> æ–‡ä»¶å»ã€‚</p>
<p>ä»¥ <code>src/config/index.nodepower.js</code> ä¸ºä¾‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</span><br><span class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> files = fs.readdirSync(path.join(__dirname));</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> result = &#123;&#125;;</span><br><span class="line"></span><br><span class="line">files</span><br><span class="line">    .filter(<span class="function"><span class="params">name</span> =&gt;</span> name !== <span class="string">'index.js'</span>)</span><br><span class="line">    .forEach(<span class="function">(<span class="params">name</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="built_in">Object</span>.assign(result, <span class="built_in">require</span>(path.join(__dirname, <span class="string">`./<span class="subst">$&#123;name&#125;</span>`</span>)));</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line"><span class="built_in">module</span>.exports = result;</span><br></pre></td></tr></table></figure>
<p>è¯¥æ–‡ä»¶ï¼Œç»è¿‡ Node.js Power æ„å»ºä¹‹å:</p>
<p><code>dist/config/index.nodepower.js</code>: </p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>.exports = &#123;</span><br><span class="line">    <span class="string">"appInfo"</span>: &#123;</span><br><span class="line">        <span class="string">"version"</span>: <span class="string">"0.0.1"</span>,</span><br><span class="line">        <span class="string">"env"</span>: <span class="string">"test"</span>,</span><br><span class="line">        <span class="string">"appid"</span>: <span class="string">"wx85fc0d03fb0b224d"</span>,</span><br><span class="line">        <span class="string">"name"</span>: <span class="string">"beautywe-framework-test-app"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">"logger"</span>: &#123;</span><br><span class="line">        <span class="string">"prefix"</span>: <span class="string">"BeautyWe"</span>,</span><br><span class="line">        <span class="string">"level"</span>: <span class="string">"info"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>è¿™å°±æ»¡è¶³äº†ï¼Œéšæ„å¾€ <code>src/config/</code> ç›®å½•ä¸­æ‰©å±•é…ç½®æ–‡ä»¶ï¼Œéƒ½èƒ½è¢«è‡ªåŠ¨æ‰“åŒ…ã€‚</p>
<p>Node.js Power å·²ç»è¢«é›†æˆåˆ°å¤šç¯å¢ƒå¼€å‘çš„ dev, test, prod ä¸­å»ã€‚</p>
<p>å½“ç„¶ï¼Œä½ å¯ä»¥æ‰‹åŠ¨è¿è¡Œè¿™ä¸ªæ„å»ºä»»åŠ¡ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> gulp nodejs-power</span><br></pre></td></tr></table></figure>
<h3 id="NPM"><a href="#NPM" class="headerlink" title="NPM"></a>NPM</h3><p>BeautyWe Framework å®ç°æ”¯æŒ npm çš„åŸç†å¾ˆç®€å•ï¼Œæ€»ç»“ä¸€å¥è¯ï¼š</p>
<blockquote>
<p>ä½¿ç”¨ webpack æ‰“åŒ… <code>src/npm/index.js</code> ï¼Œä»¥ commonjs æ ¼å¼è¾“å‡ºåˆ° <code>dist/npm/index.js</code></p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/JerryC8080/figure-bed/master/img/20190707181936" alt="npm-works"></p>
<p>è¿™æ ·åšçš„å¥½å¤„ï¼š</p>
<ol>
<li>å®ç°ç®€å•ã€‚</li>
<li>è®© npm åŒ…èƒ½é›†ä¸­ç®¡ç†ï¼Œæ¯æ¬¡å¼•å…¥ä¾èµ–ï¼Œéƒ½å¥½å¥½çš„æƒ³ä¸€ä¸‹ï¼Œé¿å…æ³›æ»¥ï¼ˆå°¤å…¶åœ¨å¤šäººå¼€å‘ä¸­ï¼‰ã€‚</li>
<li>ä½¿ç”¨ <code>ll dist/npm/index.js</code> å‘½ä»¤èƒ½å¿«é€Ÿçœ‹åˆ°é¡¹ç›®ä¸­çš„ npm åŒ…ä½¿å äº†å¤šå°‘å®¹é‡ã€‚</li>
</ol>
<h4 id="æ–°å¢-npm-ä¾èµ–"><a href="#æ–°å¢-npm-ä¾èµ–" class="headerlink" title="æ–°å¢ npm ä¾èµ–"></a>æ–°å¢ npm ä¾èµ–</h4><p>åœ¨ <code>src/npm/index.js</code> æ–‡ä»¶ä¸­ï¼Œè¿›è¡Œ exportï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export &#123; default as beautywe &#125; from &apos;@beautywe/core&apos;;</span><br></pre></td></tr></table></figure>
<p>ç„¶ååœ¨å…¶ä»–æ–‡ä»¶ importï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; beautywe &#125; <span class="keyword">from</span> <span class="string">'./npm/index'</span>;</span><br></pre></td></tr></table></figure>
<h1 id="æ›´å¤š"><a href="#æ›´å¤š" class="headerlink" title="æ›´å¤š"></a>æ›´å¤š</h1><p>æ€»çš„æ¥è¯´ï¼ŒBeautyWe æ˜¯ä¸€å¥—å¾®ä¿¡å°ç¨‹åºçš„å¼€å‘èŒƒå¼ã€‚</p>
<p><code>core</code> å’Œ <code>plugins</code> æ‰©å±•åŸç”Ÿï¼Œæä¾›å¤æ‚é€»è¾‘çš„å°è£…å’Œæ’æ‹”å¼ä½¿ç”¨ã€‚</p>
<p>è€Œ <code>framework</code> åˆ™è´Ÿè´£æä¾›ä¸€æ•´å¥—é’ˆå¯¹äºå¾®ä¿¡å°ç¨‹åºçš„ä¼ä¸šçº§é¡¹ç›®è§£å†³æ–¹æ¡ˆï¼Œå¼€ç®±å³ç”¨ã€‚</p>
<p>å…¶ä¸­è¿˜æœ‰æ›´å¤šçš„å†…å®¹ï¼Œæ¬¢è¿æµè§ˆå®˜ç½‘ï¼š<a href="http://beautywejs.com" target="_blank" rel="external">beautywejs.com</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;https://raw.githubusercontent.com/beautywe/docs/master/docs/assets/images/logo-V4.png&quot; alt&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å®˜ç½‘ï¼š&lt;a href=&quot;htt
    
    </summary>
    
      <category term="æ¬ç –ç å†œ" scheme="http://huang-jerryc.com/categories/%E6%90%AC%E7%A0%96%E7%A0%81%E5%86%9C/"/>
    
    
      <category term="å°ç¨‹åº" scheme="http://huang-jerryc.com/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/"/>
    
  </entry>
  
  <entry>
    <title>è®°ä¸€æ¬¡ã€Œå…³äºæ²Ÿé€šã€çš„åŸ¹è®­</title>
    <link href="http://huang-jerryc.com/2019/04/13/about-communicate/"/>
    <id>http://huang-jerryc.com/2019/04/13/about-communicate/</id>
    <published>2019-04-13T09:39:00.000Z</published>
    <updated>2019-04-13T09:45:45.626Z</updated>
    
    <content type="html"><![CDATA[<p>å‘¨æœ«å‚ä¸äº†å…¬å¸ç»™TLä»¬å®‰æ’çš„ä¸€ä¸ªä¸»é¢˜ä¸ºã€Šé«˜æ•ˆæ²Ÿé€šã€‹çš„è¯¾ç¨‹ï¼Œä¸ºæœŸä¸¤å¤©ã€‚<br>ä»¥å¾€è‡ªå·±å¯¹ã€Œæ²Ÿé€šã€è‡ªæˆ‘æ„Ÿè§‰è‰¯å¥½ï¼Œå®Œå…¨å‡­å€Ÿæ„Ÿè§‰æ¥ï¼Œåªè¦è·Ÿå¯¹æ–¹èƒ½è¡¨è¾¾æ¸…æ¥šè‡ªå·±çš„æƒ³æ³•ï¼Œè¶³çŸ£ã€‚<br>ä¸¤å¤©ä¸‹æ¥ï¼Œé‡æ–°å¼€å§‹è®¤è¯†ï¼Œã€Œæ²Ÿé€šã€ï¼Œå…¶å®æ˜¯ä¸€é—¨å¾ˆæ·±çš„å­¦é—®ã€‚<br>è¿™ç¯‡åƒæ˜¯ç¬”è®°ï¼Œä¹Ÿåƒæ˜¯æˆ‘å¯¹ã€Œæ²Ÿé€šã€è¿™é—¨å­¦é—®çš„é‡æ–°è®¤è¯†ã€‚</p>
<h1 id="è¨æäºšæ¨¡å‹"><a href="#è¨æäºšæ¨¡å‹" class="headerlink" title="è¨æäºšæ¨¡å‹"></a>è¨æäºšæ¨¡å‹</h1><blockquote>
<p>æ²Ÿé€šä¸­éœ€è¦è®¤è¯†åˆ°è°ˆè¯è€…çš„çŠ¶æ€</p>
</blockquote>
<p><img src="/image/blog/about-communicate/DraggedImage.png" alt="è¨æäºšæ²Ÿé€šæ¨¡å‹"></p>
<p>ã€Œè¨æäºšæ¨¡å‹ã€æ˜¯ç”±ç¾å›½å®¶åº­æ²»ç–—ä¸“å®¶ Virginia Satir å¥³å£«æ‰€åˆ›å»ºçš„ç†è®ºä½“ç³»ã€‚è¿™ç§ä½“ç³»èµ·åˆæ˜¯è¢«è¿ç”¨åœ¨å®¶åº­å¿ƒç†æ²»ç–—æ–¹é¢ã€‚ä½†æ˜¯åœ¨è¯¸å¤šçš„å®¶åº­æ²»ç–—ç†è®ºä¸­ï¼Œè¨æäºšæ¨¡å‹ä¸€ç›´æ˜¯éš¾ä»¥å½’ç±»çš„ï¼Œæœ‰çš„æ•™ç§‘ä¹¦å°†ä¹‹åˆ—ä¸ºã€Œæ²Ÿé€šå­¦æ´¾ã€ï¼Œæœ‰çš„çº³å…¥ã€Œäººæœ¬å­¦æ´¾ã€ã€‚ç©¶å…¶åŸå› ï¼Œå°±æ˜¯è¨æäºšæ¨¡å‹ä¸å¼ºè°ƒç—…æ€çš„ã€‚</p>
<p>ä¸€è¨€è”½ä¹‹å°±æ˜¯ï¼šè¨æäºšæ¨¡å‹ï¼Œä¸ä»…ä»…é€‚ç”¨äºå¿ƒç†æ²»ç–—ï¼Œåœ¨äººä¸äººæ²Ÿé€šä¸­ï¼Œä¹Ÿèƒ½æå‡æˆ‘ä»¬çš„è®¤çŸ¥ã€‚</p>
<p>è¿™ä¸ªæ¨¡å‹æœ‰ä¸¤ä¸ªé‡è¦çš„ç†è®ºï¼š</p>
<ol>
<li><strong>å†°å±±ç†è®º</strong></li>
<li><strong>åº”å¯¹å§¿æ€</strong></li>
</ol>
<h2 id="å†°å±±ç†è®º"><a href="#å†°å±±ç†è®º" class="headerlink" title="å†°å±±ç†è®º"></a>å†°å±±ç†è®º</h2><p><img src="/image/blog/about-communicate/DraggedImage-1.png" alt="å†°å±±ç†è®º"></p>
<p>ä¸€ä¸ªäººçš„ã€Œè‡ªæˆ‘ã€å°±åƒä¸€åº§å†°å±±ä¸€æ ·ï¼Œåˆ«äººæ‰€çœ‹åˆ°çš„åªæ˜¯å†°å±±ä¸€è§’ã€‚<br>å¤–åœ¨çš„ã€Œè¡Œä¸ºã€å’Œã€Œåº”å¯¹æ–¹å¼ã€ï¼Œæˆ‘ä»¬æ˜¯èƒ½å¾ˆå¿«çš„çœ‹å¾—åˆ°çš„ã€‚<br>ä½†æ˜¯å†…åœ¨çš„ã€Œæ„Ÿå—ã€ã€ã€Œè§‚ç‚¹ã€ã€ã€ŒæœŸå¾…ã€ã€ã€Œæ¸´æœ›ã€æ˜¯æ²¡é‚£ä¹ˆå®¹æ˜“çŸ¥é“çš„ã€‚</p>
<p>æœ‰ä¸€ä¸ªä¾‹å­ç‰¹åˆ«å¥½ï¼š    </p>
<blockquote>
<p>ä¸€å¯¹å¹´è½»å¤«å¦»ï¼Œä¸ˆå¤«çš„èŒä¸šæ˜¯åŸ¹è®­å¸ˆï¼Œå¾ˆèƒ½èµšé’±ï¼Œä½†æ˜¯ç»å¸¸éœ€è¦å‡ºå·®ã€‚å¥¹çš„å¦»å­å°±ç»å¸¸æŠ±æ€¨ä»–ä¸å¸¸å›æ¥é™ªä¼´å¥¹ï¼Œè§‰å¾—ä¸ˆå¤«ä¸çˆ±ä»–ã€‚ä½†æ˜¯ä¸ˆå¤«å¾ˆçº³é—·ï¼Œå¸¸å¸¸é™ªä¼´å¦»å­çš„è¯ï¼Œè‡ªå·±å°±ä¸èƒ½å¥½å¥½çš„å·¥ä½œäº†ã€‚<br>åæ¥ä¸ˆå¤«è·Ÿå¦»å­å¥½å¥½è°ˆè¿‡ä¹‹åï¼Œæ‰å‘ç°ï¼Œå¦»å­æŠ±æ€¨çš„åŸå› æ˜¯å› ä¸ºã€Œå®‰å…¨æ„Ÿã€ä¸è¶³ã€‚å› ä¸ºä¸ˆå¤«å¾ˆèƒ½èµšé’±ï¼Œé•¿æœŸä¸åœ¨èº«è¾¹çš„è¯ï¼Œæ€•ä¼šåœ¨å¤–é¢æ‰¾å°ä¸‰ã€‚<br>é‚£ä¹ˆäº‹æƒ…å°±å¥½åŠäº†ï¼Œä¸ˆå¤«ç´¢æ€§æŠŠæ‰€æœ‰çš„æ”¶å…¥éƒ½ç»™è€å©†ç®¡äº†ã€‚</p>
</blockquote>
<p>ä»è¿™ä¸ªä¾‹å­ä¸­ï¼Œå…¶å®æˆ‘ä»¬æ¥å¥—ä¸€ä¸‹å†°å±±ç†è®ºï¼š</p>
<ul>
<li>è¡Œä¸ºï¼šä¸ˆå¤«å¸¸å¸¸å‡ºå·®</li>
<li>åº”å¯¹æ–¹å¼ï¼šåŸ‹æ€¨ã€åµæ¶</li>
<li>è§‚ç‚¹ï¼šæœ‰é’±çš„ç”·äººé•¿æœŸåœ¨å¤–é¢ï¼Œå®¹æ˜“æ‰¾å°ä¸‰</li>
<li>æœŸå¾…ï¼šå¤šç‚¹å›å®¶ï¼Œé™ªé™ªè€å©†</li>
<li>æ¸´æœ›ï¼šå®‰å…¨æ„Ÿ</li>
</ul>
<p>å…¶å®å¦»å­å†…å¿ƒæ·±å¤„æ¸´æœ›çš„æ˜¯ä¸€ä¸ªã€Œå®‰å…¨æ„Ÿã€ï¼Œä»æœ€æ·±å¤„çš„æ¸´æœ›ä¸‹æ‰‹ï¼Œåªè¦èƒ½æ»¡è¶³å¯¹æ–¹çš„æ·±å±‚æ¬¡çš„æ¸´æœ›ï¼Œé—®é¢˜å°±å¼•åˆƒè€Œè§£äº†ã€‚</p>
<h2 id="æ²Ÿé€šå§¿æ€"><a href="#æ²Ÿé€šå§¿æ€" class="headerlink" title="æ²Ÿé€šå§¿æ€"></a>æ²Ÿé€šå§¿æ€</h2><p>æ ¹æ®è¨æäºšæ¨¡å‹ï¼Œäººæœ‰äº”ç§çš„æ²Ÿé€šå§¿æ€ï¼š</p>
<ul>
<li>æŒ‡è´£å‹</li>
<li>è®¨å¥½å‹</li>
<li>è¶…ç†æ™ºå‹</li>
<li>æ‰“å²”å‹</li>
<li>è¡¨é‡Œä¸€è‡´å‹</li>
</ul>
<p>è€Œè¿™äº”ç§çš„æ²Ÿé€šå§¿æ€è¡¨ç°åœ¨å¯¹ä¸‰ä¸ªæ²Ÿé€šè¦ç´ çš„å…³æ³¨åº¦ä¸åŒï¼š</p>
<ul>
<li>è‡ªæˆ‘</li>
<li>ä»–äºº</li>
<li>æƒ…æ™¯</li>
</ul>
<h3 id="æŒ‡è´£å‹"><a href="#æŒ‡è´£å‹" class="headerlink" title="æŒ‡è´£å‹"></a>æŒ‡è´£å‹</h3><blockquote>
<p>å…³æ³¨ã€Œè‡ªæˆ‘ã€ã€ã€Œæƒ…æ™¯ã€ï¼Œå¿½ç•¥ã€Œä»–äººã€</p>
</blockquote>
<p>æŒ‡è´£å‹çš„äººå¸¸å¸¸å¿½ç•¥ä»–äººï¼Œä¹ æƒ¯äºæ”»å‡»å’Œæ‰¹åˆ¤ï¼Œå°†è´£ä»»æ¨ç»™åˆ«äººã€‚â€œéƒ½æ˜¯ä½ çš„é”™â€ï¼Œâ€œä½ åˆ°åº•æ€ä¹ˆæçš„â€æ˜¯ä»–ä»¬çš„å£å¤´è¯­ã€‚</p>
<h3 id="è®¨å¥½å‹"><a href="#è®¨å¥½å‹" class="headerlink" title="è®¨å¥½å‹"></a>è®¨å¥½å‹</h3><blockquote>
<p>å…³æ³¨ã€Œä»–äººã€ã€ã€Œæƒ…æ™¯ã€ï¼Œå¿½ç•¥ã€Œè‡ªæˆ‘ã€</p>
</blockquote>
<p>è®¨å¥½å‹çš„äººå¿½ç•¥è‡ªå·±ï¼Œå†…åœ¨ä»·å€¼æ„Ÿæ¯”è¾ƒä½ã€‚è¨€è¯­ä¸­ç»å¸¸æµéœ²å‡ºâ€œè¿™éƒ½æ˜¯æˆ‘çš„é”™â€ï¼Œâ€œæˆ‘æƒ³è¦è®©ä½ é«˜å…´â€ä¹‹ç±»çš„è¯ã€‚è¡Œä¸ºä¸Šåˆ™è¿‡åº¦å’Œå–„ï¼Œä¹ æƒ¯äºé“æ­‰å’Œä¹æ€œã€‚</p>
<h3 id="è¶…ç†æ™ºå‹"><a href="#è¶…ç†æ™ºå‹" class="headerlink" title="è¶…ç†æ™ºå‹"></a>è¶…ç†æ™ºå‹</h3><blockquote>
<p>å…³æ³¨ã€Œæƒ…æ™¯ã€ã€å¿½ç•¥ã€Œä»–äººã€ã€ã€Œè‡ªæˆ‘ã€</p>
</blockquote>
<p>è¶…ç†æ™ºå‹çš„äººæç«¯å®¢è§‚ï¼Œåªå…³å¿ƒäº‹æƒ…ï¼Œå¿½ç•¥ä¸ä¸ªäººæˆ–æƒ…ç»ªã€‚å¸¸å¸¸ç»™äººçš„æ„Ÿè§‰æ˜¯å†·æ¼ ã€å†·æ·¡ã€‚</p>
<h3 id="æ‰“å²”å‹"><a href="#æ‰“å²”å‹" class="headerlink" title="æ‰“å²”å‹"></a>æ‰“å²”å‹</h3><blockquote>
<p>å•¥ä¹Ÿä¸å…³æ³¨</p>
</blockquote>
<p>æ‰“å²”å‹çš„äººåˆ™æ°¸è¿œä¸æŠ“é‡ç‚¹ï¼Œä¸ç›´æ¥å›ç­”é—®é¢˜æˆ–æ ¹æœ¬æ–‡ä¸å¯¹é¢˜ã€‚æ€»æ˜¯å¯ä»¥æ‰“ç ´å„ç§ç»æœ›çš„æ°›å›´ï¼ŒæŠŠæ³¨æ„åŠ›ä»ä»»ä½•æœ‰å‹åŠ›çš„è¯é¢˜ä¸Šè½¬ç§»å¼€</p>
<p>å½“ç„¶ï¼Œæ²¡æœ‰äººæ°¸è¿œæ˜¯å•çº¯çš„ä¸€ç§æ²Ÿé€šå§¿æ€çš„ã€‚è€Œæˆ‘è‡ªå·±å°±æ˜¯é‚£ç§ã€Œæœ‰æ—¶è®¨å¥½æœ‰æ—¶æŒ‡è´£æœ‰æ—¶è¶…ç†æ™ºï¼Œè€Œæœ‰æ—¶å€™ä¼šæ‰“å²”è½¬ç§»è¯é¢˜ã€ã€‚</p>
<h1 id="æ²Ÿé€šçš„æ ¸å¿ƒæŠ€èƒ½"><a href="#æ²Ÿé€šçš„æ ¸å¿ƒæŠ€èƒ½" class="headerlink" title="æ²Ÿé€šçš„æ ¸å¿ƒæŠ€èƒ½"></a>æ²Ÿé€šçš„æ ¸å¿ƒæŠ€èƒ½</h1><p>åœ¨æ²Ÿé€šä¸­ï¼Œæœ‰å››ç§é‡è¦çš„æŠ€èƒ½ï¼š</p>
<ul>
<li>ã€Œç§¯æè†å¬ã€</li>
<li>ã€Œæœ‰æ•ˆæé—®ã€</li>
<li>ã€Œæ¸…æ™°è¡¨è¾¾ã€</li>
<li>ã€Œåé¦ˆã€</li>
</ul>
<h2 id="ç§¯æè†å¬"><a href="#ç§¯æè†å¬" class="headerlink" title="ç§¯æè†å¬"></a>ç§¯æè†å¬</h2><p>åœ¨åˆ«äººè¯´è¯çš„æ—¶å€™ï¼Œç§¯æçš„è†å¬ï¼Œè¿™ä¸ªè¿‡ç¨‹ä»ä½ çš„è¨€è¡Œå’Œè„¸éƒ¨è¡¨æƒ…ï¼Œéƒ½èƒ½ç»™åˆ°å¯¹æ–¹æ­£å‘çš„åé¦ˆã€‚</p>
<h2 id="æœ‰æ•ˆæé—®"><a href="#æœ‰æ•ˆæé—®" class="headerlink" title="æœ‰æ•ˆæé—®"></a>æœ‰æ•ˆæé—®</h2><p>æ²Ÿé€šè¿‡ç¨‹ä¸­ï¼Œä½ å¾€å¾€èƒ½é€šè¿‡æé—®æ¥æ§åˆ¶è¯é¢˜çš„æ–¹å‘ã€äº†è§£å¯¹æ–¹çš„æƒ³æ³•ã€å¢å¼ºå¯¹æ–¹çš„è‡ªä¿¡ã€ç”šè‡³å¥½çš„é—®é¢˜èƒ½å¼•èµ·å¯¹æ–¹æ·±å±‚æ¬¡çš„æ€è€ƒã€‚<br>æé—®å¯ä»¥æœ‰ä¸€ä¸ªç»ƒä¹ çš„å¥—è·¯ï¼šã€Œç›®æ ‡ã€â†’ã€Œç°çŠ¶ã€â†’ã€Œæ–¹æ¡ˆã€â†’ã€Œè¡ŒåŠ¨ã€<br>ä¾‹å¦‚</p>
<ul>
<li>è¯¢é—®ç›®æ ‡ï¼šä½ è®¤ä¸ºæ€æ ·çš„ç»“æœæ˜¯æ»¡æ„çš„ï¼Ÿ</li>
<li>è¯¢é—®ç°çŠ¶ï¼šè¯·é—®ä½ å·²ç»å°è¯•äº†å“ªäº›æ–¹æ¡ˆäº†ï¼Ÿ</li>
<li>è¯¢é—®æ–¹æ¡ˆï¼šè¿˜å¯ä»¥é‡‡å–å“ªäº›æªæ–½ï¼Ÿ</li>
<li>è¯¢é—®å¿ƒåŠ¨ï¼šæ¥ä¸‹æ¥æ‰“ç®—åšä»€ä¹ˆï¼Ÿ</li>
</ul>
<h2 id="æ¸…æ™°è¡¨è¾¾"><a href="#æ¸…æ™°è¡¨è¾¾" class="headerlink" title="æ¸…æ™°è¡¨è¾¾"></a>æ¸…æ™°è¡¨è¾¾</h2><p>åœ¨è¡¨è¾¾ä¸­ï¼Œæˆ‘ä»¬å¸¸å¸¸ä¼šé‡åˆ°é‚£ç§å‰åè¯´äº†ä¸€å¤§é€šï¼Œæœ€åå…¶å®åªè¡¨è¾¾äº†ä¸€ä¸ªæ„æ€çš„äººã€‚ä¹Ÿæœ‰äº›äººè¡¨è¾¾æ··ä¹±ï¼Œæ€è·¯ä¸æ¸…æ™°çš„ã€‚</p>
<p>è¿™é‡Œä¹Ÿæœ‰ä¸€ä¸ªå¯ç»ƒä¹ çš„è¡¨è¾¾å¥—è·¯ï¼š</p>
<ol>
<li>ã€Œè§‚ç‚¹ Pointã€</li>
<li>ã€ŒåŸå›  Reasonã€</li>
<li>ã€Œä¸¾ä¾‹ Exampleã€</li>
<li>ã€Œå¤è¿°è§‚ç‚¹ Point againã€or ã€Œæå‡ºè¯·æ±‚ Proposalã€</li>
</ol>
<p>ä¾‹å¦‚ï¼š</p>
<ol>
<li>æå‡ºè§‚ç‚¹ï¼šä¸ºäº†æˆ‘ä»¬æ›´é«˜æ•ˆçš„å®Œæˆç›®æ ‡ï¼Œæˆ‘çš„æƒ³æ³•æ˜¯â€¦</li>
<li>è¯´æ˜åŸå› ï¼šæˆ‘ä¸‹è¿™ä¸ªç»“è®ºæ˜¯å› ä¸ºâ€¦</li>
<li>ä¸¾ä¸ªæ —å­ï¼šå¦‚æœè¾¾æˆäº†ï¼Œæˆ‘ä»¬ä¼šæœ‰è¿™äº›æå‡â€¦</li>
<li>æå‡ºè¯·æ±‚ï¼šå¦‚æœä½ ä¹ŸåŒæ„çš„è¯ï¼Œæˆ‘å¸Œæœ›èƒ½å¾—åˆ°è¿™äº›å¸®åŠ©â€¦</li>
</ol>
<h2 id="åé¦ˆ"><a href="#åé¦ˆ" class="headerlink" title="åé¦ˆ"></a>åé¦ˆ</h2><p>å¾ˆå–œæ¬¢å¯¹åé¦ˆçš„ä¸€ç§çœ‹æ³•ï¼šã€Œåé¦ˆæ˜¯ä¸€ç§ç¤¼ç‰©ï¼ã€<br>å°¤å…¶æ˜¯å»ºè®¾æ€§çš„åé¦ˆï¼Œæ›´èƒ½ä½¿è‡ªå·±æˆ–å¯¹æ–¹æœ‰æ‰€è¿›æ­¥ã€‚<br>é‚£ä¹ˆå¦‚ä½•æå‡ºä¸€ä¸ªæœ‰å»ºè®¾æ€§çš„åé¦ˆï¼Œè¿™ä¹Ÿæœ‰ä¸€ä¸ªç»ƒä¹ çš„å¥—è·¯ï¼š</p>
<ol>
<li>ã€Œè¡Œä¸º Actionã€</li>
<li>ã€Œå½±å“ Impactã€</li>
<li>ã€Œè¡ŒåŠ¨ Doã€</li>
</ol>
<p>ä¾‹å¦‚ï¼š</p>
<ol>
<li>è¡Œä¸ºï¼šå…„å¼Ÿï¼Œå•æ‰€çš„å¢™ä¸Šè´´ç€ã€Œç¦æ­¢å¸çƒŸã€çš„ã€‚</li>
<li>å½±å“ï¼šå•æ‰€çš„é€šé£å¾ˆå·®çš„ï¼ŒçƒŸå‘³ä¼šä¹…ä¹…æ•£ä¸å»çš„ï¼Œæƒ³è±¡ä¸€ä¸‹å±å‘³çƒŸå‘³æ··æ‚çš„å•æ‰€ï¼Œå®¢æˆ·æ¥åˆ°å…¬å¸ï¼Œå°è±¡å¾ˆå·®çš„ã€‚è€Œä¸”å¯¹åˆ«äººèº«ä½“ä¹Ÿä¸å¥åº·ï¼Œæ˜¯å§ã€‚</li>
<li>è¡ŒåŠ¨ï¼šä½ ä¸çŸ¥é“ï¼Œå…¶å®å…¬å¸åœ¨èµ°å»Šä¸Šæ˜¯æœ‰ä¸“é—¨çš„å¸çƒŸåŒºçš„ï¼Œåœ¨é‚£é‡Œé£æ™¯åˆå¥½ï¼Œå²‚ä¸æ˜¯æ›´èˆ’ç•…ã€‚</li>
</ol>
<h1 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h1><p>ã€Œæ²Ÿé€šã€æ—¢æ˜¯ä¸€é—¨å­¦é—®ï¼Œä¹Ÿæ˜¯ä¸€é—¨è‰ºæœ¯ã€‚<br>å°½ç„¶æœ‰å„ç§ç†è®ºå’Œç ”ç©¶ï¼Œä½†æœ€åè¿˜æ˜¯ä¸ºã€Œå®è·µã€æœåŠ¡ã€‚<br>æˆ‘è®¤ä¸ºï¼Œä»¥ä¸Šçº¯å±ç†è®ºï¼Œè¦çœŸæ­£è½å®åˆ°å®é™…åº”ç”¨ï¼Œè¿˜éœ€è¦å¤šå¤šé”»ç‚¼ï¼Œä»¥åŠåº”æ™¯å‘æŒ¥ï¼Œè¿˜è¦åŸºäºç°å®æ¥å¥½å¥½æ„Ÿæ‚Ÿã€‚<br>å¦å¤–ï¼Œå¦‚æœæœ‰å…´è¶£ç»§ç»­æ·±å…¥ç ”ç©¶çš„è¯ï¼Œè¿™é‡Œæœ‰ä¸€ä¸ªä¹¦å•ï¼š</p>
<ul>
<li>ã€Šé‡‘å­—å¡”åŸç†ã€‹</li>
<li>ã€Šå¤©èµ„å·®å¼‚ã€‹</li>
<li>ã€Šç±»å‹ä¸åŸå‹ã€‹</li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å‘¨æœ«å‚ä¸äº†å…¬å¸ç»™TLä»¬å®‰æ’çš„ä¸€ä¸ªä¸»é¢˜ä¸ºã€Šé«˜æ•ˆæ²Ÿé€šã€‹çš„è¯¾ç¨‹ï¼Œä¸ºæœŸä¸¤å¤©ã€‚&lt;br&gt;ä»¥å¾€è‡ªå·±å¯¹ã€Œæ²Ÿé€šã€è‡ªæˆ‘æ„Ÿè§‰è‰¯å¥½ï¼Œå®Œå…¨å‡­å€Ÿæ„Ÿè§‰æ¥ï¼Œåªè¦è·Ÿå¯¹æ–¹èƒ½è¡¨è¾¾æ¸…æ¥šè‡ªå·±çš„æƒ³æ³•ï¼Œè¶³çŸ£ã€‚&lt;br&gt;ä¸¤å¤©ä¸‹æ¥ï¼Œé‡æ–°å¼€å§‹è®¤è¯†ï¼Œã€Œæ²Ÿé€šã€ï¼Œå…¶å®æ˜¯ä¸€é—¨å¾ˆæ·±çš„å­¦é—®ã€‚&lt;br&gt;è¿™ç¯‡åƒæ˜¯ç¬”è®°ï¼Œä¹Ÿåƒæ˜¯æˆ‘å¯¹ã€Œæ²Ÿé€šã€è¿™é—¨å­¦é—®
    
    </summary>
    
      <category term="ä¸‰çœå¾èº«" scheme="http://huang-jerryc.com/categories/%E4%B8%89%E7%9C%81%E5%90%BE%E8%BA%AB/"/>
    
    
  </entry>
  
  <entry>
    <title>ã€Šç®¡ç†çš„å¸¸è¯†ã€‹è¯»åæ„Ÿ ã€Œä¸€ã€</title>
    <link href="http://huang-jerryc.com/2019/03/21/management-of-common-sense-1/"/>
    <id>http://huang-jerryc.com/2019/03/21/management-of-common-sense-1/</id>
    <published>2019-03-21T12:46:40.000Z</published>
    <updated>2019-04-13T09:30:38.771Z</updated>
    
    <content type="html"><![CDATA[<h1 id="ã€Šç®¡ç†çš„å¸¸è¯†ã€‹è¯»åæ„Ÿ-ã€Œä¸€ã€"><a href="#ã€Šç®¡ç†çš„å¸¸è¯†ã€‹è¯»åæ„Ÿ-ã€Œä¸€ã€" class="headerlink" title="ã€Šç®¡ç†çš„å¸¸è¯†ã€‹è¯»åæ„Ÿ ã€Œä¸€ã€"></a>ã€Šç®¡ç†çš„å¸¸è¯†ã€‹è¯»åæ„Ÿ ã€Œä¸€ã€</h1><p>é™ˆæ˜¥èŠ±çš„ã€Šç®¡ç†çš„å¸¸è¯†ã€‹æ˜¯ä¸€æœ¬ç›¸è§æ¨æ™šçš„ä¹¦ã€‚åœ¨è¯»çš„è¿‡ç¨‹ä¸­ä¼šæœ‰ä¸€ç§ã€Œå¦‚æœèƒ½æ—©ç‚¹é‡åˆ°ä½ å¤šå¥½å•Šã€çš„æ„Ÿæ…¨ã€‚ä½†æ¢ç§æ€è·¯ï¼Œä¸€å¹´å‰è¯»ä¸ç°åœ¨è¯»ï¼Œè‚¯å®šæ˜¯å®Œå…¨ä¸åŒçš„æ”¶è·ã€‚ç°åœ¨è¯»ï¼Œèƒ½æ›´å¤šç»“åˆè¿‡å»çš„å®é™…æ„Ÿå—ï¼Œæç‚¼æ›´å¤šçš„æ„Ÿæ‚Ÿå’Œåæ€ã€‚<br>è¿™æœ¬ä¹¦æˆ‘è¯»çš„å¾ˆæ…¢ï¼Œå®ƒè™½ç„¶å¾ˆè–„ï¼Œä½†æ˜¯æœ‰å¤§é‡çš„å†…å®¹å€¼å¾—æ·±åº¦æ€è€ƒï¼Œå¹¶ä¸”æ¯ä¸ªäººä¸åŒçš„æ—¶æœŸä¸åŒçš„ç»å†ï¼Œä¹Ÿä¼šæœ‰ä¸åŒçš„ç†è§£å’Œæ„Ÿæ‚Ÿã€‚å€˜è‹¥ä¸€å¹´åå†æ¥è¯»ï¼Œæ„Ÿå—ä¹Ÿæ˜¯ä¸ä¸€æ ·çš„ã€‚<br>ä»3æœˆ4æ—¥æ‹¿åˆ°ä¹¦ï¼Œåˆ°ä»Šå¤©ä¸ºæ­¢ï¼Œæˆ‘è¿˜æ²¡æœ‰å®Œå…¨è¯»å®Œï¼Œæˆ‘æŒ‘äº†ä¸¤ä¸ªæœ€æœ‰æ„Ÿæ‚Ÿçš„ç‚¹æ¥åˆ†äº«ä¸‹å¿ƒå¾—ï¼Œåˆ†åˆ«æ˜¯ï¼šã€Œå…³äºç®¡ç†ã€å’Œã€Œå…³äºæ¿€åŠ±ã€ã€‚</p>
<h2 id="å…³äºç®¡ç†"><a href="#å…³äºç®¡ç†" class="headerlink" title="å…³äºç®¡ç†"></a>å…³äºç®¡ç†</h2><p>å¾ˆå–œæ¬¢å¾·é²å…‹çš„ä¸€å¥è¯ï¼šã€Œç®¡ç†æ˜¯ä¸€ç§å®è·µï¼Œå…¶æœ¬è´¨ä¸åœ¨äºçŸ¥ï¼Œè€Œåœ¨äºè¡Œï¼›å…¶éªŒè¯ä¸åœ¨äºé€»è¾‘ï¼Œè€Œåœ¨äºæˆæœï¼›å…¶å”¯ä¸€çš„æƒå¨æ€§å°±æ˜¯æˆå°±ã€ã€‚<br>å¼ºè°ƒçš„æ˜¯ï¼Œç®¡ç†æ˜¯å…³æ³¨ã€Œå®è·µã€ä¸ã€Œç»“æœã€çš„ã€‚</p>
<h3 id="ç®¡ç†çš„ç›®çš„æ˜¯ä¸ºäº†æå‡æ•ˆç‡"><a href="#ç®¡ç†çš„ç›®çš„æ˜¯ä¸ºäº†æå‡æ•ˆç‡" class="headerlink" title="ç®¡ç†çš„ç›®çš„æ˜¯ä¸ºäº†æå‡æ•ˆç‡"></a>ç®¡ç†çš„ç›®çš„æ˜¯ä¸ºäº†æå‡æ•ˆç‡</h3><p>ç®¡ç†æœ€ç»ˆæ˜¯æœåŠ¡äºã€Œä¼ä¸šç»è¥ã€çš„ï¼Œè€Œä¸ºäº†å®ç°ä¼ä¸šç»è¥ï¼Œæ˜¯é€šè¿‡ä¸æ–­æå‡ã€Œæ•ˆç‡ã€æ¥è¾¾æˆã€‚ä»ç®¡ç†å­¦å†å²çš„è§’åº¦æ¥çœ‹ï¼Œç®¡ç†å­¦çš„æ¼”å˜è¢«é™ˆæ˜¥èŠ±è€å¸ˆåˆ†ä¸ºäº†ä¸‰ä¸ªé˜¶æ®µã€‚</p>
<p><strong>ç¬¬ä¸€é˜¶æ®µï¼Œç§‘å­¦ç®¡ç†é˜¶æ®µ</strong>ï¼Œè¿™ä¸ªé˜¶æ®µè¦è§£å†³çš„é—®é¢˜æ˜¯ã€ŒåŠ³åŠ¨æ•ˆç‡æœ€å¤§åŒ–ã€ã€‚è€Œä½¿åŠ³åŠ¨æ•ˆç‡æœ€å¤§åŒ–çš„æ‰‹æ®µå°±æ˜¯ã€Œåˆ†å·¥ã€ï¼Œå®ƒæœ‰å››æ¡åŸç†ï¼š</p>
<ol>
<li>ç§‘å­¦åˆ’åˆ†å·¥ä½œå…ƒç´ </li>
<li>å‘˜å·¥é€‰æ‹©ã€åŸ¹è®­å’Œå¼€å‘</li>
<li>ä¸å‘˜å·¥ç»å¸¸æ²Ÿé€š</li>
<li>ç®¡ç†è€…ä¸å‘˜å·¥åº”æœ‰å¹³ç­‰çš„å·¥ä½œå’Œè´£ä»»èŒƒå›´</li>
</ol>
<p><strong>ç¬¬äºŒé˜¶æ®µï¼Œè¡Œæ”¿ç»„ç»‡ç®¡ç†é˜¶æ®µ</strong>ï¼Œè¿™ä¸ªé˜¶æ®µè¦è§£å†³çš„é—®é¢˜æ˜¯ã€Œç»„ç»‡æ•ˆç‡æœ€å¤§åŒ–ã€ï¼Œå…¶ä¸­æœ€é‡è¦çš„æ‰‹æ®µæ˜¯ã€Œä¸“ä¸šåŒ–æ°´å¹³å’Œç­‰çº§åˆ¶åº¦çš„ç»“åˆã€ã€‚<br>ä¸“ä¸šåŒ–æ°´å¹³ï¼ŒæŒ‡çš„æ˜¯éœ€è¦å¼ºåŒ–å„å²—ä½çš„ä¸“ä¸šåŒ–èƒ½åŠ›ï¼Œæ— è®ºæ˜¯å¼€å‘ã€äº§å“ã€é”€å”®ã€é¢†å¯¼è€…ã€ç®¡ç†è€…ï¼Œéƒ½éœ€è¦å…·å¤‡å²—ä½ç‹¬ç‰¹çš„ä¸“ä¸šèƒ½åŠ›ã€‚åªæœ‰è®©å„å²—ä½è´¡çŒ®äº†ä¸“ä¸šåŒ–çš„æ°´å¹³ï¼Œæ‰ç®—æ˜¯èƒœä»»äº†ç®¡ç†å·¥ä½œã€‚<br>è€Œåˆ†æƒåˆ†è´£çš„ç­‰çº§åˆ¶åº¦ï¼Œèƒ½å¤Ÿæ˜¯èŒä½å’ŒæƒåŠ›ä¸¤è€…åˆä¸ºä¸€ä½“ï¼Œåœ¨è¿™ä¸ªåŸºç¡€ä¸Šï¼Œç®¡ç†çš„æ•ˆèƒ½æ‰ä¼šæœ‰æ•ˆå‘æŒ¥ã€‚</p>
<p><strong>ç¬¬ä¸‰é˜¶æ®µï¼ŒäººåŠ›èµ„æºç®¡ç†é˜¶æ®µ</strong>ï¼Œè¿™ä¸ªé˜¶æ®µè¦è§£å†³çš„é—®é¢˜æ˜¯ã€Œä¸ªäººæ•ˆç‡æœ€å¤§åŒ–ã€ï¼Œå…¶ä¸­é‡è¦çš„æ‰‹æ®µæ˜¯ã€Œä¸ªäººåˆ›é€ ç»„ç»‡ç¯å¢ƒï¼Œæ»¡è¶³éœ€æ±‚ï¼ŒæŒ–æ˜æ½œåŠ›ã€ã€‚<br>ç®¡ç†è€…å…¶å®å°±æ˜¯ä¸€ä¸ªå¾®å‹çš„äººåŠ›èµ„æºéƒ¨ï¼Œè€Œä¸ä»…ä»…å…³å¿ƒäº‹åŠ¡æ€§çš„äº‹æƒ…ã€‚è¿™æ˜¯è§’è‰²è½¬å˜å¾ˆé‡è¦çš„ä¸€ä¸ªè§‚å¿µã€‚ç®¡ç†è€…ä¹Ÿéœ€è¦æ›´å¤šå…³æ³¨äººï¼Œå…³æ³¨æˆå‘˜çš„ç›®æ ‡ä¸ç»„ç»‡ç›®æ ‡çš„ä¸€è‡´æ€§ã€‚<br>æ¿€åŠ±è¦ä»¥å›¢é˜Ÿç²¾ç¥ä¸ºå¯¼å‘ï¼Œä¸ªäººæˆæœè¦è·Ÿå›¢é˜ŸæŒ‚é’©ï¼Œå›¢é˜Ÿçš„æˆæœè¦è·Ÿä¸šåŠ¡æŒ‚é’©ã€‚åœ¨è¿™æ–¹é¢ï¼Œæˆ‘æƒ³åˆ°äº†æœ‰èµå¹´ç»ˆå¥–çš„åˆ†é…é€»è¾‘ä¸Šï¼Œä¸ªäººç»©æ•ˆéœ€è¦ä¹˜ä»¥å›¢é˜Ÿç»©æ•ˆç³»æ•°ã€‚è¿™å°±æŠŠå‘˜å·¥éœ€æ±‚å’Œç»„ç»‡å‘å±•çš„ç›®æ ‡è¿æ¥åœ¨ä¸€èµ·ã€‚</p>
<p>ç»¼ä¸Šï¼Œç®¡ç†å®ç°æ•ˆç‡ï¼Œå°±æ˜¯å®ç°ã€ŒåŠ³åŠ¨æ•ˆç‡ã€ã€ã€Œç»„ç»‡æ•ˆç‡ã€ã€ã€Œä¸ªäººæ•ˆç‡ã€ï¼Œå¹¶ä¸”å®ƒä»¬çš„å¾ªåºæ˜¯éœ€è¦ä¸æ–­é€’è¿›çš„è¿‡ç¨‹ã€‚</p>
<h3 id="ç®¡ç†æ˜¯ä¸€ç§åˆ†é…"><a href="#ç®¡ç†æ˜¯ä¸€ç§åˆ†é…" class="headerlink" title="ç®¡ç†æ˜¯ä¸€ç§åˆ†é…"></a>ç®¡ç†æ˜¯ä¸€ç§åˆ†é…</h3><p>ç®¡ç†å…¶å®å°±æ˜¯å¯¹äºã€ŒèŒè´£ã€ã€ã€ŒæƒåŠ›ã€ã€ã€Œåˆ©ç›Šã€çš„åˆ†é…ã€‚<br>è¿™æ˜¯ä¸€ä¸ªèƒ½æ”¹å˜æˆ‘è®¤çŸ¥çš„ä¸€ä¸ªç†è§£æ–¹å¼ã€‚<br>æŠŠèŒè´£åˆ†é…ä¸‹å»ï¼Œè®©æ¯ä¸€ä¸ªæˆå‘˜æ‰¿æ‹…èµ·è´£ä»»ï¼Œå¹¶ä¸”å†ç»™äºˆå’Œè´£ä»»ç›¸é€‚åº”çš„èµ„æºå’ŒæƒåŠ›ï¼Œç®¡ç†çš„æ•ˆèƒ½å°±ä¼šå‘æŒ¥å‡ºæ¥ã€‚<br>æœ€ç†æƒ³çš„æƒ…å†µä¸‹ï¼Œå°±æ˜¯ä¸‰è€…éƒ½èƒ½ç­‰åˆ†ï¼Œå½¢æˆä¸€ä¸ªé“ä¸‰è§’å‹ã€‚<br>ä½†æ˜¯ç°å®æƒ…å†µå¾€å¾€å¾ˆéš¾åšåˆ°ï¼Œè™½ç„¶å¦‚æ­¤ï¼Œä¹Ÿè¦æœ‰æ„è¯†åœ°å»æ³¨æ„è¿™ä¸ªé—®é¢˜ã€‚</p>
<h3 id="ã€Œä¼ ç»Ÿç®¡ç†è€…ã€ä¸ã€Œæœ‰æ•ˆç®¡ç†è€…ã€"><a href="#ã€Œä¼ ç»Ÿç®¡ç†è€…ã€ä¸ã€Œæœ‰æ•ˆç®¡ç†è€…ã€" class="headerlink" title="ã€Œä¼ ç»Ÿç®¡ç†è€…ã€ä¸ã€Œæœ‰æ•ˆç®¡ç†è€…ã€"></a>ã€Œä¼ ç»Ÿç®¡ç†è€…ã€ä¸ã€Œæœ‰æ•ˆç®¡ç†è€…ã€</h3><p>åœ¨å¾·é²å…‹å…ˆç”Ÿçš„è§‚ç‚¹ä¸‹ï¼Œå¯¹ç®¡ç†è€…åˆ†äº†ä¸¤ç±»ï¼Œã€Œä¼ ç»Ÿç®¡ç†è€…ã€å’Œã€Œæœ‰æ•ˆç®¡ç†è€…ã€ã€‚</p>
<p>ä¼ ç»Ÿç®¡ç†è€…å‡ ä¸ªç‰¹å¾ï¼š</p>
<ol>
<li>ä¸“æ³¨äºç¹çäº‹åŠ¡ï¼Œæ—¶é—´å±äºåˆ«äºº</li>
<li>å±è‚¡æŒ‡æŒ¥è„‘è¢‹ï¼Œåªä»æ‰€åœ¨å²—ä½çš„è§†è§’çœ‹é—®é¢˜</li>
<li>å¿½ç•¥äº†å¯¹äººçš„åŸ¹å…»</li>
</ol>
<p>æœ‰æ•ˆç®¡ç†è€…çš„å‡ ä¸ªç‰¹å¾ï¼š</p>
<ol>
<li>è¿›è¡Œæ—¶é—´ç®¡ç†ï¼Œæ˜ç¡®çš„ä¼˜å…ˆçº§ï¼Œæ‰€æœ‰äº‹æƒ…éƒ½æœ‰åºå’Œåˆç†</li>
<li>ç³»ç»Ÿæ€§æ€è€ƒï¼Œè®¤è¯†åˆ°æ•´ä½“ä¸å±€éƒ¨çš„å…³ç³»</li>
<li>åŸ¹å…»äºº</li>
</ol>
<p>çœ‹ç€è¿™ä¸¤ä¸ªåˆ†ç±»ï¼Œæ„Ÿè§¦è‰¯å¤šã€‚<br>å›æƒ³ 2018 ä¸ŠåŠå¹´ï¼Œåˆšæˆä¸º TLï¼Œè§’è‰²è½¬å˜ã€‚å½“æ—¶å®é™…æœ€ç´§è¿«çš„ä»»åŠ¡æ˜¯æ‹›äººï¼Œè€Œæˆ‘è‡ªèº«è¿˜æ˜¯æ·±é™·äºä¸šåŠ¡éœ€æ±‚ä¸­ã€‚åæ¥åçœï¼Œå°½ç®¡ä¸šåŠ¡éœ€æ±‚å¾ˆç´§æ€¥ï¼Œä½†æ˜¯åœ¨è¿™ä¸ªä½ç½®ä¸Šï¼Œåº”å½“åšæ›´åŠ é‡è¦çš„äº‹æƒ…ã€‚è¿™æ˜¯å½“æ—¶åšçš„å¾ˆä¸å¥½çš„åœ°æ–¹ã€‚<br>è€Œ 2018 ä¸‹åŠå¹´ï¼Œæ–°æˆå‘˜çš„åŠ å…¥ï¼Œè®©æˆ‘èƒ½å¤Ÿç¨å¾®è„±ç¦»ç»†èŠ‚ï¼Œæ›´æ³¨é‡åŸ¹å…»äººï¼Œåæ¥å›¢é˜Ÿèƒ½è¾“å‡ºä¸é”™çš„å°ä¼™ä¼´ï¼Œè¿˜æ˜¯å¾ˆæ¬£æ…°çš„ã€‚<br>è€Œç°åœ¨ï¼Œæˆ‘éœ€è¦æ›´å¤šçš„å…³æ³¨åœ¨ç³»ç»Ÿæ€§æ€è€ƒä¸Šï¼Œè·³å‡ºå²—ä½ï¼Œè·³å‡ºèŒä¸šè§†è§’ï¼Œè®¤è¯†åˆ°æ•´ä½“å’Œå±€éƒ¨ï¼Œè¿™ä¸æ˜¯ä¸ªçŸ­æœŸå†…å®¹æ˜“æå‡çš„äº‹æƒ…ã€‚</p>
<h2 id="å…³äºæ¿€åŠ±"><a href="#å…³äºæ¿€åŠ±" class="headerlink" title="å…³äºæ¿€åŠ±"></a>å…³äºæ¿€åŠ±</h2><p>æˆ‘ä¸€ç›´è®¤ä¸ºçš„ä¸€ä¸ªè§‚å¿µï¼Œå¤§å®¶ä¹‹æ‰€ä»¥æ¥è¿™é‡Œå·¥ä½œï¼Œæ˜¯æœ‰ä¸ªäººéœ€æ±‚çš„ã€‚å¯èƒ½æ˜¯ä¸€ä»½è–ªæ°´ï¼Œå¯èƒ½æ˜¯è¿›æ­¥ï¼Œå‘å±•ï¼Œå’Œå®ç°ä¸ªäººä»·å€¼ã€‚è¿™é‡Œè¦å›ç­”çš„ä¸€ä¸ªé—®é¢˜æ˜¯ï¼šã€Œäººä»¬ä¸ºä»€ä¹ˆå·¥ä½œã€<br>ä¼ä¸šå’Œä¸ªäººæ˜¯ä¸€ä¸ªåŒå‘é€‰æ‹©è¿‡ç¨‹ï¼Œå„å–æ‰€éœ€ï¼Œå„å¸å…¶èŒï¼ŒåŒæ–¹éƒ½ä¼šå…³å¿ƒæŠ•å…¥äº§å‡ºæ¯”ã€‚<br>æ‰€ä»¥ï¼Œå…³äºå¦‚ä½•ææ¸…å¯¹æ–¹éœ€æ±‚ï¼Œç»™äºˆæ¿€åŠ±ï¼Œæé«˜ç»©æ•ˆã€‚è¿™æ–¹é¢æˆ‘ä¼šæ›´æƒ³æ‰¾åˆ°ç­”æ¡ˆã€‚</p>
<h3 id="æ¿€åŠ±çš„ä¸¤ä¸ªè§’åº¦"><a href="#æ¿€åŠ±çš„ä¸¤ä¸ªè§’åº¦" class="headerlink" title="æ¿€åŠ±çš„ä¸¤ä¸ªè§’åº¦"></a>æ¿€åŠ±çš„ä¸¤ä¸ªè§’åº¦</h3><p>å¯¹äºæ¿€åŠ±æœ‰ä¸¤ä¸ªæ ¸å¿ƒçš„æ€è€ƒè§’åº¦ã€‚<br>ç¬¬ä¸€ä¸ªï¼Œæ˜¯æƒ³åŠæ³•è®©å·¥ä½œå˜æˆæ¸¸æˆï¼Œè®©äººä»ä¸­è·å–æ›´å¤šå¿«ä¹ï¼Œè¿™å°±è·Ÿæœ‰èµå¼ºè°ƒçš„ Enjoy å¾ˆåˆ‡åˆäº†ã€‚<br>ç¬¬äºŒä¸ªï¼Œæ˜¯æ°¸è¿œç«™åœ¨å¯¹æ–¹çš„è§’åº¦æ¥æ€è€ƒï¼Œç†è§£å¯¹æ–¹çš„è¿°æ±‚ã€‚</p>
<h3 id="ã€Œä¿å¥å› ç´ ã€ä¸ã€Œæ¿€åŠ±å› ç´ ã€"><a href="#ã€Œä¿å¥å› ç´ ã€ä¸ã€Œæ¿€åŠ±å› ç´ ã€" class="headerlink" title="ã€Œä¿å¥å› ç´ ã€ä¸ã€Œæ¿€åŠ±å› ç´ ã€"></a>ã€Œä¿å¥å› ç´ ã€ä¸ã€Œæ¿€åŠ±å› ç´ ã€</h3><p>åœ¨ä¼—å¤šçš„å¸¸è§æ¿€åŠ±æ‰‹æ®µä¸­ï¼Œé™ˆæ˜¥èŠ±æŠŠå®ƒä»¬åˆ†äº†ä¸¤ç±»ï¼šã€Œä¿å¥å› ç´ ã€å’Œã€Œæ¿€åŠ±å› ç´ ã€ã€‚<br>ä¾‹å¦‚ï¼Œ</p>
<ul>
<li>ä¿å¥å› ç´ ï¼šå·¥èµ„ã€å²—ä½ï¼ŒåŸ¹è®­ã€ç¦åˆ©ã€å·¥ä½œè®¾å¤‡ç­‰ã€‚</li>
<li>æ¿€åŠ±å› ç´ ï¼šæ™‹å‡ã€å¥–é‡‘ã€ä»·å€¼çš„è‚¯å®šã€é¢å¤–çš„å·¥ä½œæ¡ä»¶ç­‰ã€‚</li>
</ul>
<p>ä¿å¥å› ç´ ï¼Œæ˜¯ä¸€ä¸ªäººå·¥ä½œçš„æœ€åŸºæœ¬ï¼Œæœ€å¿…é¡»çš„æ¡ä»¶ï¼Œå¦‚æœç¼ºä¹ä¿å¥å› ç´ çš„è¯ï¼Œå°±ä¼šå¼•èµ·ä¸æ»¡ã€‚å¦å¤–ä¸€ä¸ªç‰¹ç‚¹æ˜¯ï¼Œå¤§éƒ¨åˆ†äººéƒ½æœ‰çš„ï¼Œä¸å…·æœ‰ç‹¬ç‰¹æ€§çš„ã€‚</p>
<p>æ¿€åŠ±å› ç´ ï¼Œæ˜¯ä¸€ä¸ªäººåšå¥½å·¥ä½œæ‰€éœ€è¦çš„æ¡ä»¶ï¼Œä»–èƒ½å¤Ÿå¸¦æ¥æ»¡è¶³æ„Ÿï¼Œèƒ½å¤Ÿæ¿€èµ·äººçš„æ¬²æœ›å’Œæ½œåŠ›çš„ã€‚å¦å¤–ä¸€ä¸ªç‰¹ç‚¹æ˜¯ï¼Œå°‘éƒ¨åˆ†æœ‰çš„ï¼Œéœ€è¦è¸®è„šæ‹¿åˆ°çš„ã€‚</p>
<p>æ‰€ä»¥ï¼Œä¸åŒæ¿€åŠ±ä¸æ„Ÿå—çš„å…³ç³»æ˜¯ï¼Œä¿å¥å› ç´  â†’ é™ä½ä¸æ»¡ï¼Œæ¿€åŠ±å› ç´  â†’ æå‡æ»¡è¶³æ„Ÿã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ¿€åŠ±å› ç´ æ˜¯æœ‰å¯èƒ½å˜æˆä¿å¥å› ç´ çš„ã€‚ä¾‹å¦‚ç°åœ¨å¤§éƒ¨åˆ†å…¬å¸éƒ½å‘å¹´ç»ˆå¥–ï¼Œå¹¶ä¸”äººäººéƒ½æœ‰ï¼ŒHR è°ˆè–ªèµ„çš„æ—¶å€™ï¼Œä¹Ÿä¼šç”¨å¹´è–ªçš„æ¦‚å¿µæŠŠå¹´ç»ˆå¥–ç®—è¿›æ”¶å…¥é‡Œé¢ï¼Œä½œä¸ºä¸€ä¸ª packageã€‚é‚£ä¹ˆå¹´ç»ˆå¥–ï¼Œå°±å˜æˆäº†ä¿å¥å› ç´ äº†ã€‚ä¸€æ—¦å…¬å¸å¹´åº•å‘ä¸å‡ºå¹´ç»ˆå¥–ï¼Œæˆ–è€…ä¸åŠé¢„æœŸï¼Œé‚£å°±ä¼šå¼•èµ·ä¸æ»¡ã€‚</p>
<h3 id="ã€Œæ¿€åŠ±ã€ä¸ã€Œç»©æ•ˆã€"><a href="#ã€Œæ¿€åŠ±ã€ä¸ã€Œç»©æ•ˆã€" class="headerlink" title="ã€Œæ¿€åŠ±ã€ä¸ã€Œç»©æ•ˆã€"></a>ã€Œæ¿€åŠ±ã€ä¸ã€Œç»©æ•ˆã€</h3><p>æ—¶åˆ»ä¸èƒ½å¿˜çš„æ˜¯ï¼Œç®¡ç†æœ€ç»ˆæ˜¯æœåŠ¡äºä¼ä¸šç»è¥çš„ã€‚æ¿€åŠ±æ˜¯é‡è¦çš„ç®¡ç†æ‰‹æ®µï¼Œæœ€ç»ˆä¹Ÿæ˜¯è¦ä¸ºç»©æ•ˆè´Ÿè´£çš„ã€‚ã€Œæ¿€åŠ±ã€å’Œã€Œç»©æ•ˆã€çš„å…³ç³»ï¼Œæœ‰äº›è¦æ³¨æ„çš„ã€‚</p>
<p><strong> æ»¡è¶³æ„Ÿå¹¶ä¸ä¸€å®šå¸¦æ¥é«˜ç»©æ•ˆ </strong><br>åœ¨æ»¡è¶³å‘˜å·¥çš„éœ€æ±‚ï¼Œè®©å‘˜å·¥è·å¾—æ»¡è¶³æ„Ÿçš„åŸºç¡€ä¸‹ï¼Œä¸€å®šè¦ï¼š<strong>ã€Œè®©å‘˜å·¥çš„æ»¡è¶³æ„Ÿæ¥æºäºå·¥ä½œæœ¬èº«è€Œä¸æ˜¯ä¸ªäººéœ€æ±‚ã€</strong></p>
<p>å› ä¸ºäººä»¬çš„éœ€æ±‚æ˜¯å¾ˆä¸ªäººåŒ–çš„ï¼Œä¾‹å¦‚æœ‰çš„äººéœ€æ±‚æ˜¯å·¥ä½œç¯å¢ƒï¼Œè€Œä¸æ˜¯å·¥ä½œä¸­è·å¾—ç»©æ•ˆã€‚é‚£ä¹ˆå½“å·¥ä½œç¯å¢ƒå¾ˆå¥½çš„æ—¶å€™ï¼Œå¯¼è‡´å‘˜å·¥å¾ˆæœ‰æ»¡è¶³æ„Ÿï¼Œä½†æ˜¯ä»–å¹¶ä¸å…³å¿ƒå·¥ä½œæœ¬èº«ã€‚</p>
<p><strong>æ¿€åŠ±æœ‰æ—¶å€™ä¸ä¼šå‘æŒ¥ä½œç”¨</strong><br>æœ‰äº›æƒ…å†µä¸‹ï¼Œä¸ç®¡é‡‡ç”¨ä½•ç§æ¿€åŠ±æªæ–½ï¼Œéƒ½æ— æ³•è¾¾åˆ°æ•ˆæœï¼š</p>
<ol>
<li>å·¥ä½œé‡è¶…é‡æ‰€é€ æˆçš„ç–²æƒ«</li>
<li>è§’è‰²ä¸æ¸…ï¼Œä»»åŠ¡å†²çª</li>
<li>ä¸å…¬å¹³å¾…é‡</li>
</ol>
<p>åœ¨è¿™ä¸‰ç§æƒ…å†µä¸‹ï¼Œæ›´åº”è¯¥åˆ‡å®çš„æ”¹å˜äººä»¬æ‰€å¤„çš„çŠ¶æ€ï¼Œåˆç†çš„å·¥ä½œé‡è®¾è®¡ã€æ¸…æ™°çš„è´£æƒåˆ©ã€å…¬å¹³çš„å¾…é‡ã€‚åœ¨è¿™ä¸ªåŸºç¡€ä¹‹ä¸Šï¼Œé€šè¿‡æœ‰æ•ˆçš„æ¿€åŠ±æªæ–½ï¼Œæ‰èƒ½è·å¾—é«˜çš„å·¥ä½œç»©æ•ˆã€‚</p>
<h3 id="æœŸæœ›ç†è®º"><a href="#æœŸæœ›ç†è®º" class="headerlink" title="æœŸæœ›ç†è®º"></a>æœŸæœ›ç†è®º</h3><p>ã€Œäººä¼šæˆä¸ºä»–æ‰€æœŸæœ›çš„æ ·å­ã€è¿™æ˜¯ä¸€å¥å¤§å®è¯ï¼Œäººçš„è¿›æ­¥éƒ½æºäºæœŸæœ›ï¼Œä¹Ÿè®¸æ¥è‡ªäºä»–äººï¼Œä¹Ÿè®¸æ¥è‡ªäºè‡ªèº«ã€‚<br>æœŸæœ›ç†è®ºæœ‰ä¸‰ä¸ªåŸºæœ¬æ¡ä»¶ï¼š</p>
<ol>
<li>æœŸæœ›ä»·ï¼Œè¿™ä¸ªç›®æ ‡éœ€è¦èƒ½å¤Ÿå®ç°çš„ï¼Œå¦‚æœå¤ªé«˜å°±æ²¡æœ‰å¯è¡Œæ€§ã€‚</li>
<li>åª’ä»‹ï¼Œä¸»è¦æ˜¯è¦è·å–ä¿¡ä»»æ„Ÿï¼Œç›¸ä¿¡ç»“æœæ˜¯å¯è·å¾—çš„ï¼Œè·Ÿç›®æ ‡æ˜¯ä¸€è‡´çš„ã€‚</li>
<li>æ‰¿è¯ºä¼šå…‘ç°ï¼Œä¸ç®¡å¤šå°‘äººè¾¾æˆæœŸæœ›ï¼Œéƒ½ä¸€å®šè¦èƒ½å®ç°å½“åˆçš„æ‰¿è¯ºã€‚</li>
</ol>
<p>æœŸæœ›ç†è®ºæ»¡è¶³è¿™ä¸‰ä¸ªåŸºæœ¬æ¡ä»¶ï¼Œæ‰èƒ½çœŸæ­£è¾¾åˆ°æ•ˆæœï¼Œæ¿€åŠ±äººä»¬å‘æ›´é«˜çš„æœŸæœ›åŠªåŠ›ã€‚</p>
<h3 id="å½“ä¸‹æˆ‘æ›´å¤šå¯ä»¥åšçš„æ¿€åŠ±åŠ¨ä½œ"><a href="#å½“ä¸‹æˆ‘æ›´å¤šå¯ä»¥åšçš„æ¿€åŠ±åŠ¨ä½œ" class="headerlink" title="å½“ä¸‹æˆ‘æ›´å¤šå¯ä»¥åšçš„æ¿€åŠ±åŠ¨ä½œ"></a>å½“ä¸‹æˆ‘æ›´å¤šå¯ä»¥åšçš„æ¿€åŠ±åŠ¨ä½œ</h3><p>æˆæœ¬æœ€ä½çš„è€Œä¸”æœ€æœ‰æ•ˆçš„æ¿€åŠ±æªæ–½ï¼Œä¹Ÿå°±æ˜¯æ€§ä»·æ¯”æœ€é«˜çš„æ¿€åŠ±æªæ–½ï¼šé¼“æŒã€èµç¾ã€é²œèŠ±ã€éš†é‡çš„ä»ªå¼ã€æˆæƒä¸ä¿¡ä»»ã€‚</p>
<p>å‰ä¸‰è€…ï¼ˆé¼“æŒã€èµç¾ã€é²œèŠ±ï¼‰ï¼Œæˆ‘å½’çº³ä¸ºå¯¹ä»˜å‡ºçš„è‚¯å®šï¼Œé‚£ä¹ˆå°±å½’ç±»ä¸ºï¼š</p>
<ol>
<li>è‚¯å®šï¼ˆé¼“æŒã€èµç¾ã€é²œèŠ±ï¼‰</li>
<li>ä»ªå¼æ„Ÿ</li>
<li>æˆæƒä¸ä¿¡ä»»</li>
</ol>
<p>å¯¹äººä»¬çš„ç»“æœï¼Œè¦åŠæ—¶çš„ç»™äºˆè‚¯å®šï¼Œè®©ä»–ä»¬çŸ¥é“æœ‰äººçœ‹å¾—åˆ°ï¼Œå¹¶ä¸”å¾—åˆ°æ¬£èµï¼Œè¿™ä¹Ÿæ˜¯äººç±»æœ€åŸºæœ¬çš„ç¤¾ä¼šè¿°æ±‚ã€‚<br>åœ¨é‡è¦çš„äº‹æƒ…ä¸Šï¼Œè¦æœ‰ä¸€å®šçš„ä»ªå¼æ„Ÿï¼Œä¾‹å¦‚ä¸€ä¸ªé¡¹ç›®çš„å»ºç«‹ï¼Œä¸€ä¸ªå›¢é˜Ÿçš„å»ºç«‹ï¼Œä¸€ä»¶é‡è¦äº‹æƒ…çš„è¾¾æˆç­‰ç­‰ã€‚<br>å°¤å…¶é‡è¦çš„æ˜¯æˆæƒä¸ä¿¡ä»»ï¼Œè¿™ä¸ªæˆ‘å›æƒ³èµ·ä¸¤å¹´å‰åˆæ¥æœ‰èµçš„æ—¶å€™ï¼Œè·Ÿå‰å¸å¾ˆå¤§ä¸åŒçš„æ˜¯ï¼Œèƒ½å¾—åˆ°å¾ˆå¥½çš„æˆæƒä¸ä¿¡ä»»ï¼Œä»¥åŠè¶³å¤Ÿçš„è‡ªç”±å’Œå‘æŒ¥ç©ºé—´ã€‚</p>
<h2 id="æœ€å"><a href="#æœ€å" class="headerlink" title="æœ€å"></a>æœ€å</h2><p>ã€Šç®¡ç†çš„å¸¸è¯†ã€‹è¿™æœ¬ä¹¦ï¼Œåœ¨ç‰©ç†ç©ºé—´ä¸Šï¼Œå®ƒå¾ˆè–„ã€‚ä½†è¿™ä¸å¦¨ç¢å®ƒèƒ½å›Šæ‹¬å¾ˆå¼ºå¤§çš„å†…å®¹ï¼Œè¿™äº›å†…å®¹å¾ˆé€‚åˆç»†ç»†å“è¯»ä¸æ„Ÿæ‚Ÿã€‚ä¹Ÿå¾ˆåº†å¹¸åœ¨è¿™ä¸ªæ—¶é—´é‡åˆ°ä¸€æœ¬å¥½ä¹¦ï¼Œè®©è‡ªå·±é‡æ–°æ€»ç»“å’Œå®¡è§†è¿‡å»çš„ç»éªŒå’Œè§è¯†ã€‚<br>å¦å¤–ï¼Œæ ‡é¢˜åŠ äº†ä¸ªã€Œä¸€ã€ï¼Œæ˜¯ä¸ºäº†ç«‹ä¸ª Flagï¼Œè®©æˆ‘ç»§ç»­è¯»å®Œè¿™æœ¬ä¹¦ï¼Œç„¶åå†å†™ä¸€ç¯‡å¿ƒå¾—ã€‚<br>æœ€åï¼Œç®¡ç†ï¼Œç¡®å®æ˜¯ä¸€é—¨ç§‘å­¦ï¼Œä¹Ÿæ˜¯ä¸€é—¨è‰ºæœ¯ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;ã€Šç®¡ç†çš„å¸¸è¯†ã€‹è¯»åæ„Ÿ-ã€Œä¸€ã€&quot;&gt;&lt;a href=&quot;#ã€Šç®¡ç†çš„å¸¸è¯†ã€‹è¯»åæ„Ÿ-ã€Œä¸€ã€&quot; class=&quot;headerlink&quot; title=&quot;ã€Šç®¡ç†çš„å¸¸è¯†ã€‹è¯»åæ„Ÿ ã€Œä¸€ã€&quot;&gt;&lt;/a&gt;ã€Šç®¡ç†çš„å¸¸è¯†ã€‹è¯»åæ„Ÿ ã€Œä¸€ã€&lt;/h1&gt;&lt;p&gt;é™ˆæ˜¥èŠ±çš„ã€Šç®¡ç†çš„å¸¸è¯†ã€‹æ˜¯ä¸€æœ¬ç›¸è§æ¨æ™šçš„ä¹¦ã€‚åœ¨
    
    </summary>
    
      <category term="ä¸‰çœå¾èº«" scheme="http://huang-jerryc.com/categories/%E4%B8%89%E7%9C%81%E5%90%BE%E8%BA%AB/"/>
    
    
  </entry>
  
  <entry>
    <title>åŸæ±åŸå‘³çš„é…æ–¹:ã€Œå¾®ä¿¡å°ç¨‹åºæ”¯æŒ NPMã€</title>
    <link href="http://huang-jerryc.com/2018/05/02/use-npm-in-weapp/"/>
    <id>http://huang-jerryc.com/2018/05/02/use-npm-in-weapp/</id>
    <published>2018-05-01T16:07:00.000Z</published>
    <updated>2019-07-07T10:28:45.723Z</updated>
    
    <content type="html"><![CDATA[<p>å¾®ä¿¡å°ç¨‹åºæœ¬èº«ä¸æ”¯æŒ npm åŒ…çš„ä½¿ç”¨ï¼Œç›®å‰å¸‚é¢ä¸Šå¾ˆå¤šæ¡†æ¶ä¹Ÿæœ‰äº†ç›¸å¯¹åº”çš„è§£å†³æ–¹æ¡ˆã€‚</p>
<p>æœ¬æ–‡æ—¨åœ¨ä¸ºé‚£äº›ä¸æ„¿æ„å¼•å…¥ç¬¬ä¸‰æ–¹æ¡†æ¶ï¼Œ æƒ³åœ¨å°ç¨‹åºç¯å¢ƒä¸­å†™åŸæ±åŸå‘³ä»£ç çš„äººï¼ˆä¾‹å¦‚æˆ‘ï¼‰ï¼Œæä¾›ä¸€ç§è§£å†³é—®é¢˜çš„æ€è·¯ã€‚</p>
<p>åœ¨ç°ä»£çš„ Web å¼€å‘ä¸­ï¼Œæˆ‘ä»¬å¯¹ Webpack å·²ç»å†ç†Ÿæ‚‰ä¸è¿‡äº†ï¼Œç®€å•ç†è§£ï¼Œå®ƒå°±æ˜¯é¡¹ç›®å‘å¸ƒä¹‹å‰ï¼ŒæŠŠæ‰€æœ‰èµ„æºéƒ½æ‰“åŒ…å¥½ï¼Œç„¶åæä¾›ä¸€ä¸ªå…¥å£æ–‡ä»¶ï¼Œåœ¨å…¥å£æ¨¡æ¿ä¸­å¼•å…¥è¿™ä¸ªå…¥å£æ–‡ä»¶ã€‚</p>
<p>é‚£ä¹ˆæˆ‘çš„æ€è·¯ï¼Œå°±æ˜¯åˆ©ç”¨ Webpack æŠŠæˆ‘ä»¬æ‰€æœ‰çš„ npm ä¾èµ–æ‰“åŒ…å¥½ï¼Œæä¾›ä¸€ä¸ªå…¥å£æ–‡ä»¶ï¼Œåœ¨å°ç¨‹åºå¼€å‘ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡è¿™ä¸ªå…¥å£æ–‡ä»¶ï¼Œè¿›è€Œä½¿ç”¨ npm çš„ä¾èµ–ã€‚</p>
<p><img src="https://raw.githubusercontent.com/JerryC8080/figure-bed/master/img/20190707181936" alt=""></p>
<p>æˆ‘ä»¬æœ€ç»ˆå®ç°çš„æ•ˆæœåº”è¯¥æ˜¯è¿™æ ·çš„ã€‚</p>
<p>ä¾‹å¦‚æˆ‘ä»¬å°ç¨‹åºçš„é¦–é¡µä¸­ï¼Œéœ€è¦ä½¿ç”¨åˆ° <code>moment</code></p>
<p>pages/home/home.jsï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> &#123; moment &#125; <span class="built_in">require</span>(<span class="string">'../npm/index'</span>);</div><div class="line"><span class="keyword">const</span> time = moment();</div></pre></td></tr></table></figure>
<h1 id="Webpack-æ‰“åŒ…-npm-ä¾èµ–"><a href="#Webpack-æ‰“åŒ…-npm-ä¾èµ–" class="headerlink" title="Webpack æ‰“åŒ… npm ä¾èµ–"></a>Webpack æ‰“åŒ… npm ä¾èµ–</h1><p>webpack é»˜è®¤è¾“å‡ºçš„ <code>bundle.js</code> ï¼Œæ˜¯ä¸€ä¸ªç«‹å³æ‰§è¡Œçš„é—­åŒ…ï¼Œå¦‚ä»¥ä¸‹ï¼š</p>
<p>ä½¿ç”¨ webpack.config.js é…ç½®ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</div><div class="line"></div><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">  <span class="attr">entry</span>: <span class="string">'./foo.js'</span>,</div><div class="line">  <span class="attr">output</span>: &#123;</div><div class="line">    <span class="attr">path</span>: path.resolve(__dirname, <span class="string">'dist'</span>),</div><div class="line">    <span class="attr">filename</span>: <span class="string">'bundle.js'</span></div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>è¿è¡Œ <code>$ webpack</code> ç”Ÿæˆçš„ <code>bundle.js</code> :</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">(<span class="function"><span class="keyword">function</span>(<span class="params">modules</span>) </span>&#123; </div><div class="line"></div><div class="line">  <span class="comment">// webpackBootstrap</span></div><div class="line"></div><div class="line">&#125;)([module1, module2, module3]);</div></pre></td></tr></table></figure>
<blockquote>
<p>ç¤ºä¾‹ä»£ç ï¼š<a href="https://github.com/JerryC8080/use-npm-in-weapp/tree/master/step1" target="_blank" rel="external">https://github.com/JerryC8080/use-npm-in-weapp/tree/master/step1</a></p>
</blockquote>
<p>è¿™æ ·çš„ä»£ç ï¼Œæ˜¾ç„¶æ²¡æ³•è¾¾åˆ°æˆ‘ä»¬è¦çš„æ•ˆæœã€‚<br>å¹¸å¥½ webpack æä¾›äº† <code>output.libraryTarget</code> çš„é…ç½®é¡¹ã€‚</p>
<h2 id="output-libraryTarget-â€œcommonjs2â€"><a href="#output-libraryTarget-â€œcommonjs2â€" class="headerlink" title="output.libraryTarget: â€œcommonjs2â€"></a>output.libraryTarget: â€œcommonjs2â€</h2><p>å¯¹äº <code>output.libraryTarget: &quot;commonjs2&quot;</code> å®˜æ–¹è§£é‡Šï¼š</p>
<blockquote>
<p>The return value of your entry point will be assigned to the module.exports.</p>
</blockquote>
<p>é€šè¿‡é…ç½®è¯¥å±æ€§ï¼Œæˆ‘ä»¬èƒ½ä¿è¯ webpack æ‰“åŒ…å‡ºæ¥çš„ <code>bundle.js</code>ï¼Œæ˜¯æ¨¡å—åŒ–çš„ã€‚<br>å½“ç„¶ <code>output.libraryTarget</code> è¿˜æœ‰å…¶ä»–çš„é€‰é¡¹å€¼ï¼Œå¯ä»¥æŸ¥é˜…<a href="https://webpack.js.org/configuration/output/#output-librarytarget" target="_blank" rel="external">å®˜æ–¹æ–‡æ¡£</a>ã€‚</p>
<p>ä¾‹å¦‚ï¼Œä½¿ç”¨ webpack.config.js é…ç½®:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</div><div class="line"></div><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">  <span class="attr">entry</span>: <span class="string">'./foo.js'</span>,</div><div class="line">  <span class="attr">output</span>: &#123;</div><div class="line">    <span class="attr">path</span>: path.resolve(__dirname, <span class="string">'dist'</span>),</div><div class="line">    <span class="attr">filename</span>: <span class="string">'bundle.js'</span>,</div><div class="line">    <span class="attr">libraryTarget</span>: <span class="string">'commonjs2'</span>,</div><div class="line">  &#125;</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>è¿è¡Œ <code>$ webpack</code> ç”Ÿæˆçš„ <code>bundle.js</code> :</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">module</span>.exports = (<span class="function"><span class="keyword">function</span>(<span class="params">modules</span>) </span>&#123; </div><div class="line"></div><div class="line">  <span class="comment">// webpackBootstrap</span></div><div class="line"></div><div class="line">&#125;)([module1, module2, module3]);</div></pre></td></tr></table></figure>
<blockquote>
<p>ç¤ºä¾‹ä»£ç ï¼š<a href="https://github.com/JerryC8080/use-npm-in-weapp/tree/master/step2" target="_blank" rel="external">https://github.com/JerryC8080/use-npm-in-weapp/tree/master/step2</a></p>
</blockquote>
<p>è¿™æ ·ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ <code>require(&#39;bundle.js&#39;)</code>, æ¥ä½¿ç”¨ npm ä¾èµ–äº†ã€‚<br>åœ¨è¿™ä¸ªåŸºç¡€ä¸Šï¼Œæˆ‘ä»¬å°±å¯ä»¥æ‰“é€ ä¸€ä¸ªä½¿ç”¨ npm ä¾èµ–çš„å…¥å£ã€‚</p>
<h2 id="æ‰“é€ -npm-å…¥å£"><a href="#æ‰“é€ -npm-å…¥å£" class="headerlink" title="æ‰“é€  npm å…¥å£"></a>æ‰“é€  npm å…¥å£</h2><p>å»ºç«‹å…¥å£æ–‡ä»¶ï¼šnpm.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> momennt = <span class="built_in">require</span>(<span class="string">'moment'</span>);</div><div class="line"></div><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">    momennt,</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>é…ç½®æ–‡ä»¶ï¼šwebpack.config.js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> path = <span class="built_in">require</span>(<span class="string">'path'</span>);</div><div class="line"></div><div class="line"><span class="built_in">module</span>.exports = &#123;</div><div class="line">    <span class="attr">entry</span>: <span class="string">'./entry.js'</span>,</div><div class="line">    <span class="attr">output</span>: &#123;</div><div class="line">        <span class="attr">path</span>: path.resolve(__dirname, <span class="string">'npm'</span>),</div><div class="line">        <span class="attr">filename</span>: <span class="string">'index.js'</span></div><div class="line">    &#125;,</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<p>è¿è¡Œ <code>$ webpack</code>ï¼Œè¾“å‡º <code>./npm/index.js</code> æ‰“åŒ…æ–‡ä»¶ï¼Œå¯¹åº”çš„ç›®å½•ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">.</div><div class="line">â”œâ”€â”€ entry.js</div><div class="line">â”œâ”€â”€ npm</div><div class="line">â”‚   â””â”€â”€ index.js</div><div class="line">â””â”€â”€ webpack.config.js</div></pre></td></tr></table></figure>
<blockquote>
<p>ç¤ºä¾‹ä»£ç ï¼š<a href="https://github.com/JerryC8080/use-npm-in-weapp/tree/master/step3" target="_blank" rel="external">https://github.com/JerryC8080/use-npm-in-weapp/tree/master/step3</a></p>
</blockquote>
<p>ç¬¨æ‹™ç‚¹çš„æ–¹æ³•ï¼Œä½ åªéœ€è¦æŠŠ <code>npm/index.js</code> æ‹·è´åˆ°ä½ çš„é¡¹ç›®ä¸­ï¼Œå°±å¯ä»¥ä½¿ç”¨ä½ æ‰€å¼•å…¥çš„ npm åŒ…çš„å†…å®¹äº†ã€‚</p>
<p>å¦‚æœä½ çš„é¡¹ç›®ä¸­ä½¿ç”¨äº†æ„å»ºå·¥å…·çš„è¯ï¼Œå°±å¯ä»¥æŠŠã€Œ webpack æ‰“åŒ… npmã€ çš„è¿™é¡¹ä»»åŠ¡åŠ å…¥åˆ°ä½ çš„æ„å»ºæµç¨‹ä¸­ã€‚</p>
<p>æˆ‘æ˜¯ä½¿ç”¨ gulp æ¥åšé¡¹ç›®æ„å»ºå·¥ä½œçš„ï¼Œä¸‹é¢æä¾›ä¸€ç§åŸºäº gulp çš„å®ç°ä½œä¸ºå‚è€ƒã€‚</p>
<h1 id="ç»“åˆ-Gulp-åšé¡¹ç›®å·¥ç¨‹åŒ–"><a href="#ç»“åˆ-Gulp-åšé¡¹ç›®å·¥ç¨‹åŒ–" class="headerlink" title="ç»“åˆ Gulp åšé¡¹ç›®å·¥ç¨‹åŒ–"></a>ç»“åˆ Gulp åšé¡¹ç›®å·¥ç¨‹åŒ–</h1><p>å·¥ç¨‹ç›®å½•ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">.</div><div class="line">â”œâ”€â”€ dist</div><div class="line">â”‚   â”œâ”€â”€ npm</div><div class="line">â”‚   â”‚   â””â”€â”€ index.js</div><div class="line">â”‚   â””â”€â”€ pages</div><div class="line">â”‚       â””â”€â”€ home</div><div class="line">â”‚           â””â”€â”€ home.js</div><div class="line">â”œâ”€â”€ gulpfile.js</div><div class="line">â””â”€â”€ src</div><div class="line">    â”œâ”€â”€ npm</div><div class="line">    â”‚   â””â”€â”€ index.js</div><div class="line">    â””â”€â”€ pages</div><div class="line">        â””â”€â”€ home</div><div class="line">            â””â”€â”€ home.js</div></pre></td></tr></table></figure>
<p>è€Œ gulpfile è´Ÿè´£ä¸¤ä»¶äº‹ï¼š</p>
<ol>
<li>æŠŠ src çš„ js æ–‡ä»¶é€šè¿‡ babel ç¼–è¯‘åˆ° dist ç›®å½•ï¼ˆç¤ºä¾‹ä¸­å¿½ç•¥å…¶ä»– wxmlã€wxss æ–‡ä»¶ï¼‰</li>
<li>æŠŠ <code>npm/index.js</code> é€šè¿‡ webpack æ‰“åŒ…åˆ° <code>dist/npm/index.js</code>ï¼Œå¹¶å‹ç¼©ã€‚</li>
</ol>
<p>gulpfile.js:</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> gulp = <span class="built_in">require</span>(<span class="string">'gulp'</span>);</div><div class="line"><span class="keyword">const</span> babel = <span class="built_in">require</span>(<span class="string">'gulp-babel'</span>);</div><div class="line"><span class="keyword">const</span> del = <span class="built_in">require</span>(<span class="string">'del'</span>);</div><div class="line"><span class="keyword">const</span> runSequence = <span class="built_in">require</span>(<span class="string">'run-sequence'</span>);</div><div class="line"><span class="keyword">const</span> webpack = <span class="built_in">require</span>(<span class="string">'webpack'</span>);</div><div class="line"><span class="keyword">const</span> webpackStream = <span class="built_in">require</span>(<span class="string">'webpack-stream'</span>);</div><div class="line"></div><div class="line"><span class="keyword">const</span> webpackConfig = &#123;</div><div class="line">    <span class="attr">module</span>: &#123;</div><div class="line">        <span class="attr">loaders</span>: [&#123;</div><div class="line">            <span class="attr">test</span>: <span class="regexp">/\.js$/</span>,</div><div class="line">            <span class="attr">loader</span>: <span class="string">'babel-loader'</span>,</div><div class="line">            <span class="attr">exclude</span>: <span class="regexp">/node_modules/</span>,</div><div class="line">            <span class="attr">options</span>: &#123;</div><div class="line">                <span class="attr">presets</span>: [<span class="string">'es2015'</span>],</div><div class="line">            &#125;,</div><div class="line">        &#125;],</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">output</span>: &#123;</div><div class="line">        <span class="attr">filename</span>: <span class="string">'index.js'</span>,</div><div class="line">        <span class="attr">libraryTarget</span>: <span class="string">'commonjs2'</span>,        </div><div class="line">    &#125;,</div><div class="line">    <span class="attr">plugins</span>: [</div><div class="line">        <span class="keyword">new</span> webpack.optimize.UglifyJsPlugin(),</div><div class="line">    ],</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="comment">// æ¸…ç©º ./dist ç›®å½•</span></div><div class="line">gulp.task(<span class="string">'clean'</span>, () =&gt; del([<span class="string">'./dist/**'</span>]));</div><div class="line"></div><div class="line"><span class="comment">// æ‰“åŒ… npm ä¾èµ–</span></div><div class="line">gulp.task(<span class="string">'npm'</span>, () =&gt; &#123;</div><div class="line">    gulp.src(<span class="string">'./src/npm/*.js'</span>)</div><div class="line">        .pipe(webpackStream(webpackConfig), webpack)</div><div class="line">        .pipe(gulp.dest(<span class="string">'./dist/npm'</span>));</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// ç¼–è¯‘ JS æ–‡ä»¶</span></div><div class="line">gulp.task(<span class="string">'scripts'</span>, () =&gt; &#123;</div><div class="line">    gulp.src([<span class="string">'./src/**/*.js'</span>, <span class="string">'!./src/npm/*.js'</span>])</div><div class="line">        .pipe(babel(&#123;</div><div class="line">            <span class="attr">presets</span>: [<span class="string">'stage-0'</span>, <span class="string">'es2015'</span>],</div><div class="line">        &#125;))</div><div class="line">        .pipe(gulp.dest(<span class="string">'./dist'</span>));</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// å¼€å‘æ¨¡å¼å‘½ä»¤</span></div><div class="line">gulp.task(<span class="string">'build'</span>, [<span class="string">'clean'</span>], () =&gt; runSequence(<span class="string">'scripts'</span>, <span class="string">'npm'</span>));</div></pre></td></tr></table></figure>
<blockquote>
<p>ç¤ºä¾‹ä»£ç ï¼š<a href="https://github.com/JerryC8080/use-npm-in-weapp/tree/master/step4" target="_blank" rel="external">https://github.com/JerryC8080/use-npm-in-weapp/tree/master/step4</a></p>
</blockquote>
<h1 id="å…³äºæ§åˆ¶-npm-æ–‡ä»¶ä»£ç é‡"><a href="#å…³äºæ§åˆ¶-npm-æ–‡ä»¶ä»£ç é‡" class="headerlink" title="å…³äºæ§åˆ¶ npm æ–‡ä»¶ä»£ç é‡"></a>å…³äºæ§åˆ¶ npm æ–‡ä»¶ä»£ç é‡</h1><p>å¾®ä¿¡é™åˆ¶äº†é¡¹ç›®çš„ä»£ç é‡ä¸º 2Mï¼Œå°±ç®—ä½¿ç”¨äº†åˆ†åŒ…æœºåˆ¶ï¼Œæœ€å¤šä¹Ÿæ˜¯ 4M çš„ä»£ç é‡ã€‚<br>åŒºåŒºä¸€ä¸ª moment åº“çš„è¯ï¼Œå°±ç®—å‹ç¼©è¿‡ï¼Œä¹Ÿéœ€è¦ä¸¤ç™¾å¤š KBï¼Œè¿™å¯¹äºæˆ‘ä»¬çš„ä»£ç é‡ï¼Œæ˜¯å¾ˆä¸å‹å¥½çš„ã€‚<br>æˆ‘ä»¬éœ€è¦å¯¹ npm çš„å¼•å…¥æŒéå¸¸è°¨æ…çš„æ€åº¦ï¼Œå»åº¦é‡æ¯ä¸ªä¾èµ–åŒ…çš„å¤§å°ï¼Œæƒ³å°½å„ç§åŠæ³•å‡å°‘ä¾èµ–çš„ä»£ç é‡ã€‚<br>è­¬å¦‚<code>moment</code> æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>moment-mini</code> æ¥ä»£æ›¿ï¼Œåè€…å‹ç¼©è¿‡ååªéœ€è¦ 51KBã€‚</p>
<p>è€Œä¸”æˆ‘è®¤ä¸ºæŠŠ npm çš„ä¾èµ–æ”¾åœ¨ä¸€ä¸ªå…¥å£æ–‡ä»¶ä¸­ï¼Œä¼šè®©æˆ‘ä»¬å¯ä»¥å¯¹ npm çš„ä¾èµ–æœ‰ä¸€ä¸ªå…¨å±€çš„æŠŠæ¡ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å¾®ä¿¡å°ç¨‹åºæœ¬èº«ä¸æ”¯æŒ npm åŒ…çš„ä½¿ç”¨ï¼Œç›®å‰å¸‚é¢ä¸Šå¾ˆå¤šæ¡†æ¶ä¹Ÿæœ‰äº†ç›¸å¯¹åº”çš„è§£å†³æ–¹æ¡ˆã€‚&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡æ—¨åœ¨ä¸ºé‚£äº›ä¸æ„¿æ„å¼•å…¥ç¬¬ä¸‰æ–¹æ¡†æ¶ï¼Œ æƒ³åœ¨å°ç¨‹åºç¯å¢ƒä¸­å†™åŸæ±åŸå‘³ä»£ç çš„äººï¼ˆä¾‹å¦‚æˆ‘ï¼‰ï¼Œæä¾›ä¸€ç§è§£å†³é—®é¢˜çš„æ€è·¯ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ç°ä»£çš„ Web å¼€å‘ä¸­ï¼Œæˆ‘ä»¬å¯¹ Webpack å·²
    
    </summary>
    
      <category term="æ¬ç –ç å†œ" scheme="http://huang-jerryc.com/categories/%E6%90%AC%E7%A0%96%E7%A0%81%E5%86%9C/"/>
    
    
      <category term="å¾®ä¿¡å°ç¨‹åº" scheme="http://huang-jerryc.com/tags/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F/"/>
    
  </entry>
  
  <entry>
    <title>ã€Œè¯‘ã€JavaScriptæ¡†æ¶çš„æ¢ç´¢ä¸å˜è¿</title>
    <link href="http://huang-jerryc.com/2017/11/01/change-and-its-detection-in-javascript-frameworks/"/>
    <id>http://huang-jerryc.com/2017/11/01/change-and-its-detection-in-javascript-frameworks/</id>
    <published>2017-11-01T14:22:25.000Z</published>
    <updated>2020-07-21T08:12:37.392Z</updated>
    
    <content type="html"><![CDATA[<h2 id="è¯‘è€…è¨€"><a href="#è¯‘è€…è¨€" class="headerlink" title="è¯‘è€…è¨€"></a>è¯‘è€…è¨€</h2><p>è¿‘å‡ å¹´å¯è°“æ˜¯ JavaScript çš„å¤§çˆ†ç‚¸çºªå…ƒï¼Œå„ç§æ¡†æ¶ç±»åº“å±‚å‡ºä¸ç©·ï¼Œå®ƒä»¬ç»™å‰ç«¯å¸¦æ¥ä¸€ä¸ªåˆä¸€ä¸ªçš„æ–°æ€æƒ³ã€‚ä»ä»¥å‰æˆ‘ä»¬ç”¨çš„ jQuery ç›´æ¥æ“ä½œ DOMï¼Œåˆ° BackboneJSã€Dojo æä¾›ç›‘å¬å™¨çš„å½¢å¼ï¼Œåœ¨åˆ° Ember.jsã€AngularJS æ•°æ®ç»‘å®šçš„ç†å¿µï¼Œå†åˆ°ç°åœ¨çš„ Reactã€Vue è™šæ‹Ÿ DOM çš„æ€æƒ³ã€‚éƒ½æ˜¯åœ¨å½“å‰ Web åº”ç”¨æ—¥ç›Šå¤æ‚çš„æ—¶ä»£ï¼Œå¯¹äºå¦‚ä½•å¤„ç†ã€Œåº”ç”¨çŠ¶æ€ã€ä¸ã€Œç”¨æˆ·ç•Œé¢ã€ä¹‹é—´å¦‚ä½•æ›´æ–°çš„é—®é¢˜ï¼Œå¸¦æ¥æ›´å…ˆè¿›çš„è§£å†³æ–¹æ¡ˆã€‚</p>
<p>æœ¬æ–‡æ˜¯ä¸€ç¯‡ä»æŠ€æœ¯ä¸Šï¼Œä»¥æ•°æ®å˜æ›´å’ŒUIåŒæ­¥ä¸ºæ–¹å‘ï¼Œå¾ªåºæ¸è¿›çš„è®²è¿° JavaScript æ¡†æ¶å¦‚ä½•æ¼”è¿›è¿‡æ¥çš„ã€‚</p>
<p>æœ¬ç¯‡æ–‡ç« ï¼Œç»™äº†æˆ‘ä¸€ä¸ªæ›´åŠ é«˜çº¬åº¦çš„è§†è§’ï¼Œæ¥çœ‹å¾… JavaScript è¿™äº›ä¸ªæ¡†æ¶ã€‚</p>
<h2 id="æ­£æ–‡"><a href="#æ­£æ–‡" class="headerlink" title="æ­£æ–‡"></a>æ­£æ–‡</h2><p>åœ¨ 2015 å¹´ï¼ŒJavaScript æ¡†æ¶çš„é€‰æ‹©å¹¶ä¸å°‘ã€‚åœ¨ Angularï¼ŒEmberï¼ŒReactï¼ŒBackbone ä»¥åŠå®ƒä»¬ä¼—å¤šçš„ç«äº‰è€…ä¸­ï¼Œæœ‰è¶³å¤Ÿå¤šçš„é€‰æ‹©ã€‚</p>
<p>è™½ç„¶å¯ä»¥é€šè¿‡ä¸å°‘æ–¹é¢æ¥å¯¹æ¯”è¿™äº›æ¡†æ¶çš„ä¸åŒï¼Œä½†æ˜¯æœ€è®©äººæ„Ÿå…´è¶£çš„æ˜¯å®ƒä»¬åˆ†åˆ«å¦‚ä½•ç®¡ç†çŠ¶æ€ï¼ˆstateï¼‰çš„ã€‚ç‰¹åˆ«çš„ï¼Œé€šè¿‡æ€è€ƒè¿™äº›æ¡†æ¶åˆ†åˆ«å¦‚ä½•å¤„ç†çŠ¶æ€å˜åŒ–æ˜¯å¾ˆæœ‰ç”¨çš„ã€‚å®ƒä»¬éƒ½æä¾›äº†ä»€ä¹ˆæ ·çš„å·¥å…·è®©ä½ æŠŠè¿™äº›å˜åŒ–å‘ˆç°ç»™ç”¨æˆ·ï¼Ÿ </p>
<p>å¦‚ä½•å¤„ç†åº”ç”¨çŠ¶æ€ï¼ˆapp stateï¼‰ä¸ç”¨æˆ·ç•Œé¢ï¼ˆuser interfaceï¼‰ä¹‹é—´çš„åŒæ­¥ï¼Œé•¿æœŸä»¥æ¥éƒ½æ˜¯ç”¨æˆ·ç•Œé¢å¼€å‘å¦‚æ­¤å¤æ‚çš„ä¸»è¦åŸå› ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬æœ‰å‡ ä¸ªä¸åŒçš„å¤„ç†æ–¹æ¡ˆã€‚æœ¬æ–‡æ¢ç´¢ä»¥ä¸‹ï¼šEmber çš„æ•°æ®ç»‘å®šï¼ŒAngular çš„è„æ£€æŸ¥ã€React çš„è™šæ‹ŸDOMä»¥åŠå®ƒä¸ä¸å¯å˜æ•°æ®ç»“æ„ï¼ˆimmutable data structuresï¼‰ä¹‹é—´çš„è”ç³»ã€‚</p>
<h2 id="æ•°æ®æ˜ å°„-Projecting-Data"><a href="#æ•°æ®æ˜ å°„-Projecting-Data" class="headerlink" title="æ•°æ®æ˜ å°„ Projecting Data"></a>æ•°æ®æ˜ å°„ Projecting Data</h2><p>æˆ‘ä»¬é¦–å…ˆè®¨è®ºç¨‹åºå†…éƒ¨çš„çŠ¶æ€ä¸å±å¹•æ‰€çœ‹åˆ°çš„å†…å®¹ä¹‹é—´çš„æ˜ å°„ã€‚ä½ æŠŠå„ç§è¯¸å¦‚ objectï¼Œarraysï¼Œstringsï¼Œä»¥åŠ numbers è½¬æ¢æˆä¸€é¢—ç”±è¯¸å¦‚ textsã€formsã€linksã€buttons å’Œ images ç»„æˆçš„æ ‘çŠ¶ç»“æ„ã€‚åœ¨ Web ä¸­ï¼Œå‰è€…é€šå¸¸æŒ‡ JavaScript ä¸­çš„æ•°æ®ç»“æ„ï¼Œè€Œåè€…æŒ‡çš„æ˜¯ <a href="https://www.w3.org/DOM/" target="_blank" rel="external">DOM ï¼ˆDocument Object Modelï¼‰</a></p>
<p>æˆ‘ä»¬ç»å¸¸ç§°è¿™ä¸ªè¿‡ç¨‹ä¸ºæ¸²æŸ“ï¼ˆrenderingï¼‰ï¼Œä½ å¯ä»¥æƒ³è±¡è¿™ä¸ªè¿‡ç¨‹æ˜¯ä»æ•°æ®æ¨¡å‹åˆ°ç”¨æˆ·ç•Œé¢çš„ä¸€ä¸ªæ˜ å°„ã€‚å½“ä½ æŠŠæ•°æ®æ¸²æŸ“æˆä¸€ä¸ªæ¨¡æ¿ï¼Œä½ å¾—åˆ°çš„æ˜¯ä¸€ä¸ª DOMï¼ˆæˆ–è€…è¯´ HTMLï¼‰ã€‚</p>
<p><img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/post/change-and-its-detection-in-javascript-frameworks/15B722FCBCB7A5D72D240DC5B55F7DDE.svg" alt="onchange_base.svg"></p>
<p>è¿™ä¸ªè¿‡ç¨‹æœ¬èº«å·²ç»è¶³å¤Ÿç®€å•äº†ï¼Œæ•°æ®æ¨¡å‹åˆ°ç”¨æˆ·ç•Œé¢ä¹‹é—´çš„æ˜ å°„ï¼Œå¹¶ä¸æ€»æ˜¯é‚£ä¹ˆçš„çç¢ã€‚å®ƒåŸºæœ¬åªæ˜¯ä¸€ä¸ªæ¥å—è¾“å…¥ç„¶åç›´æ¥è¾“å‡ºçš„å‡½æ•°ã€‚</p>
<p>åœ¨æˆ‘ä»¬éœ€è¦è€ƒè™‘æ•°æ®å¼€å§‹éšç€æ—¶é—´è€Œå˜åŒ–çš„æ—¶å€™ï¼Œè¿™ä»¶äº‹å°±å˜å¾—æ›´æœ‰æŒ‘æˆ˜æ€§äº†ã€‚å½“ç”¨æˆ·è¿›è¡Œæ“ä½œæˆ–è€…å…¶å®ƒæŸäº›æ“ä½œå¯¼è‡´æ•°æ®äº§ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œç”¨æˆ·ç•Œé¢éœ€è¦å‘ˆç°å‡ºè¿™äº›å˜åŒ–ã€‚è€Œä¸”ï¼Œç”±äºé‡æ–°æ„å»º DOM æ ‘çš„ä»£ä»·æ˜¯æå…¶æ˜‚è´µçš„ï¼Œæˆ‘ä»¬è¦å°½å¯èƒ½äº§ç”Ÿå°çš„å½±å“ã€‚</p>
<p><img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/post/change-and-its-detection-in-javascript-frameworks/1D6EF2506F41A57871712CBCAD1463F8.svg" alt="onchange_change.svg"></p>
<p>å› ä¸ºçŠ¶æ€äº§ç”Ÿäº†å˜åŒ–ï¼Œè¿™æ¯”åªæ˜¯ä¸€æ¬¡æ€§æ¸²æŸ“ç”¨æˆ·ç•Œé¢å˜å¾—æ›´åŠ éš¾ã€‚è¿™å°±åˆ°äº†ä»¥ä¸‹è§£å†³æ–¹æ¡ˆå¼€å§‹è¡¨æ¼”çš„æ—¶å€™äº†ã€‚</p>
<h2 id="æœåŠ¡å™¨æ¸²æŸ“-Server-Side-Rendering"><a href="#æœåŠ¡å™¨æ¸²æŸ“-Server-Side-Rendering" class="headerlink" title="æœåŠ¡å™¨æ¸²æŸ“ Server-Side Rendering"></a>æœåŠ¡å™¨æ¸²æŸ“ Server-Side Rendering</h2><blockquote>
<p>å®‡å®™æ˜¯æ°¸æ’ä¸å˜çš„ï¼Œæ²¡æœ‰ä»»ä½•å˜åŒ–</p>
</blockquote>
<p>åœ¨ JavaScript æ–°çºªå…ƒä¹‹å‰ï¼Œä½ çš„ Web åº”ç”¨çš„ä»»ä½•äº¤äº’éƒ½ä¼šè§¦å‘ä¸€è¶ŸæœåŠ¡å™¨çš„ç¯ç»•æ—…è¡Œã€‚æ¯ä¸€ä¸ªç‚¹å‡»å’Œæ¯ä¸€ä¸ªè¡¨å•æäº¤éƒ½ä¼šå¸è½½å½“å‰é¡µé¢ï¼Œä¸€ä¸ªè¯·æ±‚å‘é€åˆ°æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨å“åº”ä¸€ä¸ªæ–°çš„é¡µé¢ï¼Œç„¶åæµè§ˆå™¨é‡æ–°æ¸²æŸ“ã€‚</p>
<p><img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/post/change-and-its-detection-in-javascript-frameworks/onchange_reload.svg" alt="onchange_reload.svg"></p>
<p>è¿™ç§æ–¹å¼ä¸éœ€è¦å‰ç«¯ç®¡ç†ä»»ä½•çš„çŠ¶æ€ï¼ˆstateï¼‰ã€‚å°±å‰ç«¯èŒƒç•´è€Œè¨€ï¼Œå½“ä¸€äº›äº‹æƒ…å‘ç”Ÿäº†(åç«¯è¿”å›çš„æ•°æ®)ï¼Œæ•´ä¸ªè¿‡ç¨‹å°±ç»“æŸäº†ã€‚å°±ç®—æœ‰çŠ¶æ€ï¼Œé‚£ä¹Ÿåªæ˜¯åç«¯çš„èŒƒç•´ã€‚å‰ç«¯åªæ˜¯ç”± HTML å’Œ CSS æ„æˆï¼Œä¹Ÿè®¸æœ‰æ—¶å€™ä¼šæœ‰äº› JavaScript æ’’åœ¨è¡¨é¢è°ƒå‘³ã€‚</p>
<p>ä»å‰ç«¯æ¥è¯´ï¼Œè¿™æ˜¯ä¸€ä¸ªå¾ˆç®€å•çš„å®ç°æ–¹å¼ï¼Œä½†ä¹Ÿæ˜¯ä¸€ä¸ªå¾ˆæ…¢çš„æ–¹å¼ã€‚æ¯ä¸€ä¸ªäº¤äº’å¹¶ä¸ä»…ä»…è§¦å‘UIçš„é‡æ¸²æŸ“ï¼Œè¿˜æ¶‰åŠæœåŠ¡å™¨çš„æ•°æ®æŸ¥è¯¢ä»¥åŠæœåŠ¡ç«¯æ¸²æŸ“ã€‚</p>
<p>å¤§å¤šæ•°äººå·²ç»ä¸å†è¿™æ ·åšäº†ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨æœåŠ¡å™¨ç«¯åˆå§‹åŒ–æˆ‘ä»¬çš„åº”ç”¨ï¼Œç„¶åè½¬ç§»åˆ°å‰ç«¯æ¥åšçŠ¶æ€çš„ç®¡ç†ï¼ˆè¿™ä¹Ÿæ˜¯ <a href="http://isomorphic.net/" target="_blank" rel="external">isomorphic JavaScript</a> è‡´åŠ›äºçš„ã€‚ï¼‰ã€‚å·²ç»æœ‰äººåœ¨ç±»ä¼¼çš„<a href="https://signalvnoise.com/posts/3112-how-basecamp-next-got-to-be-so-damn-fast-without-using-much-client-side-ui" target="_blank" rel="external">æ›´å¤æ‚çš„è®¾è®¡æ€æƒ³</a>ä¸­å–å¾—æˆåŠŸã€‚</p>
<h2 id="JSç¬¬ä¸€ä»£é©å‘½ï¼šæ‰‹åŠ¨é‡æ¸²æŸ“"><a href="#JSç¬¬ä¸€ä»£é©å‘½ï¼šæ‰‹åŠ¨é‡æ¸²æŸ“" class="headerlink" title="JSç¬¬ä¸€ä»£é©å‘½ï¼šæ‰‹åŠ¨é‡æ¸²æŸ“"></a>JSç¬¬ä¸€ä»£é©å‘½ï¼šæ‰‹åŠ¨é‡æ¸²æŸ“</h2><blockquote>
<p>æˆ‘ä¸çŸ¥é“å“ªäº›éœ€è¦æ¸²æŸ“çš„ï¼Œä½ æ¥å‘Šè¯‰æˆ‘ã€‚</p>
</blockquote>
<p>ç¬¬ä¸€ä»£é©å‘½çš„ JavaScript æ¡†æ¶ï¼Œå¦‚ï¼šBackbone.js, Ext JS ä»¥åŠ Dojoã€‚ç¬¬ä¸€æ¬¡åœ¨æµè§ˆå™¨ç«¯å¼•å…¥äº†æ•°æ®æ¨¡å‹ï¼ˆData Modelï¼‰çš„æ¦‚å¿µï¼Œä»£æ›¿äº†ä»¥å‰é‚£äº›ç›´æ¥æ“ä½œ DOM çš„è½»é‡çº§çš„è„šæœ¬ä»£ç ã€‚è¿™æ„å‘³ç€ä½ ç»ˆäºå¯ä»¥åœ¨æµè§ˆå™¨ç«¯ç®¡ç†çŠ¶æ€äº†ã€‚å½“æ•°æ®æ¨¡å‹çš„ä¸Šä¸‹æ–‡æ”¹å˜æ—¶ï¼Œä½ éœ€è¦åšä¸€äº›å·¥ä½œï¼Œè®©æ”¹å˜å‘ˆç°åœ¨ç”¨æˆ·ç•Œé¢ä¸­ã€‚</p>
<p>è¿™äº›æ¡†æ¶çš„ä½“ç³»èƒ½åˆ†ç¦»ä½ çš„æ¨¡å‹å’Œç•Œé¢ä»£ç ï¼Œä½†åŒæ—¶ä¹Ÿç•™ä¸‹äº†ä¸€å¤§éƒ¨åˆ†åŒæ­¥çš„å·¥ä½œç»™ä½ ã€‚ä½ å¯ä»¥ç›‘å¬æŸç±»äº‹ä»¶çš„å‘ç”Ÿï¼Œä½†æ˜¯ä½ æœ‰ä¹‰åŠ¡å»è®¡ç®—å¦‚ä½•é‡æ–°æ¸²æŸ“ä»¥åŠå¦‚ä½•è½å®åˆ°ç”¨æˆ·ç•Œé¢ä¸­ã€‚</p>
<p><img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/post/change-and-its-detection-in-javascript-frameworks/onchange_manual.svg" alt="onchange_manual.svg"></p>
<p>åŸºäºè¿™ç§æ¨¡å‹ï¼Œä½œä¸ºå¼€å‘è€…ï¼Œä½ éœ€è¦è€ƒè™‘å¤§é‡çš„æ€§èƒ½é—®é¢˜ã€‚ç”±äºä½ èƒ½æ§åˆ¶ä»€ä¹ˆæ—¶å€™å’Œæ€ä¹ˆå¤„ç†æ›´æ–°ï¼Œä½ å¯ä»¥ä»ä¸­åšä»»æ„çš„åšä¸€äº›è°ƒæ•´ã€‚è¿™ç»å¸¸ä¼šé¢ä¸´ä¸€äº›æƒè¡¡ï¼šç®€å•çš„å¤„ç†å¯¼è‡´å¤§é¢ç§¯çš„é¡µé¢æ›´æ–°ï¼Œæˆ–è€…å¼ºæ€§èƒ½çš„å¤„ç†æ¥æ›´æ–°ä¸€å°å—é¡µé¢ã€‚</p>
<h2 id="Ember-js-æ•°æ®ç»‘å®š"><a href="#Ember-js-æ•°æ®ç»‘å®š" class="headerlink" title="Ember.js: æ•°æ®ç»‘å®š"></a>Ember.js: æ•°æ®ç»‘å®š</h2><blockquote>
<p>ç”±äºæˆ‘åœ¨æ§åˆ¶ä½ çš„æ¨¡å‹å’Œè¯•å›¾ï¼Œæˆ‘ä¼šç¡®åˆ‡çŸ¥é“å¦‚ä½•é‡æ–°æ¸²æŸ“ã€‚</p>
</blockquote>
<p>å½“åº”ç”¨çŠ¶æ€æ”¹å˜çš„æ—¶å€™ï¼Œæ‰‹åŠ¨å¤„ç†æ¸²æŸ“å·¥ä½œï¼Œæ— å¯é¿å…çš„å¢åŠ äº†å¤æ‚åº¦ã€‚å¾ˆå¤šæ¡†æ¶æ—¨åœ¨è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œ<a href="https://emberjs.com" target="_blank" rel="external">Ember.js</a> å°±æ˜¯å…¶ä¸­ä¹‹ä¸€ã€‚</p>
<p>Emberï¼Œåƒ Backbone ä¸€æ ·ï¼Œå½“æ•°æ®æ¨¡å‹æ”¹å˜çš„æ—¶å€™ä¼šè§¦å‘æŸä¸ªäº‹ä»¶ã€‚ä¸åŒä¹‹å¤„åœ¨äº Ember åŒæ—¶æä¾›äº†ä¸€äº›æ–¹æ³•æ¥æ¥æ”¶è¿™äº›äº‹ä»¶ã€‚ä½ å¯ä»¥æŠŠ UI ç»‘å®šåˆ°æ•°æ®æ¨¡å‹ä¸­ï¼Œè¿™æ„å‘³ç€æœ‰ä¸€ä¸ªç›‘å¬å™¨ç»‘å®šåˆ°äº† UI ä¸Šã€‚è¯¥ç›‘å¬å™¨å½“æ”¶åˆ°äº‹ä»¶çš„æ—¶å€™ï¼ŒçŸ¥é“å¦‚ä½•æ›´æ–° UIã€‚</p>
<p><img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/post/change-and-its-detection-in-javascript-frameworks/onchange_kvo.svg" alt="onchange_kvo.svg"></p>
<p>è¿™æ˜¯ä¸€ä¸ªé«˜æ•ˆç‡çš„æœºåˆ¶ã€‚å°½ç®¡è®¾ç½®å…¨éƒ¨çš„ç›‘å¬å™¨éœ€è¦åœ¨åˆå§‹åŒ–æ—¶å¤šå‡ºä¸€äº›å·¥ä½œï¼Œä½†æ˜¯ä¹‹åå°±èƒ½ä¿è¯åŒæ­¥çŠ¶æ€æ—¶çš„æœ€å°å½±å“ã€‚å½“çŠ¶æ€äº§ç”Ÿå˜åŒ–æ—¶ï¼Œ åªæœ‰çœŸæ­£éœ€è¦æ›´æ–°çš„éƒ¨åˆ†æ‰ä¼šå‘ç”Ÿæ”¹å˜ã€‚</p>
<p>è¿™ç§æ–¹å¼æœ€å¤§çš„ç‰ºç‰²æ˜¯ Ember éœ€è¦æ—¶åˆ»ç›¯ç€æ•°æ®æ¨¡å‹ã€‚è¿™æ„å‘³ç€ä½ éœ€è¦é€šè¿‡ Ember çš„ API å°è£…ä½ çš„æ•°æ®ï¼Œä»¥åŠä½ è¦æ›´æ–°æ•°æ®çš„æ—¶å€™æ˜¯ä½¿ç”¨ <code>foo.set(&#39;x&#39;,42)</code> è€Œä¸æ˜¯ <code>foo.x = 42</code>ï¼Œä»¥æ­¤ç±»æ¨ã€‚</p>
<p>åœ¨æœªæ¥ ES6 çš„ Proxies å¯èƒ½ä¼šå¯¹è¿™ç§æ¨¡å¼äº§ç”Ÿä¸€å®šçš„å¸®åŠ©ã€‚å®ƒè®© Ember å¯ä»¥é€šè¿‡è£…é¥° object æ¥ç»‘å®šé‚£äº›ç›‘å¬å™¨çš„ä»£ç ã€‚è¿™å°±ä¸ç”¨åƒä¼ ç»Ÿæ–¹å¼é‚£æ ·é‡å†™ object çš„ setter æ–¹æ³•äº†ã€‚</p>
<h2 id="AngularJSï¼šè„æ£€æŸ¥"><a href="#AngularJSï¼šè„æ£€æŸ¥" class="headerlink" title="AngularJSï¼šè„æ£€æŸ¥"></a>AngularJSï¼šè„æ£€æŸ¥</h2><blockquote>
<p>æˆ‘ä¸çŸ¥é“ä»€ä¹ˆæ›´æ–°äº†ï¼Œæ‰€ä»¥å½“æ›´æ–°çš„æ—¶å€™ï¼Œæˆ‘åªèƒ½æ£€æŸ¥æ‰€æœ‰çš„ä¸œè¥¿ã€‚</p>
</blockquote>
<p>AngularJS ç±»ä¼¼äº Emberï¼Œå½“çŠ¶æ€æ”¹å˜çš„æ—¶å€™ï¼Œå¿…é¡»äººå·¥å»å¤„ç†ã€‚ä½†ä¸åŒçš„æ˜¯ï¼ŒAngularJS ä»ä¸åŒçš„è§’åº¦æ¥è§£å†³é—®é¢˜ã€‚</p>
<p>å½“ä½ åœ¨ Angular æ¨¡æ¿ä¸­å¼•ç”¨ä½ çš„æ•°æ®ï¼Œä¾‹å¦‚è¿™æ ·çš„è¯­å¥ <code></code> ï¼ŒAngular ä¸ä»…ä»…åªæ˜¯æ¸²æŸ“æ•°æ®ï¼Œè€Œä¸”ä¼šè¿™ä¸ªç‰¹å®šçš„æ•°æ®åˆ›å»ºä¸€ä¸ªè§‚å¯Ÿè€…ã€‚å¦‚æ­¤ï¼Œåªè¦ä½ çš„åº”ç”¨ä¸­å‘ç”Ÿä»»ä½•å˜åŒ–ï¼ŒAngular éƒ½ä¼šæ£€æŸ¥è¿™ä¸ªè§‚å¯Ÿè€…æ£€è§†ç€çš„æ•°æ®æ˜¯å¦å‘ç”Ÿäº†æ”¹å˜ã€‚å¦‚æœå‘ç”Ÿäº†æ”¹å˜ï¼Œå°±ä¼šé‡æ–°æ¸²æŸ“è¿™ä¸ªæ•°æ®å¯¹åº”çš„ç”¨æˆ·ç•Œé¢ã€‚è¿™ä¸ªè¿‡ç¨‹ç§°ä½œè„æ£€æŸ¥ï¼ˆDirty Checkingï¼‰ã€‚</p>
<p><img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/post/change-and-its-detection-in-javascript-frameworks/onchange_watch.svg" alt="onchange_watch.svg"></p>
<p>è¿™ç§ç›‘å¬æ”¹å˜çš„é£æ ¼æœ€å¤§çš„å¥½å¤„å°±æ˜¯ï¼Œä½ å¯ä»¥åœ¨ä½ çš„æ•°æ®æ¨¡å‹ä¸­ä½¿ç”¨ä»»ä½•å§¿åŠ¿ã€‚Angular å¯¹æ­¤æ²¡æœ‰ä»»ä½•é™åˆ¶ï¼Œå®ƒä¸å…³å¿ƒè¿™ä¸ªã€‚æ²¡æœ‰åŸºç¡€çš„å¯¹è±¡éœ€è¦æ‰©å±•ï¼Œä¹Ÿæ²¡æœ‰ API éœ€è¦è°ƒç”¨ã€‚</p>
<p>ä½†åå¤„å°±æ˜¯ç°åœ¨æ•°æ®æ¨¡å‹æ²¡æœ‰ä»»ä½•å†…å»ºçš„æ£€æµ‹æ‰‹æ®µå‘Šè¯‰å‘Šè¯‰æ¡†æ¶å“ªäº›ä¸œè¥¿å‘ç”Ÿäº†æ”¹å˜ï¼Œæ¡†æ¶å¯¹æ˜¯å¦æˆ–è€…å“ªé‡Œå‘ç”Ÿäº†æ”¹å˜æ²¡æœ‰ä»»ä½•æ´å¯ŸåŠ›ã€‚è¿™æ„å‘³ç€æ•°æ®æ¨¡å‹éœ€è¦é€šè¿‡å¤–éƒ¨æ¥ç›‘å¬æ”¹å˜ï¼Œè€Œ Angular å°±æ˜¯è¿™æ ·å­åšçš„ï¼šæ‰€æœ‰è§‚å¯Ÿè€…åœ¨ä»»ä½•æ—¶é—´å‘ç”Ÿçš„ä»»ä½•æ”¹å˜ï¼Œéƒ½éœ€è¦è¢«æ‰§è¡Œä¸€æ¬¡ã€‚ç‚¹å‡»äº‹ä»¶ï¼ŒHTTP å“åº”ï¼Œtimeout æ–¹æ³•çš„è§¦å‘ï¼Œå¯¹äºè¿™äº›ï¼Œè§‚å¯Ÿè€…éƒ½éœ€è¦æ‰§è¡Œä¸€éã€‚</p>
<p>ç»å¸¸å»æ‰§è¡Œæ‰€æœ‰è§‚å¯Ÿè€…ï¼Œè¿™å¬èµ·æ¥åƒæ˜¯æ€§èƒ½çš„å™©æ¢¦ï¼Œä½†æ˜¯å®ƒä»¤äººæƒŠè®¶çš„å¿«ã€‚è¿™ä¸»è¦æ˜¯å› ä¸ºåœ¨æ£€æŸ¥åˆ°ä»»ä½•æ”¹å˜ä¹‹å‰ï¼Œæ²¡æœ‰ DOM çš„æ“ä½œè¿‡ç¨‹ï¼Œè€ŒåŸç”Ÿçš„ JavaScript å¼•ç”¨å¯¹è±¡çš„æ£€æŸ¥å¹³å‡æ¶ˆè€—çš„æ€§èƒ½æ˜¯å»‰ä»·çš„ã€‚ä½†æ˜¯å½“ä½ è¦å¤„ç†å¤§é‡çš„ UI æˆ–è€…ç»å¸¸æ€§è§¦å‘é‡æ–°æ¸²æŸ“ï¼Œé‚£ä¹ˆé¢å¤–çš„æ€§èƒ½ä¼˜åŒ–æ‰‹æ®µå°±å˜å¾—å¾ˆæœ‰å¿…è¦äº†ã€‚</p>
<p>Ember å’Œ Angular éƒ½å³å°†å¾—ç›Šäºå³å°†åˆ°æ¥çš„æ ‡å‡†ï¼šECMAScript7 çš„ <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/observe" target="_blank" rel="external">Object.observe</a> åŠŸèƒ½ï¼Œå¾ˆé€‚åˆ Angularã€‚å®ƒæä¾›äº†åŸç”Ÿçš„ API ç»™ä½ ç”¨æ¥ç›‘å¬å¯¹è±¡å±æ€§çš„å˜åŒ–ã€‚å°½ç®¡è¿™æ ·ï¼ŒAngular ä¸éœ€è¦æ”¯æŒæ‰€æœ‰çš„ç”¨ä¾‹ï¼Œå› ä¸º Angular çš„è§‚å¯Ÿè€…ç›¸å¯¹äºç®€å•çš„ç›‘å¬å¯¹è±¡å±æ€§ï¼Œå¯ä»¥åšåˆ°çš„æ›´å¥½ã€‚</p>
<p>å³å°†åˆ°æ¥çš„ Angular 2 åœ¨æ£€æµ‹æ”¹å˜è¿™ä»¶äº‹ä¸Šå¸¦æ¥äº†å¾ˆå¤šæœ‰è¶£çš„æ›´æ–°ï¼Œæœ€è¿‘ <a href="http://victorsavkin.com/post/110170125256/change-detection-in-angular-2" target="_blank" rel="external">Victor Savkin çš„ä¸€ç¯‡æ–‡ç« </a>æœ‰ä»‹ç»åˆ°ã€‚</p>
<p>å…³äºè¿™ä¸ªä¸»é¢˜ï¼Œä¹Ÿå¯ä»¥çœ‹ï¼š<a href="https://www.youtube.com/watch?v=jvKGQSFQf10&amp;feature=youtu.be" target="_blank" rel="external">Victorâ€™s ng-conf talk</a></p>
<h2 id="React-è™šæ‹Ÿ-DOM"><a href="#React-è™šæ‹Ÿ-DOM" class="headerlink" title="React: è™šæ‹Ÿ DOM"></a>React: è™šæ‹Ÿ DOM</h2><blockquote>
<p>æˆ‘ä¸çŸ¥é“åˆ°åº•å“ªäº›å‘ç”Ÿäº†å˜åŒ–ï¼Œæ‰€ä»¥æˆ‘åªèƒ½é‡æ–°æ¸²æŸ“æ‰€æœ‰ä¸œè¥¿ï¼Œç„¶åçœ‹ä¸€ä¸‹æœ‰å“ªäº›ä¸åŒã€‚</p>
</blockquote>
<p>React æœ‰å¾ˆå¤šæœ‰è¶£çš„ç‰¹æ€§ï¼Œä½†æ˜¯æˆ‘ä»¬è®¨è®ºçš„æœ€æœ‰è¶£çš„ç‰¹æ€§æ˜¯è™šæ‹Ÿ DOMã€‚</p>
<p>åƒ Angular ä¸€æ ·ï¼ŒReact ä¸ä¼šå¯¹æ•°æ®æ¨¡å‹è¿›è¡Œé™åˆ¶ï¼Œè€Œæ˜¯è®©ä½ ä½¿ç”¨ä½ è®¤ä¸ºåˆé€‚çš„ä»»ä½•å¯¹è±¡å’Œæ•°æ®ç»“æ„ã€‚é‚£ä¹ˆï¼Œå®ƒæ˜¯å¦‚ä½•åœ¨å­˜åœ¨æ”¹å˜çš„æƒ…å†µä¸‹ä½¿ UI ä¿æŒæœ€æ–°å‘¢ï¼Ÿ</p>
<p>React æ‰€åšçš„æ˜¯æœ‰æ•ˆçš„æŠŠæˆ‘ä»¬å¸¦å›æœåŠ¡å™¨æ¸²æŸ“æ—¶ä»£ï¼Œå½“æ—¶æˆ‘ä»¬è¿˜ä¸å…³å¿ƒçŠ¶æ€å˜åŒ–ï¼šæ¯å½“æŸå¤„å‘ç”Ÿæ”¹å˜çš„æ—¶å€™ï¼Œå®ƒä¼šä»å¤´é‡æ–°æ¸²æŸ“æ•´ä¸ª UIã€‚è¿™å¯ä»¥æ˜¾è‘—çš„ç®€åŒ– UI çš„ä»£ç ã€‚å¤§éƒ¨åˆ†æƒ…å†µï¼Œä½ ä¸ä¼šå…³å¿ƒå¦‚ä½•åœ¨ React ä¸­ç»´æŠ¤çŠ¶æ€ã€‚å°±åƒæœåŠ¡å™¨æ¸²æŸ“ä¸€æ ·ï¼Œæ¸²æŸ“ä¸€æ¬¡å°±ç®—äº†ã€‚å½“ç»„ä»¶éœ€è¦å˜æ›´æ—¶ï¼Œå®ƒåªèƒ½å†æ¬¡é‡æ–°æ¸²æŸ“ã€‚ç»„ä»·çš„åˆå§‹åŒ–æ¸²æŸ“å’Œæ›´ç»†å®ƒçš„æ•°æ®ä¹‹é—´ï¼Œæ²¡æœ‰ä»»ä½•åŒºåˆ«ã€‚</p>
<p>å¦‚æœæ•…äº‹å°±è¿™ä¹ˆç»“æŸçš„è¯ï¼Œå®ƒçœ‹èµ·æ¥çš„ç¡®éå¸¸ä½æ•ˆã€‚ç„¶è€Œï¼ŒReact åœ¨é‡æ–°æ¸²æŸ“æ–¹é¢ï¼Œæœ‰ç‚¹ç‰¹æ®Šã€‚</p>
<p>å½“ React è¿›è¡Œé‡æ–°æ¸²æŸ“æ—¶ï¼Œå®ƒé¦–å…ˆä¼šæ¸²æŸ“åˆ°è™šæ‹Ÿ DOM ä¸­ï¼Œè¿™ä¸æ˜¯ä¸€ä¸ªå®é™…çš„ DOM å¯¹è±¡çš„å›¾ã€‚è€Œæ˜¯ä¸€ä¸ªè½»é‡çº§çš„ï¼Œæœ‰çº¯ç²¹çš„ object å’Œ array ç»„æˆçš„çº¯ JavaScript çš„æ•°æ®ç»“æ„ï¼Œå®ƒä»£è¡¨ç€ä¸€ä¸ªçœŸå®çš„ DOM å¯¹è±¡çš„å›¾ã€‚</p>
<p>ç„¶åï¼Œä¸€ä¸ªç‹¬ç«‹çš„è¿›ç¨‹ä¼šæ ¹æ®è™šæ‹Ÿ DOM çš„ç»“æ„æ¥åˆ›å»ºé‚£äº›åœ¨å±å¹•ä¸Šæ˜¾ç¤ºçš„çœŸå®çš„ DOM å…ƒç´ ã€‚</p>
<p><img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/post/change-and-its-detection-in-javascript-frameworks/onchange_vdom_initial.svg" alt="onchange_vdom_initial.svg"></p>
<p>ä¹‹åï¼Œå½“å˜åŒ–å‘ç”Ÿçš„æ—¶å€™ï¼Œä¸€ä¸ªæ–°çš„è™šæ‹Ÿ DOM ä¼šè¢«ä»å¤´åˆ°å°¾åˆ›å»ºå‡ºæ¥ã€‚è¿™ä¸ªæ–°çš„è™šæ‹Ÿ DOM å°†æ˜ å°„å‡ºæ•°æ®æ¨¡å‹çš„æ–°çš„çŠ¶æ€ã€‚ç°åœ¨ React åœ¨æ‰‹ä¸Šæœ‰ä¸¤ä¸ªè™šæ‹Ÿ DOMï¼šä¸€ä¸ªæ–°çš„ï¼Œä¸€ä¸ªæ—§çš„ã€‚ç„¶åä¼šå¯¹ä¸¤ä¸ªè™šæ‹Ÿ DOM è¿›è¡Œä¸€ä¸ªå¯¹æ¯”ç®—æ³•ï¼Œå¾—å‡ºå®ƒä»¬ä¹‹é—´çš„ä¸€ç»„å˜åŒ–ã€‚æœ‰ä¸”åªæœ‰è¿™äº›æ›´æ”¹ä¼šè¢«åº”ç”¨åˆ°çœŸå® DOM ä¸­ï¼šæ­¤å…ƒç´ å·²æ·»åŠ ï¼Œæ­¤å±æ€§ä»¥æ”¹å˜ï¼Œç­‰ç­‰ã€‚</p>
<p><img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/post/change-and-its-detection-in-javascript-frameworks/onchange_vdom_change.svg" alt="onchange_vdom_change.svg"></p>
<p>æ‰€ä»¥ React èµ·ç è‡³å°‘æœ‰ä¸€ä¸ªå¥½å¤„ï¼Œå°±æ˜¯ä½ ä¸ç”¨è¿½è¸ªå˜åŒ–äº†ã€‚ä½ åªéœ€è¦æ¯æ¬¡é‡æ–°æ¸²æŸ“æ•´ä¸ª UI ï¼Œç„¶åæ— è®ºæ”¹å˜äº†ä»€ä¹ˆæœ€ç»ˆéƒ½ä¼šå¾—åˆ°ç›¸åº”çš„ç»“æœã€‚React çš„è™šæ‹Ÿ DOM å¯¹æ¯”ç®—æ³•ï¼Œèƒ½è®©ä½ åšåˆ°è¿™ä¸€ç‚¹ï¼Œå¹¶ä¸”æœ€å¤§é™åº¦çš„èŠ‚çœæ˜‚è´µçš„ DOM æ“ä½œã€‚</p>
<h2 id="Om-ä¸å¯æ”¹å˜çš„æ•°æ®ç»“æ„"><a href="#Om-ä¸å¯æ”¹å˜çš„æ•°æ®ç»“æ„" class="headerlink" title="Om: ä¸å¯æ”¹å˜çš„æ•°æ®ç»“æ„"></a>Om: ä¸å¯æ”¹å˜çš„æ•°æ®ç»“æ„</h2><blockquote>
<p>æˆ‘ç¡®åˆ‡çš„çŸ¥é“å“ªäº›æ²¡æœ‰æ”¹å˜ã€‚</p>
</blockquote>
<p>è™½ç„¶ React çš„è™šæ‹Ÿ DOM ç›¸å½“çš„å—ï¼Œä½†æ˜¯å½“ä½ çš„ UI éå¸¸åºå¤§æˆ–è€…ç»å¸¸æ€§æ¸²æŸ“çš„æ—¶å€™ï¼ˆä¾‹å¦‚ï¼šæ¯ç§’é«˜è¾¾ 60 æ¬¡ï¼‰ï¼Œå®ƒä¾ç„¶ä¼šé¢ä¸´ç“¶é¢ˆã€‚</p>
<p>é—®é¢˜åœ¨äºï¼ŒçœŸçš„æ²¡åŠæ³•æ¯æ¬¡éƒ½æ¸²æŸ“å‡ºæ•´ä¸ªè™šæ‹Ÿ DOMï¼Œé™¤éä½ å¼•å…¥ä¸€äº›æ–¹æ³•æ¥æ§åˆ¶æ•°æ®æ¨¡å‹çš„æ”¹å˜ï¼Œå°±åƒ Ember åšçš„ä¸€æ ·ã€‚</p>
<p>ä¸€ç§æ§åˆ¶å˜åŒ–çš„åŠæ³•æ˜¯ <a href="http://en.wikipedia.org/wiki/Persistent_data_structure" target="_blank" rel="external">ä¸å¯æ”¹å˜çš„ï¼ŒæŒä¹…åŒ–çš„æ•°æ®ç»“æ„</a>ã€‚è¿™äº›çœ‹èµ·æ¥ä¼¼ä¹å¾ˆé€‚åˆä½¿ç”¨åœ¨ React çš„è™šæ‹Ÿ DOM ä¸­ï¼Œæ­£å¦‚ David Nolen åœ¨ <a href="https://github.com/omcljs/om" target="_blank" rel="external">Om</a> åº“ä¸­æ‰€åšçš„ <a href="http://swannodette.github.io/2013/12/17/the-future-of-javascript-mvcs/" target="_blank" rel="external">å·¥ä½œ</a> é‚£æ ·ï¼Œä¸€ä¸ªæ„å»ºäº React å’Œ <a href="https://github.com/clojure/clojurescript" target="_blank" rel="external">ClojureScript</a> ä¹‹ä¸Šçš„åº“ã€‚</p>
<p>æœ‰ä¸€ç‚¹å…³äºä¸å¯æ”¹å˜æ•°æ®ç»“æ„çš„æ˜¯ï¼Œé¡¾åæ€ä¹‰ï¼Œä½ æ°¸è¿œä¸èƒ½æ”¹å˜å®ƒï¼Œåªèƒ½äº§ç”Ÿæ–°çš„ç‰ˆæœ¬ã€‚å¦‚æœä½ æƒ³æ”¹å˜ä¸€ä¸ªå¯¹è±¡çš„å±æ€§ï¼Œä½ åªèƒ½æ–°å»ºä¸€ä¸ªå¯¹è±¡å’Œå±æ€§ï¼Œå› ä¸ºä½ ä¸èƒ½æ”¹å˜å·²ç»å­˜åœ¨çš„é‚£ä¸€ä¸ªã€‚ç”±äºæŒä¹…åŒ–æ•°æ®ç»“æ„çš„å·¥ä½œæ–¹å¼ï¼Œè¿™æ¯”å¬èµ·æ¥æ›´åŠ æœ‰æ•ˆç‡ã€‚</p>
<p>è¿™æ„å‘³ç€åœ¨æ£€æµ‹å˜åŒ–æ–¹é¢ï¼Œå½“ React ç»„ä»¶éƒ½åªç”±ä¸å¯å˜æ•°æ®ç»„æˆçš„æ—¶å€™ï¼Œåªæœ‰ä¸€ä¸ªé€ƒç”Ÿçª—å£ï¼šå½“ä½ é‡æ–°æ¸²æŸ“ä¸€ä¸ªç»„ä»¶æ—¶ï¼Œç»„ä»¶çš„çŠ¶æ€ä»ç„¶æŒ‡å‘ä¸Šæ¬¡æ¸²æŸ“æ—¶çš„ç›¸åŒæ•°æ®ç»“æ„ï¼Œä½ å°±å¯ä»¥è·³è¿‡è¿™æ¬¡é‡æ–°æ¸²æŸ“ã€‚ä½ å¯ä»¥ä½¿ç”¨è¯¥ç»„ä»¶çš„å…ˆå‰çš„è™šæ‹Ÿ DOM ä»¥åŠæºè‡ªè¯¥ç»„ä»¶çš„æ•´ä¸ªç»„ä»¶æ ‘ã€‚æ²¡æœ‰å¿…è¦è¿›ä¸€æ­¥æŒ–æ˜ï¼Œå› ä¸ºåœ¨è¿™ä¸ªçŠ¶æ€ä¸­æ‰€æœ‰ä¸œè¥¿éƒ½ä¸å¯èƒ½æ”¹å˜ã€‚</p>
<p><img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/post/change-and-its-detection-in-javascript-frameworks/onchange_immutable.svg" alt="onchange_immutable.svg"></p>
<p>å°±åƒ Ember ä¸€æ ·ï¼Œåƒ Om çš„è¿™ç§åº“ä¸å…è®¸åœ¨ä½ çš„æ•°æ®ä¸­ä½¿ç”¨æ—§çš„ JavaScript å¯¹è±¡å›¾ã€‚ä½ å¿…é¡»åœ¨ä¸å¯å˜æ•°æ®ç»“æ„ä¸­æ„å»ºä½ çš„æ•°æ®æ¨¡å‹ï¼Œä»è€Œæ‰èƒ½åœ¨å…¶ä¸­å¾—åˆ°å¥½å¤„ã€‚æˆ‘ä¼šèµåŒè¿™æ ·çš„åšæ³•ï¼Œå› ä¸ºè¿™ä¸€æ¬¡ä½ è¿™æ ·åšå¹¶ä¸æ˜¯ä¸ºäº†å–æ‚¦æ¡†æ¶æœ¬èº«ã€‚ä½ è¿™æ ·åšåªæ˜¯å› ä¸ºè¿™æ˜¯ä¸€ä¸ªåˆç®€å•åˆå¥½çš„æ–¹å¼å»ç®¡ç†ä½ çš„åº”ç”¨çŠ¶æ€ã€‚ä½¿ç”¨ä¸å¯å˜æ•°æ®ç»“æ„çš„ä¸»è¦å¥½å¤„ï¼Œå¹¶ä¸æ˜¯æå‡æ¸²æŸ“æ€§èƒ½ï¼Œè€Œæ˜¯ç®€åŒ–ä½ çš„åº”ç”¨ç»“æ„ã€‚</p>
<p>è™½ç„¶ Om å’Œ ClojureScript å·²ç»è®² React å’Œä¸å¯å˜æ•°æ®ç»“æ„èåˆèµ·æ¥ï¼Œä½†æ˜¯ä»–ä»¬å¹¶ä¸æ˜¯åœˆå­é‡Œé¢çš„å”¯ä¸€ç»„åˆã€‚è€Œä»…ä»…ä½¿ç”¨ React å’Œ Facebook çš„ <a href="http://facebook.github.io/immutable-js/" target="_blank" rel="external">Immutable-js</a> æ˜¯å®Œå…¨å¯èƒ½çš„ã€‚è¿™ä¸ªåº“çš„ä½œè€… Lee Byron åœ¨æœ€è¿‘çš„ä¸€æ¬¡ React.js ä¸ºä¸»é¢˜çš„ä¼šè®®ä¸­è¿›è¡Œäº†ä¸€ä¸ª <a href="https://www.youtube.com/embed/I7IdS-PbEgI" target="_blank" rel="external">ç²¾å½©çš„ä»‹ç»</a>ã€‚</p>
<p>åŒæ—¶æˆ‘å»ºè®®çœ‹ä¸€ä¸‹ Rich Hickeyâ€™s çš„ <a href="http://www.infoq.com/presentations/Value-Identity-State-Rich-Hickey" target="_blank" rel="external">Persistent Data Structures And Managed References</a>, å»äº†è§£çŠ¶æ€ç®¡ç†çš„æ–¹æ³•ã€‚</p>
<p>æˆ‘è‡ªå·±ç°åœ¨ä¸€ç›´åœ¨ä¸ºä¸å¯å˜æ•°æ®æ•°æ®ç»“æ„ <a href="http://blog.deveo.com/immutability-in-ruby-part-1-data-structures/" target="_blank" rel="external">å†™è¯—</a>ï¼Œä½†æˆ‘ç»å¯¹æ²¡æœ‰é¢„è§åˆ°å®ƒä¼šè¿›å…¥å‰ç«¯ UI æ¡†æ¶è¡Œåˆ—ã€‚å®ƒçœ‹èµ·æ¥ä¼¼ä¹ä¸é—ä½™åŠ›çš„å‘ç”Ÿç€ï¼Œè€Œ Angular çš„äºº <a href="http://victorsavkin.com/post/110170125256/change-detection-in-angular-2" target="_blank" rel="external">æ­£åœ¨ä¸ºæ”¯æŒè¿™ä¸ªè€ŒåŠªåŠ›ç€</a>ã€‚</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æ£€æµ‹å˜åŒ–æ—¶ UI å¼€å‘ä¸­çš„æ ¸å¿ƒé—®é¢˜ï¼Œè€Œ JavaScript æ¡†æ¶ä»¬ä»¥å„ç§æ–¹å¼è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<p>EmberJS èƒ½åœ¨å®ƒä»¬å‘ç”Ÿå˜åŒ–çš„æ—¶å€™æ£€æµ‹åˆ°ï¼Œå› ä¸ºå®ƒæ§åˆ¶ç€ä½ çš„æ•°æ®æ¨¡å‹ APIï¼Œå¹¶ä¸”å¯ä»¥åœ¨ä½ è°ƒç”¨å®ƒçš„æ—¶å€™è§¦å‘äº‹ä»¶ã€‚</p>
<p>Angular.js æ˜¯äº‹åè¿›è¡Œæ£€æµ‹ï¼Œ å®ƒé€šè¿‡é‡æ–°è¿è¡Œä½ å·²ç»åœ¨ UI ä¸­æ³¨å†Œçš„æ‰€æœ‰æ•°æ®ç»‘å®šï¼Œæ¥æ£€æµ‹å®ƒä»¬çš„å€¼æ˜¯å¦å·²ç»å‘ç”Ÿå˜åŒ–ã€‚</p>
<p>React çš„æ£€æµ‹æ–¹æ³•æ˜¯é€šè¿‡æŠŠæ•´ä¸ª UI é‡æ–°æ¸²æŸ“æˆä¸€ä¸ªè™šæ‹Ÿ DOMï¼Œç„¶åå’Œæ—§çš„ç‰ˆæœ¬è¿›è¡Œå¯¹æ¯”ã€‚æ— è®ºæ”¹å˜äº†ä»€ä¹ˆï¼Œéƒ½å¯ä»¥ç»™çœŸå® DOM æ‰“ä¸Šä¸ªè¡¥ä¸ã€‚</p>
<p>React å’Œ ä¸å¯å˜æ•°æ®ç»“æ„çš„ç»„åˆï¼Œå¯¹æ¯”çº¯ç²¹çš„ React æœ‰æ‰€å¢å¼ºï¼Œé€šè¿‡å¿«é€Ÿçš„åœ¨ç»„ä»¶æ ‘ä¸­æ ‡è®°ä¸å¯å˜çš„èŠ‚ç‚¹ã€‚å› ä¸ºç»„ä»¶å†…çš„å˜åŒ–æ˜¯ä¸è¢«å…è®¸çš„ã€‚ä½†æ˜¯ï¼Œè¿™ä¸æ˜¯ä¸»è¦å‡ºäºæ€§èƒ½çš„åŸå› ï¼Œè€Œæ˜¯ç”±äºå®ƒå¯¹æ•´ä¸ªåº”ç”¨ç¨‹åºä½“ç³»ç»“æ„æœ‰ç§¯æçš„å½±å“ã€‚</p>
<h2 id="åŸæ–‡é“¾æ¥"><a href="#åŸæ–‡é“¾æ¥" class="headerlink" title="åŸæ–‡é“¾æ¥"></a>åŸæ–‡é“¾æ¥</h2><p><a href="http://teropa.info/blog/2015/03/02/change-and-its-detection-in-javascript-frameworks.html" target="_blank" rel="external">Changes and Its detection of JavaScript Framework</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;è¯‘è€…è¨€&quot;&gt;&lt;a href=&quot;#è¯‘è€…è¨€&quot; class=&quot;headerlink&quot; title=&quot;è¯‘è€…è¨€&quot;&gt;&lt;/a&gt;è¯‘è€…è¨€&lt;/h2&gt;&lt;p&gt;è¿‘å‡ å¹´å¯è°“æ˜¯ JavaScript çš„å¤§çˆ†ç‚¸çºªå…ƒï¼Œå„ç§æ¡†æ¶ç±»åº“å±‚å‡ºä¸ç©·ï¼Œå®ƒä»¬ç»™å‰ç«¯å¸¦æ¥ä¸€ä¸ªåˆä¸€ä¸ªçš„æ–°æ€æƒ³ã€‚ä»ä»¥å‰æˆ‘ä»¬ç”¨çš„ jQuer
    
    </summary>
    
      <category term="æ¬ç –ç å†œ" scheme="http://huang-jerryc.com/categories/%E6%90%AC%E7%A0%96%E7%A0%81%E5%86%9C/"/>
    
    
      <category term="javascript" scheme="http://huang-jerryc.com/tags/javascript/"/>
    
  </entry>
  
  <entry>
    <title>æœ‰èµå¾®ä¿¡å°ç¨‹åºåˆ†äº« â€” æ¦‚å¿µç¯‡</title>
    <link href="http://huang-jerryc.com/2017/08/31/yz-share-about-wxapp--cencept/"/>
    <id>http://huang-jerryc.com/2017/08/31/yz-share-about-wxapp--cencept/</id>
    <published>2017-08-31T05:15:02.000Z</published>
    <updated>2020-07-21T08:12:37.394Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨ 2016 å¹´ 9 æœˆ 23 æ—¥ å¾®ä¿¡å°ç¨‹åºå†…æµ‹å¼€å§‹ä»¥æ¥ï¼Œæœ‰èµçš„äº§å“ä¸æŠ€æœ¯ä¸€ç›´ç´§è·Ÿç€å°ç¨‹åºçš„æ­¥ä¼ã€‚å¹¶ä¸”åœ¨ 2017å¹´1æœˆ9æ—¥ å¾®ä¿¡å°ç¨‹åºå‘å¸ƒçš„åŒæ—¶ä¸Šçº¿äº†æœ‰èµå¾®å•†åŸå°ç¨‹åºå’Œæœ‰èµç²¾é€‰å°ç¨‹åºã€‚å¹¶ä¸”ç´§è·Ÿç€å¼€æºäº†å°ç¨‹åºçš„ UI åº“ï¼š<a href="https://github.com/youzan/zanui-weapp" target="_blank" rel="external">zanui-weapp</a></p>
<p>åœ¨æˆ‘åŠ å…¥æœ‰èµä¸ä¹…åï¼Œå°±å‚ä¸äº†å¾®ä¿¡å°ç¨‹åºäº§å“çº¿çš„å¼€å‘ã€‚<br>éšç€ä»Šå¹´å¾®ä¿¡å®˜æ–¹å¤§åŠ›æ¨å¹¿å’Œè¿­ä»£ï¼Œå¾®ä¿¡å°ç¨‹åºå¯è°“æ¸æ¸å½¢æˆä¸€ä¸ªæ–°é‡é‡çº§ç°è±¡ï¼Œå¯¹äºè‡ªèº«æ¥è¯´ï¼Œé™¤äº†å•çº¯çš„æŒæ¡æŠ€æœ¯ä¸Šçš„å¼€å‘å§¿åŠ¿ä»¥å¤–ï¼Œè¿˜éœ€å¯¹æ•´ä¸ªå°ç¨‹åºç”Ÿæ€ä»¥åŠæœªæ¥çš„åŠ¨å‘æœ‰è¶³å¤Ÿçš„è®¤è¯†å’Œäº†è§£ã€‚<br>äºæ˜¯ä¹æœ¬ç€ç ”ç©¶ä¸å­¦ä¹ ï¼Œæœ‰äº†è¿™ä¸€æ¬¡å†…éƒ¨åˆ†äº«ã€‚<br>è¶ç€è¯¾ä½™æ—¶é—´ï¼Œæ•´ç†æˆæ–‡ï¼Œä¸å›åˆ†äº«ã€‚</p>
<h1 id="å¾®ä¿¡å¼€å‘ä½“ç³»"><a href="#å¾®ä¿¡å¼€å‘ä½“ç³»" class="headerlink" title="å¾®ä¿¡å¼€å‘ä½“ç³»"></a>å¾®ä¿¡å¼€å‘ä½“ç³»</h1><p>å¾®ä¿¡å¼€å‘ï¼Œæ˜¯ä¸€ä¸ªä½“ç³»ã€‚<br>æ— è®ºæ˜¯å¼€å‘ç§»åŠ¨åº”ç”¨ï¼Œç½‘ç«™åº”ç”¨ï¼Œéƒ½å¯ä»¥æ¥å…¥å¾®ä¿¡ç”Ÿæ€ï¼Œä¾‹å¦‚å®ç°å¾®ä¿¡è´¦å·ç™»å½•ï¼Œå®ç° APP åˆ†äº«åˆ°å¾®ä¿¡æœ‹å‹åœˆå’Œè”ç³»äººã€‚<br>é™¤äº†è‡ªæœ‰çš„åº”ç”¨ï¼Œè¿˜å¯ä»¥åœ¨å…¬ä¼—å·å†…è¿›è¡Œåº”ç”¨å¼€å‘ï¼Œä¸ºè®¢é˜…å·æˆ–è€…æœåŠ¡å·æä¾›æ›´å¼ºå¤§çš„åŠŸèƒ½å’Œäº¤äº’ã€‚<br>ç°åœ¨åˆæœ‰äº†å°ç¨‹åºï¼Œé™¤äº†å¼€å‘å·¥å…·ç±»åº”ç”¨æ›´ç®€å•ä»¥å¤–ï¼Œè¿æ¥çº¿ä¸Šçº¿ä¸‹çš„åœºæ™¯æ›´ä¸°å¯Œã€‚<br>åœ¨æˆ‘è®¤ä¸ºï¼Œå›½å†…çš„äº’è”ç½‘äº§å“ä¸­ï¼Œå¤šå¤šå°‘å°‘éƒ½ä¼šæ¥è§¦åˆ°å¾®ä¿¡çš„å¼€å‘ä½“ç³»ã€‚<br>å› ä¸ºè¿™æ˜¯ä¸€ä¸ªåºå¤§çš„æµé‡å…¥å£å•Šã€‚</p>
<h2 id="ä¸‰ä¸ªå¹³å°"><a href="#ä¸‰ä¸ªå¹³å°" class="headerlink" title="ä¸‰ä¸ªå¹³å°"></a>ä¸‰ä¸ªå¹³å°</h2><p><img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/post/yz-share-about-wxapp--cencept/F0C87F9DD75168C4C99AC1BDB4C7AAD4.jpg" alt="ä¸‰ä¸ªå¹³å°"></p>
<p>åœ¨æ¥è§¦å¾®ä¿¡çš„å¼€å‘ä½“ç³»ä¸­ï¼Œæ¥è§¦æœ€å¤šçš„æ˜¯è¿™ä¸‰ä¸ªå¹³å°ã€‚<br>æˆ‘ä»¬ç«™åœ¨ä¸€ä¸ªæ›´é«˜çš„ç»´åº¦æ¥çœ‹ï¼Œå°±çŸ¥é“å°ç¨‹åºå¤„äºå¾®ä¿¡å¼€å‘ä½“ç³»ä¸­çš„å“ªä¸ªä½ç½®äº†ã€‚</p>
<h3 id="å¼€æ”¾å¹³å°"><a href="#å¼€æ”¾å¹³å°" class="headerlink" title="å¼€æ”¾å¹³å°"></a>å¼€æ”¾å¹³å°</h3><p>å¼€æ”¾å¹³å°ä¸‹æä¾›äº†ä»¥ä¸‹æ”¯æŒï¼š</p>
<ul>
<li><strong>å¾®ä¿¡è´¦å·ç™»å½•</strong>ï¼šè®©ä½ çš„åº”ç”¨æ¥å…¥å¾®ä¿¡è´¦å·ä½“ç³»ã€‚</li>
<li><strong>å¾®ä¿¡åˆ†äº«ä¸æ”¶è—åŠŸèƒ½</strong>ï¼šè¿™ä¸ªç›®å‰åœ¨ç§»åŠ¨åº”ç”¨ç‰¹æœ‰ï¼Œå¯ä»¥åœ¨ APP ä¸­æ‰èµ·å¾®ä¿¡åˆ†äº«ä¸æ”¶è—ã€‚</li>
<li><strong>å¾®ä¿¡æ™ºèƒ½æ¥å£</strong>ï¼šæ”¯æŒè°ƒç”¨å¾®ä¿¡å›¾åƒã€è¯­éŸ³ç­‰æ™ºèƒ½è¯†åˆ«æ¥å£ã€‚</li>
<li><strong>å¾®ä¿¡æ”¯ä»˜</strong>ï¼šè°ƒç”¨å¾®ä¿¡æ”¯ä»˜æ¥å£</li>
<li><strong>ç¬¬ä¸‰æ–¹å¹³å°</strong>ï¼šæ‹¥æœ‰ç¬¬ä¸‰æ–¹å¹³å°èµ„æ ¼ä¹‹åï¼Œå°±èƒ½å¸®åŠ©æˆæƒç”¨æˆ·å®ç°å…¬ä¼—å·å’Œå°ç¨‹åºçš„ä»£å¼€å‘æœåŠ¡äº†ã€‚åœ¨å…¬ä¼—å·çº¢åˆ©æ—¶ä»£ï¼Œé€šè¿‡è¯¥å¹³å°å°±å‚¬ç”Ÿäº†ä¸€å¤§æ³¢å¾®ä¿¡å…¬ä¼—è´¦å·ç¬¬ä¸‰æ–¹ç®¡ç†å¹³å°ã€‚</li>
</ul>
<p>æ ¹æ®ç›®çš„ä¸åŒï¼Œä½ å¯èƒ½è¦ç”³è¯·ä¸åŒçš„åº”ç”¨ï¼š</p>
<ul>
<li><strong>ç½‘ç«™åº”ç”¨</strong></li>
<li><strong>ç§»åŠ¨åº”ç”¨</strong></li>
<li><strong>ç¬¬ä¸‰æ–¹å¹³å°</strong></li>
</ul>
<h3 id="å…¬ä¼—å¹³å°"><a href="#å…¬ä¼—å¹³å°" class="headerlink" title="å…¬ä¼—å¹³å°"></a>å…¬ä¼—å¹³å°</h3><p>å¾®ä¿¡æ˜¯ 2011 å¹´ 1 æœˆæ¨å‡ºçš„ï¼Œè€Œå…¬ä¼—å¹³å°æ˜¯  2012 å¹´ 8 æœˆæ¨å‡ºçš„ã€‚<br>å…¬ä¼—å¹³å°çš„æ¨å‡ºï¼Œå¸¦æ¥äº†ä¸€ä¸ªç»§å¾®åšä¹‹åçš„æ–°çº¢åˆ©æ—¶ä»£ã€‚å¤§é‡çš„ä¼ä¸šã€åª’ä½“ã€å…¬å…±æœºæ„ã€æ˜æ˜Ÿåäººã€ä¸ªäººç”¨æˆ·éƒ½çº·çº·è¿›å†›å…¬ä¼—å¹³å°ã€‚<br>éœ€è¦ææ¸…æ¥šçš„ä¸€ä¸ªæ¦‚å¿µæ˜¯ï¼Œèµ·åˆå¹¶æ²¡æœ‰ã€Œè®¢é˜…å·ã€ã€ã€ŒæœåŠ¡å·ã€ã€ã€Œä¼ä¸šå·ã€ä¹‹åˆ†ã€‚<br>å…¬ä¼—å¹³å°æ¨å‡ºä¹‹åï¼Œåœ¨ 2013 å¹´ 8 æœˆçš„æ—¶å€™åˆ†æˆè®¢é˜…å·å’ŒæœåŠ¡å·ï¼Œç„¶ååœ¨ 2014 å¹´ 9 æœˆçš„æ—¶å€™æ–°å¢äº†ä¼ä¸šå·ã€‚<br>æ‰€ä»¥æˆ‘ä»¬æ‰€è¯´çš„ã€Œå…¬ä¼—å·ã€ç»Ÿç§°äº†ã€Œè®¢é˜…å·ã€ã€ã€ŒæœåŠ¡å·ã€ã€ã€Œä¼ä¸šå·ã€ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬åœ¨å…¬ä¼—å¹³å°ï¼Œæ ¹æ®è‡ªèº«æƒ…å†µï¼Œç”³è¯·ä»¥ä¸‹å‡ ç±»è´¦å·ï¼š</p>
<ul>
<li><strong>è®¢é˜…å·</strong>ï¼šåå‘æä¾›ä¼ æ’­æœåŠ¡ï¼Œæ¯å¤©å¯æ¨é€ä¸€æ¡æ¶ˆæ¯ï¼Œä½†æ˜¯å¼€æ”¾çš„åŠŸèƒ½ç›¸å¯¹æœåŠ¡å·æ¥è¯´æœ‰é™ã€‚</li>
<li><strong>æœåŠ¡å·</strong>ï¼šåå‘æä¾›åŠŸèƒ½æœåŠ¡ï¼Œæ¯æœˆå¯æ¨é€å››æ¡æ¶ˆæ¯ï¼Œå¼€æ”¾å‡ºäº†æ›´å¤šé«˜çº§åŠŸèƒ½ã€‚</li>
<li><strong>ä¼ä¸šå·</strong>ï¼šåå‘å‘˜å·¥ç®¡ç†ã€‚</li>
<li><strong>å°ç¨‹åº</strong>ï¼šå—¯ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬ä»Šå¤©çš„ä¸»é¢˜ã€‚å°ç¨‹åºå¯ä»¥åœ¨å¾®ä¿¡å†…è¢«ä¾¿æ·åœ°è·å–å’Œä¼ æ’­ï¼ŒåŒæ—¶å…·æœ‰å‡ºè‰²çš„ä½¿ç”¨ä½“éªŒã€‚</li>
</ul>
<h3 id="å•†æˆ·å¹³å°"><a href="#å•†æˆ·å¹³å°" class="headerlink" title="å•†æˆ·å¹³å°"></a>å•†æˆ·å¹³å°</h3><p>å¦‚æœä½ éœ€è¦æ‹¥æœ‰å¾®ä¿¡æ”¯ä»˜èƒ½åŠ›ï¼Œé¦–å…ˆè¦æ³¨å†Œå•†æˆ·å¹³å°ã€‚<br>åœ¨æ‹¥æœ‰å¾®ä¿¡æ”¯ä»˜èµ„æ ¼ä¹‹åï¼Œé™¤äº†å¯ä»¥åœ¨å¼€å‘è¿‡ç¨‹ä¸­é€šè¿‡æ¥å£è°ƒç”¨ï¼Œå”¤èµ·å¾®ä¿¡æ”¯ä»˜ä»¥å¤–ã€‚<br>åœ¨çº¿ä¸‹è¿˜å¯ä»¥å®ç°æ‰«ç æ”¯ä»˜ã€åˆ·å¡æ”¯ä»˜ç­‰åœºæ™¯ã€‚</p>
<h2 id="è´¦å·ä½“ç³»"><a href="#è´¦å·ä½“ç³»" class="headerlink" title="è´¦å·ä½“ç³»"></a>è´¦å·ä½“ç³»</h2><p><img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/post/yz-share-about-wxapp--cencept/ADD94BAC954A36120ADB41E7A8546FCB.jpg" alt="å¾®ä¿¡è´¦å·ä½“ç³»"></p>
<p>åœ¨æ¥å…¥å¾®ä¿¡è´¦å·çš„æ—¶å€™ï¼Œåœ¨æˆ‘ä»¬ç”³è¯·çš„åº”ç”¨ï¼ˆç½‘ç«™åº”ç”¨ã€ç§»åŠ¨åº”ç”¨ã€å…¬ä¼—å·ã€å°ç¨‹åºï¼‰ï¼Œå¯¹äºç”¨æˆ·éƒ½æœ‰ä¸€ä¸ª OpenIDï¼Œä½†æ˜¯åŒä¸ªç”¨æˆ·åœ¨å¤šä¸ªåº”ç”¨ä¸‹çš„ OpenID æ˜¯ä¸ä¸€æ ·çš„ã€‚<br>è€Œå¦‚æœæƒ³æ‰“é€šå¤šä¸ªåº”ç”¨çš„ç”¨æˆ·çš„è¯ï¼Œåšæ³•å°±æ˜¯æ³¨å†Œå¼€æ”¾å¹³å°è´¦å·ï¼Œç„¶åæŠŠå¤šä¸ªåº”ç”¨ç»‘å®šåˆ°åŒä¸€ä¸ªå¼€æ”¾å¹³å°è´¦å·ä¸‹ï¼Œè¿™æ ·å°±èƒ½è·å– UnionIDã€‚</p>
<p>è€Œå°ç¨‹åºå¯¹äº UnionID æœ‰ä¸€ä¸ªç‰¹åˆ«æ³¨æ„çš„åœ°æ–¹ï¼š</p>
<p><img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/post/yz-share-about-wxapp--cencept/EB40AFD817F2807B2A1626FACF25FE7C.jpg" alt="UnionID æœºåˆ¶"></p>
<p>å°ç¨‹åºä¸­ï¼Œåœ¨ç»‘å®šåŒä¸€ä¸ªå¼€æ”¾å¹³å°è´¦å·çš„å‰æä¸‹ã€‚å¦‚æœå…¶ä»–ç›¸åŒä¸»ä½“çš„åº”ç”¨è´¦å·è¢«ç”¨æˆ·æˆæƒè¿‡ä¹‹åï¼Œåœ¨å°ç¨‹åºä¸­å°±æ— éœ€å†æ¬¡æˆæƒï¼Œç›´æ¥è·å– UnionIDï¼ˆæ­£å¸¸æƒ…å†µä¸‹ï¼Œè·å– UnionID éœ€è¦ç”¨æˆ·æˆæƒçš„ï¼‰ã€‚</p>
<h2 id="ç›¸åŒä¸»ä½“"><a href="#ç›¸åŒä¸»ä½“" class="headerlink" title="ç›¸åŒä¸»ä½“"></a>ç›¸åŒä¸»ä½“</h2><p>é‚£ä¹ˆã€Œç›¸åŒä¸»ä½“ã€æ˜¯ä»€ä¹ˆæ¦‚å¿µï¼Ÿ<br>åœ¨æˆ‘ä»¬æ³¨å†Œåº”ç”¨ä¹‹åï¼Œè¦çœŸæ­£éƒ¨ç½²åˆ°çº¿ä¸Šä¹‹å‰ï¼Œéƒ½éœ€è¦è¿›è¡Œã€Œè®¤è¯ä¸»ä½“ã€çš„æ­¥éª¤ã€‚<br>å¯¹äºä¸ªäººæ¥è¯´ï¼Œä¸»ä½“å°±æ˜¯ä½ æœ¬äººï¼Œé€šè¿‡èº«ä»½è¯æ ‡è®°å”¯ä¸€æ€§ã€‚<br>è€Œå¯¹äºä¼ä¸šæ¥è¯´ï¼Œä¸»ä½“å°±æ˜¯ä¼ä¸šæœ¬èº«ï¼Œé€šè¿‡è¥ä¸šæ‰§ç…§æ¥æ ‡è®°å”¯ä¸€æ€§ã€‚</p>
<p><img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/post/yz-share-about-wxapp--cencept/0ABA321D4E60DC52F7B7F9DB8D444B6C.jpg" alt="ç›¸åŒä¸»ä½“"></p>
<p>åœ¨ä»»ä½•ä¸€ä¸ªä»¥ä¸Šçº¿çš„å…¬ä¼—å·æˆ–è€…å°ç¨‹åºä¸­çš„è¯¦ç»†ä¿¡æ¯ï¼Œéƒ½å¯ä»¥æŸ¥çœ‹å¾—åˆ°æœ¬ä½“ä¿¡æ¯ã€‚</p>
<h1 id="å¾®ä¿¡å°ç¨‹åºçš„èƒ½åŠ›"><a href="#å¾®ä¿¡å°ç¨‹åºçš„èƒ½åŠ›" class="headerlink" title="å¾®ä¿¡å°ç¨‹åºçš„èƒ½åŠ›"></a>å¾®ä¿¡å°ç¨‹åºçš„èƒ½åŠ›</h1><p>ä» 2016 å¹´åº•å‘å¸ƒçš„å°ç¨‹åºï¼Œåœ¨ 2017 å¹´å¿«é€Ÿæ¨è¿›ï¼Œæ¯ä¸ªæœˆéƒ½ä¼šæœ‰è¿­ä»£ï¼Œè€Œä¸”å¤§éƒ¨åˆ†æ›´æ–°å‘å¸ƒçš„æ—¶é—´éƒ½åœ¨å‡Œæ™¨ã€‚<br>åœ¨æ­¤å¿ƒç—›å¾®ä¿¡å°ç¨‹åºå›¢é˜Ÿ 10 ç§’é’Ÿã€‚<br>ç„¶åæˆ‘ä»¬ä»æˆªæ­¢ 8æœˆ18æ—¥ å›é¡¾å°†è¿‘ä¸€å¹´çš„æ—¶é—´ï¼Œå°ç¨‹åºçš„æ›´æ–°è¿­ä»£æ¥æ„Ÿå—å°ç¨‹åºå…·å¤‡å“ªäº›èƒ½åŠ›ã€‚</p>
<p><img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/post/yz-share-about-wxapp--cencept/2EC3DDD2B7877249747FB6CADE85C9C4.png" alt="å°ç¨‹åºæ›´æ–°å›é¡¾"></p>
<h1 id="æ•°æ®åˆ†æ"><a href="#æ•°æ®åˆ†æ" class="headerlink" title="æ•°æ®åˆ†æ"></a>æ•°æ®åˆ†æ</h1><p><img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/post/yz-share-about-wxapp--cencept/1951C347D0577BA466B972987B288CAE.png" alt="æ•°æ®åˆ†æ"></p>
<p>å¯¹äºæ•°æ®åˆ†æçš„éœ€æ±‚ï¼Œå…¶å®æˆ‘ä»¬å¯ä»¥æœ‰å¾ˆå¤šé€‰æ‹©ã€‚</p>
<p><strong>ã€å°ç¨‹åºåå°ã€‘</strong><br>åœ¨å°ç¨‹åºçš„åå°ï¼Œé™¤äº†å¯ä»¥çœ‹åˆ°å¸¸è§ç»´åº¦çš„è®¿é—®æ•°æ®ä»¥å¤–ï¼Œè¿˜æ”¯æŒæ”¶é›†è‡ªå®šä¹‰äº‹ä»¶ã€‚<br>å¹¶ä¸”è¿˜æä¾›äº† APIï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨å†…éƒ¨çš„ç®¡ç†åå°ä¸­æ”¶é›†è¿™äº›æ•°æ®ï¼Œè¿›è¡Œåˆ†æå’Œå±•ç¤ºã€‚</p>
<p><strong>ã€å®˜æ–¹å°ç¨‹åºã€‘</strong><br>æˆ‘ä»¬å¯ä»¥åœ¨å¾®ä¿¡çš„å°ç¨‹åºå…¥å£æœç´¢ï¼šã€Šå°ç¨‹åºæ•°æ®åŠ©æ‰‹ã€‹<br>è¿™æ˜¯å®˜æ–¹å¼€å‘çš„åœ¨ç§»åŠ¨ç«¯æŸ¥çœ‹å°ç¨‹åºè¿è¥æ•°æ®çš„å°ç¨‹åºã€‚</p>
<p><strong>ã€ç¬¬ä¸‰æ–¹å¹³å°ã€‘</strong><br>ä»¥ä¸‹æ˜¯æ”¶é›†çš„ä¸€äº›æä¾›æ•°æ®ç›¸å…³æœåŠ¡çš„ç¬¬ä¸‰æ–¹å¹³å° (è¿˜æ²¡æœ‰éªŒè¯å¯ç”¨æ€§ï¼Œéœ€è¦è‡ªè¡Œåˆ¤æ–­)ï¼š</p>
<ul>
<li><a href="https://www.talkingdata.com/" target="_blank" rel="external">TalkingData</a></li>
<li><a href="http://www.aldwx.com/" target="_blank" rel="external">é˜¿æ‹‰ä¸</a></li>
<li>å‹ç›Ÿï¼šç›®å‰è¿˜æ‰¾ä¸åˆ°æ”¯æŒå¾®ä¿¡å°ç¨‹åºçš„ SDKã€‚</li>
</ul>
<p><strong>ã€æ•°æ®åŸ‹ç‚¹ã€‘</strong><br>å¯¹äºæ•°æ®åŸ‹ç‚¹éœ€æ±‚ï¼Œä»¥ä¸‹æ˜¯æ”¶é›†çš„ä¸€äº› Saas æœåŠ¡(è¿˜æ²¡æœ‰éªŒè¯å¯ç”¨æ€§ï¼Œéœ€è¦è‡ªè¡Œåˆ¤æ–­)ï¼š</p>
<ul>
<li><a href="http://developer.qq.com/wiki/mta/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E6%8E%A5%E5%85%A5/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E6%8E%A5%E5%85%A5/%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E6%8E%A5%E5%85%A5.html" target="_blank" rel="external">è…¾è®¯ MTA</a></li>
<li><a href="https://growingio.kf5.com/hc/kb/section/1007183/" target="_blank" rel="external">GrowingIO</a></li>
</ul>
<h1 id="ç¤¾åŒºä¸èµ„æº"><a href="#ç¤¾åŒºä¸èµ„æº" class="headerlink" title="ç¤¾åŒºä¸èµ„æº"></a>ç¤¾åŒºä¸èµ„æº</h1><p><img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/post/yz-share-about-wxapp--cencept/9628CBA157FD3EBF8DA6AD6E63D574AB.png" alt="èµ„æº"></p>
<p>æˆ‘ä»¬éœ€è¦å…³æ³¨å°ç¨‹åºç”Ÿæ€åœˆçš„åŠ¨æ€ï¼Œé€šè¿‡å…³æ³¨ä¸€äº›åª’ä½“ã€ç¤¾åŒºï¼Œæ˜¯å¾ˆæœ‰ç”¨çš„ã€‚</p>
<ul>
<li><a href="https://github.com/justjavac/awesome-wechat-weapp" target="_blank" rel="external">awesome-wxapp</a>: justjavac åˆ›å»ºçš„ github ä»“åº“ï¼Œæ”¶é›†äº†å¤§é‡æœ‰å…³å°ç¨‹åºçš„èµ„æºã€‚</li>
<li>çŸ¥æ™“ç¨‹åºï¼šæ˜¯çˆ±èŒƒå„¿æ——ä¸‹ä¸“æ³¨å°ç¨‹åºç”Ÿæ€çš„å“ç‰Œï¼Œä¼šæä¾›å¾ˆå¤šä¸é”™çš„å°ç¨‹åºå’¨è¯¢ã€‚</li>
<li><a href="http://www.wxapp-union.com/" target="_blank" rel="external">å¾®ä¿¡å°ç¨‹åºè”ç›Ÿ</a>ï¼šä¸€ä¸ªç¤¾åŒºç½‘ç«™ï¼Œæœ‰å¤§é‡çš„æŠ€æœ¯æ•™ç¨‹ï¼Œä»¥åŠä¼—å¤šå¼€å‘è€…é‡åˆ°çš„å‘ã€‚</li>
<li><a href="https://mp.weixin.qq.com/debug/wxadoc/introduction/index.html?t=1504102317" target="_blank" rel="external">å®˜æ–¹æ–‡æ¡£</a>ï¼šå†è€…å°±æ˜¯å¾®ä¿¡çš„å®˜æ–¹æ–‡æ¡£äº†ã€‚è®²çœŸï¼Œè¿™æ˜¯çœ‹è¿‡å¾®ä¿¡ä¸­æœ€è‰¯å¿ƒçš„å¼€å‘æ–‡æ¡£ã€‚</li>
</ul>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åœ¨ 2016 å¹´ 9 æœˆ 23 æ—¥ å¾®ä¿¡å°ç¨‹åºå†…æµ‹å¼€å§‹ä»¥æ¥ï¼Œæœ‰èµçš„äº§å“ä¸æŠ€æœ¯ä¸€ç›´ç´§è·Ÿç€å°ç¨‹åºçš„æ­¥ä¼ã€‚å¹¶ä¸”åœ¨ 2017å¹´1æœˆ9æ—¥ å¾®ä¿¡å°ç¨‹åºå‘å¸ƒçš„åŒæ—¶ä¸Šçº¿äº†æœ‰èµå¾®å•†åŸå°ç¨‹åºå’Œæœ‰èµç²¾é€‰å°ç¨‹åºã€‚å¹¶ä¸”ç´§è·Ÿç€å¼€æºäº†å°ç¨‹åºçš„ UI åº“ï¼š&lt;a href=&quot;https://github.c
    
    </summary>
    
      <category term="æ¬ç –ç å†œ" scheme="http://huang-jerryc.com/categories/%E6%90%AC%E7%A0%96%E7%A0%81%E5%86%9C/"/>
    
    
      <category term="å°ç¨‹åº" scheme="http://huang-jerryc.com/tags/%E5%B0%8F%E7%A8%8B%E5%BA%8F/"/>
    
  </entry>
  
  <entry>
    <title>åŠ æ·±å¯¹ JavaScript This çš„ç†è§£</title>
    <link href="http://huang-jerryc.com/2017/07/15/understand-this-of-javascript/"/>
    <id>http://huang-jerryc.com/2017/07/15/understand-this-of-javascript/</id>
    <published>2017-07-15T02:40:00.000Z</published>
    <updated>2017-07-16T03:54:29.000Z</updated>
    
    <content type="html"><![CDATA[<p>æˆ‘ç›¸ä¿¡ä½ å·²ç»çœ‹è¿‡å¾ˆå¤šå…³äº JavaScript çš„ <code>this</code>  çš„è°ˆè®ºäº†ï¼Œæ—¢ç„¶ä½ ç‚¹è¿›æ¥äº†ï¼Œä¸å¦¨ç»§ç»­çœ‹ä¸‹å»ï¼Œçœ‹æ˜¯å¦èƒ½å¸®ä½ åŠ æ·±å¯¹ <code>this</code> çš„ç†è§£ã€‚</p>
<p>æœ€è¿‘åœ¨çœ‹ <a href="https://github.com/getify/You-Dont-Know-JS" target="_blank" rel="external">ã€ŠYou Dont Know JSã€‹</a> è¿™æœ¬ä¹¦ï¼Œä¸å¾—æ„Ÿå¹ï¼Œå°±ç®—ç”¨äº† JS å¾ˆå¤šå¹´çš„è€å‰ç«¯æ¥çœ‹è¿™æœ¬ä¹¦ï¼Œæˆ‘è§‰å¾—è¿˜æ˜¯ä¼šæœ‰ä¸å°‘çš„æ”¶è·ã€‚</p>
<p>å…¶ä¸­å…³äº <code>this</code> çš„è®²è§£ï¼Œæ›´æ˜¯åŠ æ·±äº†æˆ‘å¯¹ <code>this</code> çš„ç†è§£ï¼Œæ•…æ•´ç†çŸ¥è¯†ç‚¹ï¼Œå†åŠ ä¸Šè‡ªèº«çš„ç†è§£ï¼Œä»¥è‡ªå·±çš„è¯­è¨€æ¥æè¿°ã€‚<br>å¯¹è¯»è€…æ¥è¯´ï¼Œç®—æ˜¯äºŒæ‰‹çŸ¥è¯†ï¼Œè¿™æœ¬ä¹¦æ˜¯å¼€æºçš„ï¼Œå¯ä»¥åˆ°æœ¬ä¹¦çš„ Github é¡¹ç›®åœ°å€å­¦ä¹ ä¸€æ‰‹çš„çŸ¥è¯†ã€‚</p>
<p>é¦–å…ˆæœ‰ä¸€å¥å¤§å®¶éƒ½æ˜ç™½çš„è¯ï¼Œæˆ‘è¿˜æ˜¯è¦å¼ºè°ƒä¸€éï¼š<br><strong>ã€Œ<code>this</code> æ˜¯åœ¨å‡½æ•°è¢«è°ƒç”¨æ—¶å‘ç”Ÿçš„ç»‘å®šï¼Œå®ƒæŒ‡å‘ä»€ä¹ˆå®Œå…¨å–å†³äºå‡½æ•°åœ¨å“ªé‡Œè¢«è°ƒç”¨ã€‚ã€</strong></p>
<p>è¿™å¥è¯å¾ˆé‡è¦ï¼Œè¿™æ˜¯ç†è§£ <code>this</code> åŸç†çš„åŸºç¡€ã€‚<br>è€Œåœ¨è®²è§£ <code>this</code> ä¹‹å‰ï¼Œå…ˆè¦ç†è§£ä¸€ä¸‹ä½œç”¨åŸŸçš„ç›¸å…³æ¦‚å¿µã€‚</p>
<h1 id="ã€Œè¯æ³•ä½œç”¨åŸŸã€ä¸ã€ŒåŠ¨æ€ä½œç”¨åŸŸã€"><a href="#ã€Œè¯æ³•ä½œç”¨åŸŸã€ä¸ã€ŒåŠ¨æ€ä½œç”¨åŸŸã€" class="headerlink" title="ã€Œè¯æ³•ä½œç”¨åŸŸã€ä¸ã€ŒåŠ¨æ€ä½œç”¨åŸŸã€"></a>ã€Œè¯æ³•ä½œç”¨åŸŸã€ä¸ã€ŒåŠ¨æ€ä½œç”¨åŸŸã€</h1><p>é€šå¸¸æ¥è¯´ï¼Œä½œç”¨åŸŸä¸€å…±æœ‰ä¸¤ç§ä¸»è¦çš„å·¥ä½œæ¨¡å‹ã€‚</p>
<ul>
<li>è¯æ³•ä½œç”¨åŸŸ</li>
<li>åŠ¨æ€ä½œç”¨åŸŸ</li>
</ul>
<p>è¯æ³•ä½œç”¨åŸŸæ˜¯å¤§å¤šæ•°ç¼–ç¨‹è¯­è¨€æ‰€é‡‡ç”¨çš„æ¨¡å¼ï¼Œè€ŒåŠ¨æ€ä½œç”¨åŸŸä»æœ‰ä¸€äº›ç¼–ç¨‹è¯­è¨€åœ¨ç”¨ï¼Œä¾‹å¦‚ Bash è„šæœ¬ã€‚<br>è€Œ JavaScript å°±æ˜¯é‡‡ç”¨çš„è¯æ³•ä½œç”¨åŸŸï¼Œä¹Ÿå°±æ˜¯åœ¨ç¼–ç¨‹é˜¶æ®µï¼Œä½œç”¨åŸŸå°±å·²ç»æ˜ç¡®ä¸‹æ¥äº†ã€‚</p>
<p>æ€è€ƒä¸‹é¢ä»£ç ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(a);   <span class="comment">// è¾“å‡º 2</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">bar</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">let</span> a = <span class="number">3</span>;</div><div class="line">  foo();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> a = <span class="number">2</span>;</div><div class="line"></div><div class="line">bar()</div></pre></td></tr></table></figure>
<p>å› ä¸º JavaScript æ‰€ç”¨çš„æ˜¯è¯æ³•ä½œç”¨åŸŸï¼Œè‡ªç„¶ <code>foo()</code> å£°æ˜çš„é˜¶æ®µï¼Œå°±å·²ç»ç¡®å®šäº†å˜é‡ <code>a</code> çš„ä½œç”¨åŸŸäº†ã€‚</p>
<p>å€˜è‹¥ï¼ŒJavaScript æ˜¯é‡‡ç”¨çš„åŠ¨æ€ä½œç”¨åŸŸï¼Œ<code>foo()</code> ä¸­æ‰“å°çš„å°†æ˜¯ <code>3</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(a);   <span class="comment">// è¾“å‡º 3 ï¼ˆä¸æ˜¯ 2ï¼‰</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">bar</span>(<span class="params"></span>)</span>&#123;</div><div class="line">  <span class="keyword">let</span> a = <span class="number">3</span>;</div><div class="line">  foo();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> a = <span class="number">2</span>;</div><div class="line"></div><div class="line">bar()</div></pre></td></tr></table></figure>
<p>è€Œ JavaScript çš„ <code>this</code> æœºåˆ¶è·ŸåŠ¨æ€ä½œç”¨åŸŸå¾ˆç›¸ä¼¼ï¼Œæ˜¯åœ¨è¿è¡Œæ—¶åœ¨è¢«è°ƒç”¨çš„åœ°æ–¹åŠ¨æ€ç»‘å®šçš„ã€‚</p>
<h1 id="this-çš„å››ç§ç»‘å®šè§„åˆ™"><a href="#this-çš„å››ç§ç»‘å®šè§„åˆ™" class="headerlink" title="this çš„å››ç§ç»‘å®šè§„åˆ™"></a>this çš„å››ç§ç»‘å®šè§„åˆ™</h1><p>åœ¨ JavaScript ä¸­ï¼Œå½±å“ this æŒ‡å‘çš„ç»‘å®šè§„åˆ™æœ‰å››ç§ï¼š</p>
<ul>
<li>é»˜è®¤ç»‘å®š</li>
<li>éšå¼ç»‘å®š</li>
<li>æ˜¾å¼ç»‘å®š</li>
<li>new ç»‘å®š</li>
</ul>
<h2 id="é»˜è®¤ç»‘å®š"><a href="#é»˜è®¤ç»‘å®š" class="headerlink" title="é»˜è®¤ç»‘å®š"></a>é»˜è®¤ç»‘å®š</h2><p>è¿™æ˜¯æœ€ç›´æ¥çš„ä¸€ç§æ–¹å¼ï¼Œå°±æ˜¯ä¸åŠ ä»»ä½•çš„ä¿®é¥°ç¬¦ç›´æ¥è°ƒç”¨å‡½æ•°ï¼Œå¦‚ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>.a)   <span class="comment">// è¾“å‡º a</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> a = <span class="number">2</span>;  <span class="comment">//  å˜é‡å£°æ˜åˆ°å…¨å±€å¯¹è±¡ä¸­</span></div><div class="line"></div><div class="line">foo();</div></pre></td></tr></table></figure>
<p>ä½¿ç”¨ <code>var</code> å£°æ˜çš„å˜é‡ <code>a</code>ï¼Œè¢«ç»‘å®šåˆ°å…¨å±€å¯¹è±¡ä¸­ï¼Œå¦‚æœæ˜¯æµè§ˆå™¨ï¼Œåˆ™æ˜¯åœ¨ <code>window</code> å¯¹è±¡ã€‚<br><code>foo()</code> è°ƒç”¨æ—¶ï¼Œå¼•ç”¨äº†é»˜è®¤ç»‘å®šï¼Œ<code>this</code> æŒ‡å‘äº†å…¨å±€å¯¹è±¡ã€‚</p>
<h2 id="éšå¼ç»‘å®š"><a href="#éšå¼ç»‘å®š" class="headerlink" title="éšå¼ç»‘å®š"></a>éšå¼ç»‘å®š</h2><p>è¿™ç§æƒ…å†µä¼šå‘ç”Ÿåœ¨è°ƒç”¨ä½ç½®å­˜åœ¨ã€Œä¸Šä¸‹æ–‡å¯¹è±¡ã€çš„æƒ…å†µï¼Œå¦‚ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>.a);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> obj1 = &#123;</div><div class="line">  <span class="attr">a</span>: <span class="number">1</span>,</div><div class="line">  foo,</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">let</span> obj2 = &#123;</div><div class="line">  <span class="attr">a</span>: <span class="number">2</span>,</div><div class="line">  foo,</div><div class="line">&#125;</div><div class="line"></div><div class="line">obj1.foo();   <span class="comment">// è¾“å‡º 1</span></div><div class="line">obj2.foo();   <span class="comment">// è¾“å‡º 2</span></div></pre></td></tr></table></figure>
<p>å½“å‡½æ•°è°ƒç”¨çš„æ—¶å€™ï¼Œæ‹¥æœ‰ä¸Šä¸‹æ–‡å¯¹è±¡çš„æ—¶å€™ï¼Œ<code>this</code> ä¼šè¢«ç»‘å®šåˆ°è¯¥ä¸Šä¸‹æ–‡å¯¹è±¡ã€‚<br>æ­£å¦‚ä¸Šé¢çš„ä»£ç ï¼Œ<br><code>obj1.foo()</code> è¢«è°ƒç”¨æ—¶ï¼Œ<code>this</code> ç»‘å®šåˆ°äº† <code>obj1</code>,<br>è€Œ <code>obj2.foo()</code> è¢«è°ƒç”¨æ—¶ï¼Œ<code>this</code> ç»‘å®šåˆ°äº† <code>obj2</code>ã€‚</p>
<h2 id="æ˜¾å¼ç»‘å®š"><a href="#æ˜¾å¼ç»‘å®š" class="headerlink" title="æ˜¾å¼ç»‘å®š"></a>æ˜¾å¼ç»‘å®š</h2><p>è¿™ç§å°±æ˜¯ä½¿ç”¨ <code>Function.prototype</code> ä¸­çš„ä¸‰ä¸ªæ–¹æ³• <code>call()</code>, <code>apply()</code>, <code>bind()</code> äº†ã€‚<br>è¿™ä¸‰ä¸ªå‡½æ•°ï¼Œéƒ½å¯ä»¥æ”¹å˜å‡½æ•°çš„ <code>this</code> æŒ‡å‘åˆ°æŒ‡å®šçš„å¯¹è±¡ï¼Œ<br>ä¸åŒä¹‹å¤„åœ¨äºï¼Œ<code>call()</code> å’Œ <code>apply()</code> æ˜¯ç«‹å³æ‰§è¡Œå‡½æ•°ï¼Œå¹¶ä¸”æ¥å—çš„å‚æ•°çš„å½¢å¼ä¸åŒï¼š</p>
<ul>
<li><code>call(this, arg1, arg2, ...)</code></li>
<li><code>apply(this, [arg1, arg2, ...])</code></li>
</ul>
<p>è€Œ <code>bind()</code> åˆ™æ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„åŒ…è£…å‡½æ•°ï¼Œå¹¶ä¸”è¿”å›ï¼Œè€Œä¸æ˜¯ç«‹åˆ»æ‰§è¡Œã€‚</p>
<ul>
<li><code>bind(this, arg1, arg2, ...)</code></li>
</ul>
<p><code>apply()</code> æ¥æ”¶å‚æ•°çš„å½¢å¼ï¼Œæœ‰åŠ©äºå‡½æ•°åµŒå¥—å‡½æ•°çš„æ—¶å€™ï¼ŒæŠŠ <code>arguments</code> å˜é‡ä¼ é€’åˆ°ä¸‹ä¸€å±‚å‡½æ•°ä¸­ã€‚</p>
<p>æ€è€ƒä¸‹é¢ä»£ç ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>.a);  <span class="comment">// è¾“å‡º 1</span></div><div class="line">  bar.apply(&#123;<span class="attr">a</span>: <span class="number">2</span>&#125;, <span class="built_in">arguments</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">bar</span>(<span class="params">b</span>) </span>&#123;</div><div class="line">  <span class="built_in">console</span>.log(<span class="keyword">this</span>.a + b);  <span class="comment">// è¾“å‡º 5</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> a = <span class="number">1</span>;</div><div class="line">foo(<span class="number">3</span>);</div></pre></td></tr></table></figure>
<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ <code>foo()</code> å†…éƒ¨çš„ <code>this</code> éµå¾ªé»˜è®¤ç»‘å®šè§„åˆ™ï¼Œç»‘å®šåˆ°å…¨å±€å˜é‡ä¸­ã€‚<br>è€Œ <code>bar()</code> åœ¨è°ƒç”¨çš„æ—¶å€™ï¼Œè°ƒç”¨äº† <code>apply()</code> å‡½æ•°ï¼ŒæŠŠ <code>this</code> ç»‘å®šåˆ°äº†ä¸€ä¸ªæ–°çš„å¯¹è±¡ä¸­ <code>{a: 2}</code>ï¼Œè€Œä¸”åŸå°ä¸åŠ¨çš„æ¥æ”¶ <code>foo()</code> æ¥æ”¶çš„å‡½æ•°ã€‚</p>
<h2 id="new-ç»‘å®š"><a href="#new-ç»‘å®š" class="headerlink" title="new ç»‘å®š"></a>new ç»‘å®š</h2><p>æœ€åä¸€ç§ï¼Œåˆ™æ˜¯ä½¿ç”¨ <code>new</code> æ“ä½œç¬¦ä¼šäº§ç”Ÿ <code>this</code> çš„ç»‘å®šã€‚<br>åœ¨ç†è§£ <code>new</code> æ“ä½œç¬¦å¯¹ <code>this</code> çš„å½±å“ï¼Œé¦–å…ˆè¦ç†è§£ <code>new</code> çš„åŸç†ã€‚<br>åœ¨ JavaScript ä¸­ï¼Œ<code>new</code> æ“ä½œç¬¦å¹¶ä¸åƒå…¶ä»–é¢å‘å¯¹è±¡çš„è¯­è¨€ä¸€æ ·ï¼Œè€Œæ˜¯ä¸€ç§æ¨¡æ‹Ÿå‡ºæ¥çš„æœºåˆ¶ã€‚<br>åœ¨ JavaScript ä¸­ï¼Œæ‰€æœ‰çš„å‡½æ•°éƒ½å¯ä»¥è¢« <code>new</code> è°ƒç”¨ï¼Œè¿™æ—¶å€™è¿™ä¸ªå‡½æ•°ä¸€èˆ¬ä¼šè¢«ç§°ä¸ºã€Œæ„é€ å‡½æ•°ã€ï¼Œå®é™…ä¸Šå¹¶ä¸å­˜åœ¨æ‰€è°“ã€Œæ„é€ å‡½æ•°ã€ï¼Œæ›´ç¡®åˆ‡çš„ç†è§£åº”è¯¥æ˜¯å¯¹äºå‡½æ•°çš„ã€Œæ„é€ è°ƒç”¨ã€ã€‚</p>
<p>ä½¿ç”¨ <code>new</code> æ¥è°ƒç”¨å‡½æ•°ï¼Œä¼šè‡ªåŠ¨æ‰§è¡Œä¸‹é¢æ“ä½œï¼š</p>
<ol>
<li>åˆ›å»ºä¸€ä¸ªå…¨æ–°çš„å¯¹è±¡ã€‚</li>
<li>è¿™ä¸ªæ–°å¯¹è±¡ä¼šè¢«æ‰§è¡Œ [[Prototype]] è¿æ¥ã€‚</li>
<li>è¿™ä¸ªæ–°å¯¹è±¡ä¼šç»‘å®šåˆ°å‡½æ•°è°ƒç”¨çš„ thisã€‚</li>
<li>å¦‚æœå‡½æ•°æ²¡æœ‰è¿”å›å…¶ä»–å¯¹è±¡ï¼Œé‚£ä¹ˆ new è¡¨è¾¾å¼ä¸­çš„å‡½æ•°è°ƒç”¨ä¼šè‡ªåŠ¨è¿”å›è¿™ä¸ªæ–°å¯¹è±¡ã€‚</li>
</ol>
<p>æ‰€ä»¥å¦‚æœ <code>new</code> æ˜¯ä¸€ä¸ªå‡½æ•°çš„è¯ï¼Œä¼šæ˜¯è¿™æ ·å­çš„ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">New</span>(<span class="params">Constructor, ...args</span>)</span>&#123;</div><div class="line">    <span class="keyword">let</span> obj = &#123;&#125;;   <span class="comment">// åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡</span></div><div class="line">    <span class="built_in">Object</span>.setPrototypeOf(obj, Constructor.prototype);  <span class="comment">// è¿æ¥æ–°å¯¹è±¡ä¸å‡½æ•°çš„åŸå‹</span></div><div class="line">    <span class="keyword">return</span> Constructor.apply(obj, args) || obj;   <span class="comment">// æ‰§è¡Œå‡½æ•°ï¼Œæ”¹å˜ this æŒ‡å‘æ–°çš„å¯¹è±¡</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Foo</span>(<span class="params">a</span>)</span>&#123;</div><div class="line">    <span class="keyword">this</span>.a = a;</div><div class="line">&#125;</div><div class="line"></div><div class="line">New(Foo, <span class="number">1</span>);  <span class="comment">// Foo &#123; a: 1 &#125;</span></div></pre></td></tr></table></figure>
<p>æ‰€ä»¥ï¼Œåœ¨ä½¿ç”¨ <code>new</code> æ¥è°ƒç”¨å‡½æ•°æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šæ„é€ ä¸€ä¸ªæ–°å¯¹è±¡å¹¶æŠŠå®ƒç»‘å®šåˆ°å‡½æ•°è°ƒç”¨ä¸­çš„ <code>this</code> ä¸Šã€‚</p>
<h1 id="ä¼˜å…ˆçº§"><a href="#ä¼˜å…ˆçº§" class="headerlink" title="ä¼˜å…ˆçº§"></a>ä¼˜å…ˆçº§</h1><p>å¦‚æœä¸€ä¸ªä½ç½®å‘ç”Ÿäº†å¤šæ¡æ”¹å˜ this çš„è§„åˆ™ï¼Œé‚£ä¹ˆä¼˜å…ˆçº§æ˜¯å¦‚ä½•çš„å‘¢ï¼Ÿ</p>
<p>çœ‹å‡ æ®µä»£ç ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// æ˜¾å¼ç»‘å®š &gt; éšå¼ç»‘å®š</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.a);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> obj1 = &#123;</div><div class="line">    <span class="attr">a</span>: <span class="number">2</span>,</div><div class="line">    foo,</div><div class="line">&#125;</div><div class="line"></div><div class="line">obj1.foo();     <span class="comment">// è¾“å‡º 2</span></div><div class="line">obj1.foo.call(&#123;<span class="attr">a</span>: <span class="number">1</span>&#125;);      <span class="comment">// è¾“å‡º 1</span></div></pre></td></tr></table></figure>
<p>è¿™è¯´æ˜ã€Œæ˜¾å¼ç»‘å®šã€çš„ä¼˜å…ˆçº§å¤§äºã€Œéšå¼ç»‘å®šã€</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// new ç»‘å®š &gt; æ˜¾å¼ç»‘å®š</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params">a</span>) </span>&#123;</div><div class="line">    <span class="keyword">this</span>.a = a;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> obj1 = &#123;&#125;;</div><div class="line"></div><div class="line"><span class="keyword">let</span> bar = foo.bind(obj1);</div><div class="line">bar(<span class="number">2</span>);</div><div class="line"><span class="built_in">console</span>.log(obj1); <span class="comment">// è¾“å‡º &#123;a:2&#125;</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> obj2 = <span class="keyword">new</span> bar(<span class="number">3</span>);</div><div class="line"><span class="built_in">console</span>.log(obj1); <span class="comment">// è¾“å‡º &#123;a:2&#125;</span></div><div class="line"><span class="built_in">console</span>.log(obj2); <span class="comment">// è¾“å‡º foo &#123; a: 3 &#125;</span></div></pre></td></tr></table></figure>
<p>è¿™è¯´æ˜ã€Œnew ç»‘å®šã€çš„ä¼˜å…ˆçº§å¤§äºã€Œæ˜¾å¼ç»‘å®šã€<br>è€Œã€Œé»˜è®¤ç»‘å®šã€ï¼Œæ¯«æ— ç–‘é—®æ˜¯ä¼˜å…ˆçº§æœ€ä½çš„ã€‚<br>æ‰€ä»¥ä¼˜å…ˆçº§é¡ºåºä¸ºï¼š</p>
<p><strong>ã€Œnew ç»‘å®šã€ &gt; ã€Œæ˜¾å¼ç»‘å®šã€ &gt; ã€Œéšå¼ç»‘å®šã€ &gt; ã€Œé»˜è®¤ç»‘å®šã€‚ã€</strong></p>
<h1 id="æ‰€ä»¥ï¼Œthis-åˆ°åº•æ˜¯ä»€ä¹ˆ"><a href="#æ‰€ä»¥ï¼Œthis-åˆ°åº•æ˜¯ä»€ä¹ˆ" class="headerlink" title="æ‰€ä»¥ï¼Œthis åˆ°åº•æ˜¯ä»€ä¹ˆ"></a>æ‰€ä»¥ï¼Œthis åˆ°åº•æ˜¯ä»€ä¹ˆ</h1><p><code>this</code> å¹¶ä¸æ˜¯åœ¨ç¼–å†™çš„æ—¶å€™ç»‘å®šçš„ï¼Œè€Œæ˜¯åœ¨è¿è¡Œæ—¶ç»‘å®šçš„ã€‚å®ƒçš„ä¸Šä¸‹æ–‡å–å†³äºå‡½æ•°è°ƒç”¨æ—¶çš„å„ç§æ¡ä»¶ã€‚<br><code>this</code> çš„ç»‘å®šå’Œå‡½æ•°å£°æ˜çš„ä½ç½®æ²¡æœ‰ä»»ä½•å…³ç³»ï¼Œåªå–å†³äºå‡½æ•°çš„è°ƒç”¨æ–¹å¼ã€‚<br>å½“ä¸€ä¸ªå‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œä¼šåˆ›å»ºä¸€ä¸ªã€Œæ‰§è¡Œä¸Šä¸‹æ–‡ã€ï¼Œè¿™ä¸ªä¸Šä¸‹æ–‡ä¼šåŒ…å«å‡½æ•°åœ¨å“ªé‡Œè¢«è°ƒç”¨ï¼ˆè°ƒç”¨æ ˆï¼‰ã€å‡½æ•°çš„è°ƒç”¨æ–¹å¼ã€ä¼ å…¥çš„å‚æ•°ç­‰ä¿¡æ¯ã€‚<code>this</code> å°±æ˜¯è¿™ä¸ªè®°å½•çš„ä¸€ä¸ªå±æ€§ï¼Œä¼šåœ¨å‡½æ•°æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ç”¨åˆ°ã€‚</p>
<h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><a href="https://github.com/getify/You-Dont-Know-JS/blob/master/this%20&amp;%20object%20prototypes/README.md#you-dont-know-js-this--object-prototypes" target="_blank" rel="external">ã€ŠYou Dont Know JSã€‹- this &amp; Object Prototypes</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æˆ‘ç›¸ä¿¡ä½ å·²ç»çœ‹è¿‡å¾ˆå¤šå…³äº JavaScript çš„ &lt;code&gt;this&lt;/code&gt;  çš„è°ˆè®ºäº†ï¼Œæ—¢ç„¶ä½ ç‚¹è¿›æ¥äº†ï¼Œä¸å¦¨ç»§ç»­çœ‹ä¸‹å»ï¼Œçœ‹æ˜¯å¦èƒ½å¸®ä½ åŠ æ·±å¯¹ &lt;code&gt;this&lt;/code&gt; çš„ç†è§£ã€‚&lt;/p&gt;
&lt;p&gt;æœ€è¿‘åœ¨çœ‹ &lt;a href=&quot;https://github.co
    
    </summary>
    
      <category term="æ¬ç –ç å†œ" scheme="http://huang-jerryc.com/categories/%E6%90%AC%E7%A0%96%E7%A0%81%E5%86%9C/"/>
    
    
      <category term="javascript" scheme="http://huang-jerryc.com/tags/javascript/"/>
    
  </entry>
  
  <entry>
    <title>è°ˆè°ˆåƒç´ ä»¥åŠå¾®ä¿¡å°ç¨‹åºçš„ rpx</title>
    <link href="http://huang-jerryc.com/2017/05/21/talk-about-pixel-and-rpx/"/>
    <id>http://huang-jerryc.com/2017/05/21/talk-about-pixel-and-rpx/</id>
    <published>2017-05-21T06:21:25.000Z</published>
    <updated>2020-07-21T08:12:37.393Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æœ€è¿‘åœ¨è´Ÿè´£æœ‰èµçš„æŸä¸ªä¸šåŠ¡çš„å¾®ä¿¡å°ç¨‹åºå¼€å‘ï¼Œè¿™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡ç€æ‰‹å¾®ä¿¡å°ç¨‹åºçš„å¼€å‘ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸­å‘ç°å¾®ä¿¡å°ç¨‹åºæ‰€å®šä¹‰çš„ä¸€å¥— WXSS (WeiXin Style Sheets) ä¸­æœ‰ä¸€ä¸ªæœ‰è¶£çš„é•¿åº¦å•ä½ <code>rpx</code>ï¼Œå³ responsive pixelã€‚<br>æ ¹æ®å®˜æ–¹çš„æè¿°ï¼š</p>
<blockquote>
<p>rpxï¼ˆresponsive pixelï¼‰ï¼Œ å¯ä»¥æ ¹æ®å±å¹•å®½åº¦è¿›è¡Œè‡ªé€‚åº”ã€‚è§„å®šå±å¹•å®½ä¸º750rpxã€‚å¦‚åœ¨ iPhone6 ä¸Šï¼Œå±å¹•å®½åº¦ä¸º375pxï¼Œå…±æœ‰750ä¸ªç‰©ç†åƒç´ ï¼Œåˆ™750rpx = 375px = 750ç‰©ç†åƒç´ ï¼Œ1rpx = 0.5px = 1ç‰©ç†åƒç´ ã€‚</p>
</blockquote>
<p>å¹³æ—¶æˆ‘ä»¬ä¸€èˆ¬ä¼šç”¨ <code>em</code> æˆ–è€… <code>rem</code> æ¥åšå±å¹•é€‚é…ï¼Œè€Œåœ¨å¾®ä¿¡å°ç¨‹åºä¸­ï¼Œå¯ä»¥æ–¹ä¾¿çš„å€ŸåŠ© <code>rpx</code> æ¥å®Œæˆè¿™é¡¹å·¥ä½œã€‚</p>
<p>é‚£ä¹ˆæ€ä¹ˆç†è§£ <code>rpx</code>ï¼Œè¿˜æœ‰å®ƒä¸ <code>px</code> ä¹‹é—´ä»€ä¹ˆå…³ç³»ï¼Ÿä»€ä¹ˆæ˜¯ç‰©ç†åƒç´ ï¼Ÿ<br>ä¸ºäº†æ›´å¥½ç†è§£ <code>rpx</code>ï¼Œæˆ‘æ‰“ç®—èŠèŠä¸‹é¢çš„ä¸€äº›æ¦‚å¿µï¼š</p>
<ol>
<li>åƒç´  (Pixel)</li>
<li>PPI (Pixels per inch æ¯è‹±å°ºåƒç´ )</li>
<li>DPR (Device pixel ratio)</li>
</ol>
<h1 id="åƒç´ "><a href="#åƒç´ " class="headerlink" title="åƒç´ "></a>åƒç´ </h1><p>åƒç´ ï¼Œè‹±æ–‡å•è¯ï¼špixelï¼Œæ˜¯è‹±è¯­å•è¯ ã€Œpictureã€ çš„ç®€å†™ ã€Œpixã€ï¼ŒåŠ ä¸Š ã€Œelementã€ çš„ç®€å†™ ã€Œelã€ï¼Œåˆæˆçš„è¯æ±‡ï¼Œè¡¨ç¤ºã€Œå›¾åƒå…ƒç´ ã€çš„æ„æ€ã€‚<br>ä¸€ä¸ªåƒç´ åªèƒ½è¡¨è¾¾ä¸€ä¸ªè‰²å—ï¼Œæ˜¯æ˜¾ç¤ºçš„æœ€å°çš„ä¸€ä¸ªå•å…ƒã€‚</p>
<p>è€Œåœ¨æˆ‘ä»¬å†™ä»£ç çš„æ—¶å€™ï¼Œå¯ä»¥æŠŠåƒç´ åˆ†ä¸ºä¸¤ç§ï¼š</p>
<ol>
<li>ç‰©ç†åƒç´  Physical pixels</li>
<li>é€»è¾‘åƒç´  Logical pixels</li>
</ol>
<h2 id="ç‰©ç†åƒç´ "><a href="#ç‰©ç†åƒç´ " class="headerlink" title="ç‰©ç†åƒç´ "></a>ç‰©ç†åƒç´ </h2><p>ä¹Ÿè¢«ç§°ä¸ºè®¾å¤‡åƒç´  (Device independent pixels)ï¼Œå³è®¾å¤‡åœ¨å‡ºå‚çš„æ—¶å€™å°±å·²ç»å›ºå®šäº†åƒç´ ã€‚</p>
<p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹ iPhone6 (å·¦å›¾) ä¸ iPhone6 plus (å³å›¾) çš„å®˜æ–¹æ˜¾ç¤ºå±çš„è§„æ ¼è¯´æ˜ï¼š</p>
<p><img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/post/talk-about-pixel-and-rpx/518488434BEC1074B675EB42A5A57AEF.png" alt="iPhone6 &amp; iPhone6 plus è§„æ ¼"></p>
<p>iPhone6 æ˜¯ <code>1334px x 750px</code> çš„åƒç´ åˆ†è¾¨ç‡ï¼Œæ„æ€æ˜¯å½“æ‰‹æœºç«–æ”¾çš„æ—¶å€™ï¼Œæ¨ªå‘æœ‰ 750 ä¸ªç‰©ç†åƒç´ ï¼Œçºµå‘æœ‰ 1334 ä¸ªç‰©ç†åƒç´ ã€‚</p>
<h2 id="é€»è¾‘åƒç´ "><a href="#é€»è¾‘åƒç´ " class="headerlink" title="é€»è¾‘åƒç´ "></a>é€»è¾‘åƒç´ </h2><p>åœ¨ CSS ä¸­ä¹Ÿè¢«ç§°ä¸º CSS åƒç´  (CSS pixels)ï¼Œæ˜¯ä¸º Web å¼€å‘è€…åˆ›é€ çš„ï¼Œåœ¨ CSS å’Œ JavaScript ä¸­ä½¿ç”¨çš„ä¸€ä¸ªæŠ½è±¡çš„å±‚ï¼Œæ¯ä¸€ä¸ª CSS å£°æ˜å’Œå‡ ä¹æ‰€æœ‰çš„ Javascript å±æ€§éƒ½ä½¿ç”¨ CSS åƒç´ ã€‚</p>
<p>ä¾‹å¦‚æˆ‘ä»¬å¹³æ—¶ä½¿ç”¨ Chrome çš„è®¾å¤‡è°ƒè¯•å·¥å…·çš„æ—¶å€™ï¼ŒiPhone6 æ˜¯é«˜ <code>667px</code>ï¼Œå®½æ˜¯ <code>375px</code>ï¼Œä¸è‹¹æœå®˜æ–¹çš„ <code>1334px x 750px</code>ï¼Œé•¿å®½åˆ†åˆ«å°‘äº† 2 å€ï¼Œé‚£ä¹ˆé¢ç§¯å°±å°‘äº† 4 å€ã€‚è¿™å°±æ˜¯ç»å¸¸è¯´çš„ Retina å±å¹•ç”¨å››ä¸ª(ç‰©ç†)åƒç´ è¡¨ç¤ºä¸€ä¸ª(é€»è¾‘)åƒç´ ã€‚</p>
<p><img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/post/talk-about-pixel-and-rpx/9C4CD0061C94690AF81DB8DED8F71252.png" alt="Chrome ä¸‹ iPhone6 é€»è¾‘åƒç´ "></p>
<h1 id="PPI"><a href="#PPI" class="headerlink" title="PPI"></a>PPI</h1><p>Pixels per inchï¼Œæ¯è‹±å¯¸åƒç´ ï¼Œä¹Ÿè¢«ç§°ä¸ºåƒç´ å¯†åº¦ï¼Œæ„æ€æ˜¯ä¸€è‹±å¯¸ä¸­æœ‰å¤šå°‘ä¸ªç‰©ç†åƒç´ ã€‚<br>å…¶ä¸­ 1è‹±å¯¸ (inch) = 2.54å˜ç±³ (cm)ã€‚</p>
<p>å›é¡¾ä¸€ä¸‹ä¸Šé¢çš„ iPhone6 å’Œ iPhone6 plus çš„å®˜æ–¹è§„æ ¼è¯´æ˜å›¾ï¼Œå…¶ä¸­æœ‰ <code>ppi</code> è¿™ä¸€é¡¹ï¼ŒiPhone6 æ˜¯ <code>326ppi</code>ï¼Œiphone6 plus æ˜¯ <code>401ppi</code>ã€‚</p>
<h2 id="PPI-æ€ä¹ˆç®—å‡ºæ¥çš„ï¼Ÿ"><a href="#PPI-æ€ä¹ˆç®—å‡ºæ¥çš„ï¼Ÿ" class="headerlink" title="PPI æ€ä¹ˆç®—å‡ºæ¥çš„ï¼Ÿ"></a>PPI æ€ä¹ˆç®—å‡ºæ¥çš„ï¼Ÿ</h2><p>è¦è®¡ç®—æ˜¾ç¤ºå™¨çš„æ¯è‹±å¯¸åƒç´ å€¼ï¼Œé¦–å…ˆè¦ç¡®å®šå±å¹•çš„å°ºå¯¸å’Œåˆ†è¾¨ç‡ã€‚<br>PPI è®¡ç®—å…¬å¼ï¼š</p>
<p><img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/post/talk-about-pixel-and-rpx/855BB6047CE2CA7F9DBBF1791D52C6CC.gif" alt="PPI è®¡ç®—å…¬å¼"></p>
<p>å…¶ä¸­ï¼Œ</p>
<ul>
<li>dp (device pixel) ä¸ºå±å¹•å¯¹è§’çº¿çš„åˆ†è¾¨ç‡</li>
<li>wp (width pixel) ä¸ºå±å¹•æ¨ªå‘åˆ†è¾¨ç‡</li>
<li>hp (height piexl) ä¸ºå±å¹•çºµå‘åˆ†è¾¨ç‡</li>
<li>di (device inch) ä¸ºå±å¹•å¯¹è§’çº¿çš„é•¿åº¦(å•ä½ä¸ºè‹±å¯¸)ã€‚</li>
</ul>
<p>ä»¥ iPhone6 ä¸ºä¾‹ï¼š</p>
<p><img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/post/talk-about-pixel-and-rpx/2A67EB1D8C0873E419C676DB430570C2.gif" alt="iPhone6 PPI è®¡ç®—"></p>
<p>å››èˆäº”å…¥é‚£ä¾¿æ˜¯ <code>326ppi</code> äº†ã€‚</p>
<h2 id="ç‰©ç†åƒç´ æœ‰å¤šå¤§ï¼Ÿ"><a href="#ç‰©ç†åƒç´ æœ‰å¤šå¤§ï¼Ÿ" class="headerlink" title="ç‰©ç†åƒç´ æœ‰å¤šå¤§ï¼Ÿ"></a>ç‰©ç†åƒç´ æœ‰å¤šå¤§ï¼Ÿ</h2><p>ã€Œç‰©ç†åƒç´ ã€æ˜¯æœ‰ç‰¹å®šé•¿åº¦çš„ï¼Œè¿™å–å†³äº ppi å€¼ã€‚</p>
<p>é‚£ä¹ˆå¦‚ä½•æ±‚å‡ºä¸€ä¸ªè®¾å¤‡çš„ç‰©ç†åƒç´ çš„é•¿åº¦ï¼Ÿ<br>å› ä¸ºç»å¤§å¤šæ•°è®¾å¤‡çš„ç‰©ç†åƒç´ éƒ½æ˜¯æ–¹å½¢çš„ï¼Œæˆ‘ä»¬å¯ä»¥å‡è®¾å½“å‰è®¾å¤‡çš„åƒç´ æ˜¯æ–¹å½¢çš„ã€‚<br>é‚£ä¹ˆï¼Œ</p>
<ul>
<li>iPhone6 ä¸­æ¯ä¸ªåƒç´ é•¿åº¦ï¼š1inch / 326ppi â‰ˆ 0.003 inch = 0.0762mm</li>
<li>iPhone6 plus ä¸­æ¯ä¸ªåƒç´ é•¿åº¦ï¼š1inch / 401ppi â‰ˆ 0.002 inch = 0.0508mm</li>
</ul>
<p>å¯ä»¥çœ‹å‡º iPhone6 plus çš„å±å¹•åˆ¶ä½œå·¥è‰ºæ›´åŠ ç²¾ç»†ã€‚<br>å› ä¸ºåƒç´ è¶Šå°ï¼Œé‚£ä¹ˆå•ä½é¢ç§¯å†…åƒç´ ç‚¹å°±è¶Šå¤šï¼Œæ˜¾ç¤ºçš„æ•ˆæœäººçœ¼å°±è¶Šéš¾çœ‹å‡ºæ¯›åˆºã€‚<br>ç”¨æ¥æ˜¾ç¤ºä¸€ä»½å›¾åƒçš„åƒç´ è¶Šå¤šï¼Œæ•ˆæœå°±è¶Šæ¥è¿‘ç°å®ã€‚</p>
<p>å’Œç‰©ç†åƒç´ ä¸åŒï¼Œã€Œé€»è¾‘åƒç´ ã€æ²¡æœ‰ç‰¹å®šçš„ç‰©ç†é•¿åº¦çš„ï¼Œåªæ˜¯è¡¨ç¤ºæ˜¾ç¤ºè®¾å¤‡ä¸­æœ€å°çš„æ˜¾ç¤ºå•å…ƒï¼Œä¼˜ç§€çš„æ˜¾ç¤ºè®¾å¤‡å®Œå…¨å¯ä»¥æŠŠæ˜¾ç¤ºå•å…ƒåšçš„æ›´åŠ å°ï¼Œä»¥è¾¾åˆ°æ›´å¥½çš„æ˜¾ç¤ºæ•ˆæœã€‚</p>
<h1 id="DPR"><a href="#DPR" class="headerlink" title="DPR"></a>DPR</h1><p>Device Pixel Ratioï¼Œè®¾å¤‡åƒç´ æ¯”ã€‚</p>
<p>åœ¨æ—©å…ˆçš„ç§»åŠ¨è®¾å¤‡ä¸­ï¼Œå¹¶æ²¡æœ‰ DPR çš„æ¦‚å¿µã€‚éšç€æŠ€æœ¯çš„å‘å±•ï¼Œç§»åŠ¨è®¾å¤‡çš„å±å¹•åƒç´ å¯†åº¦è¶Šæ¥è¶Šé«˜ã€‚<br>ä» iPhone4 å¼€å§‹ï¼Œè‹¹æœå…¬å¸æ¨å‡ºäº†æ‰€è°“çš„ Retina è§†ç½‘è†œå±å¹•ã€‚ä¹‹æ‰€ä»¥å«åšè§†ç½‘è†œå±å¹•ï¼Œæ˜¯å› ä¸ºå±å¹•çš„ PPI å¤ªé«˜ï¼Œäººçš„è§†ç½‘è†œæ— æ³•åˆ†è¾¨å‡ºå±å¹•ä¸Šçš„åƒç´ ç‚¹ã€‚<br>iPhone4 çš„åˆ†è¾¨ç‡æé«˜äº†ä¸€å€ï¼Œä½†å±å¹•å°ºå¯¸å´æ²¡æœ‰å˜åŒ–ï¼Œè¿™æ„å‘³ç€åŒæ ·å¤§å°çš„å±å¹•ä¸Šï¼Œåƒç´ å¤šäº†ä¸€å€ï¼Œäºæ˜¯ <code>dpr = 2</code>ã€‚</p>
<p>åœ¨ Chrome æµè§ˆå™¨å¯ä»¥é€šè¿‡ä»¥ä¸‹ä»£ç è·å–è®¾å¤‡çš„ DPRï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">let dpr = window.devicePixelRatio;</div></pre></td></tr></table></figure>
<p>è€Œé€šè¿‡ä¸‹é¢çš„ä»£ç å¯ä»¥è·å–è®¾å¤‡çš„é€»è¾‘åƒç´ ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">let logicalHeight = screen.height;</div><div class="line">let logicalWidth = screen.width;</div></pre></td></tr></table></figure>
<p>é‚£ä¹ˆå¾ˆå¤šäººçœ‹åˆ°è¿™é‡Œï¼Œå°±ä¼šè®¤ä¸ºï¼š<code>ç‰©ç†åƒç´  = é€»è¾‘åƒç´  * dpr</code><br>ä½†å®é™…æƒ…å†µå¹¶ä¸æ˜¯è¿™æ ·ï¼Œ<br>ç•™æ„ä¸€ä¸‹ iPhone6 plus çš„ç‰©ç†åƒç´ å’Œé€»è¾‘åƒç´ ï¼š</p>
<ul>
<li>ç‰©ç†åƒç´ ï¼š<code>1080px x 1920px</code></li>
<li>é€»è¾‘åƒç´ ï¼š<code>414px x 736px</code></li>
</ul>
<p>è€Œå®˜æ–¹å£°ç§° iPhone6 plus çš„ <code>dpr = 3</code>ï¼ŒæŒ‰ç†åº”è¯¥æ˜¯ï¼š</p>
<ul>
<li><code>414px x 736px</code> â†’ ä¹˜ä»¥ 3 å€ dpr â†’ <code>1242px x 2208px</code></li>
</ul>
<p>é‚£ä¹ˆ iPhone6 plus åªæœ‰ <code>1080px x 1920px</code>ï¼Œæ€ä¹ˆå»å±•ç¤º <code>1241px x 2208px</code> çš„åˆ†è¾¨ç‡å‘¢ï¼Ÿ</p>
<p>åŸæ¥ iPhone6 plus å¯¹é€»è¾‘åƒç´ åšäº†ç¼©å°å¤„ç†ï¼Œä»¥é€‚åº”ç‰©ç†åƒç´ ï¼Œä¹Ÿå°±æ˜¯<br><code>1241px x 2208px</code> é™¤ä»¥ <code>115%</code> ï¼Œå¾—åˆ° <code>1080px x 1920px</code>ã€‚</p>
<p>æ¢å¥è¯æ¥è¯´ï¼Œæœ¬æ¥ iPhone6 plus çš„ <code>dpr = 2.6</code>ï¼Œä½†æ˜¯é€šè¿‡è™šæ‹ŸæŠ€æœ¯æŠŠç‰©ç†åƒç´ æ”¾å¤§ 115% ï¼Œä»¥è¾¾åˆ° <code>dpr = 3</code> çš„æ•ˆæœã€‚</p>
<p>æ‰€ä»¥è¯´æ˜¯å‡ 3 å€ dprï¼Œå…¶å®æˆ‘ä»¬å¼€å‘å’Œè®¾è®¡çš„æ—¶å€™ä¹Ÿä¸ç”¨ç®¡è¿™ä¸ªï¼Œå½“ä½œå®ƒå°±æ˜¯ 3 å€ dpr å°±å¥½äº†ã€‚</p>
<h1 id="å›åˆ°-rpx"><a href="#å›åˆ°-rpx" class="headerlink" title="å›åˆ° rpx"></a>å›åˆ° rpx</h1><p>æ ¹æ®å®˜æ–¹ç»™å‡ºçš„ rpx æ¢ç®— px çš„å®ä¾‹ï¼š<br><img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/post/talk-about-pixel-and-rpx/ACED349F80C8D926AB74922C360B2F5A.png" alt="rpx æ¢ç®— px"></p>
<p>ä¸‰æ¬¾æœºå™¨çš„é€»è¾‘åƒç´ ï¼š</p>
<ul>
<li>iPhone5 : <code>320px x 568px</code></li>
<li>iPhone6 : <code>375px x 667px</code></li>
<li>iPhone6 plus : <code>414px x 736px</code></li>
</ul>
<p>rpx è½¬æ¢æˆ px æ˜¯éœ€è¦ä¹˜ä»¥ä¸€ä¸ªç³»æ•°çš„ï¼š</p>
<ul>
<li><code>px = rpx * n</code></li>
</ul>
<p>å…¶ä¸­ç³»æ•° nï¼Œæ˜¯è·Ÿç€è®¾å¤‡æ”¹å˜çš„ï¼š</p>
<ul>
<li>iPhone5: <code>n = 2.34</code></li>
<li>iPhone6: <code>n = 2</code></li>
<li>iPhone6 plus: <code>n = 1.81</code></li>
</ul>
<p>æ‰€ä»¥ rpx åªæ˜¯å®šä¹‰ä¸€ä¸ªç»å¯¹å€¼ 750 å®½åº¦ï¼Œç„¶åç®€å•çš„æ ¹æ®ä¸åŒè®¾å¤‡çš„é€»è¾‘åƒç´ æ¥è¿›è¡Œ rpx åˆ° px çš„æ¢ç®—ã€‚</p>
<p>ç²¾æ˜çš„è§‚ä¼—å¯èƒ½å‘ç°äº†ï¼Œ rpx å‹æ ¹å°±ä¸éœ€è¦å…³å¿ƒ DPR å’Œ PPI çš„æ¦‚å¿µã€‚<br>å‘ƒï¼Œå…¶å®æˆ‘å°±æ˜¯åœ¨ç†è§£ rpx çš„è¿‡ç¨‹ä¸­ï¼Œæ‹¦ä¸ä½æ€ç»´çš„å‘æ•£ï¼Œäº†è§£äº†ä¸€å¤§å †æ¦‚å¿µï¼Œç„¶åé¡ºé“ç»™ä½ ä»¬åˆ†äº«ä¸€ä¸‹ç½¢äº†ã€‚</p>
<h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><a href="https://www.wikiwand.com/zh-sg/%E5%83%8F%E7%B4%A0" target="_blank" rel="external">Wiki - åƒç´ </a><br><a href="https://www.wikiwand.com/zh-sg/%E6%AF%8F%E8%8B%B1%E5%AF%B8%E5%83%8F%E7%B4%A0" target="_blank" rel="external">Wiki - æ¯è‹±å¯¸åƒç´ </a><br><a href="https://www.paintcodeapp.com/news/iphone-6-screens-demystified" target="_blank" rel="external">iPhone 6 Screens Demystified</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;æœ€è¿‘åœ¨è´Ÿè´£æœ‰èµçš„æŸä¸ªä¸šåŠ¡çš„å¾®ä¿¡å°ç¨‹åºå¼€å‘ï¼Œè¿™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡ç€æ‰‹å¾®ä¿¡å°ç¨‹åºçš„å¼€å‘ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸­å‘ç°å¾®ä¿¡å°ç¨‹åºæ‰€å®šä¹‰çš„ä¸€å¥— WXSS (WeiXin 
    
    </summary>
    
      <category term="æ¬ç –ç å†œ" scheme="http://huang-jerryc.com/categories/%E6%90%AC%E7%A0%96%E7%A0%81%E5%86%9C/"/>
    
    
      <category term="å‰ç«¯" scheme="http://huang-jerryc.com/tags/%E5%89%8D%E7%AB%AF/"/>
    
  </entry>
  
  <entry>
    <title>2017 ç¬¬ä¸€å­£åº¦å¤ç›˜</title>
    <link href="http://huang-jerryc.com/2017/05/04/reconsidering-for-2017-Q1/"/>
    <id>http://huang-jerryc.com/2017/05/04/reconsidering-for-2017-Q1/</id>
    <published>2017-05-03T16:33:02.000Z</published>
    <updated>2018-05-01T16:16:02.081Z</updated>
    
    <content type="html"><![CDATA[<h1 id="The-Past"><a href="#The-Past" class="headerlink" title="The Past"></a>The Past</h1><ol>
<li><a href="https://github.com/JerryC8080/Memeye" target="_blank" rel="external">Memeye</a> ç»ˆäºå¼€æºäº†ï¼Œåˆ°ç›®å‰ä¸ºæ­¢å·²ç»æœ‰ 153 ä¸ª star äº†ï¼Œä½†æ˜¯åç»­æ²¡æœ‰å†ç»´æŠ¤äº†ï¼Œæ‰“ç®—ç­‰æˆ‘å­¦å®Œ Vue ä»¥åŠå¯¹å‰ç«¯æ›´åŠ ç†Ÿç»ƒä¹‹åï¼Œå¯¹å‰ç«¯éƒ¨åˆ†è¿›è¡Œé‡æ„ï¼Œä½¿å¾—ç•Œé¢æ›´åŠ æµç•…ã€‚</li>
<li>è¾“å‡ºæ–‡ç« ä¹ç¯‡ï¼Œå…¶ä¸­å…«ç¯‡æŠ€æœ¯æ–‡ã€‚</li>
<li>è¾“å‡ºäº†ä¸€æœ¬å°ä¹¦ï¼šã€Œ<a href="https://github.com/JerryC8080/understand-tcp-udp" target="_blank" rel="external">ç†è§£ TCP å’Œ UDP</a>ã€ï¼Œè¿™æ˜¯æˆ‘åœ¨å¤ä¹ è®¡ç®—æœºç½‘ç»œçš„äº§ç‰©ï¼Œæœ‰å¹¸èƒ½æ‹¿åˆ° 123 star ï¼ˆæ•°å­—å¾ˆç‰¹åˆ«ï¼‰ã€‚</li>
<li>ä»é­…æ—ç¦»èŒï¼Œå…¥èŒæœ‰èµï¼Œæ¢äº†ä¸ª Titleï¼Œä»ã€ŒNodeJS å·¥ç¨‹å¸ˆã€åˆ°ã€Œå‰ç«¯å·¥ç¨‹å¸ˆã€ï¼Œè¿™æ˜¯å¾ˆç¬¦åˆæˆ‘ä¸ªäººçš„å‘å±•è®¡åˆ’çš„ï¼Œä»¥ JS æ ˆä¸ºä¸»çš„å…¨æ ˆé“è·¯ã€‚å½“ç„¶ï¼Œå‰æéœ€è¦æ˜¯ä¸€ä¸ªä¼˜ç§€çš„è½¯ä»¶å·¥ç¨‹å¸ˆã€‚</li>
</ol>
<p>å¯æƒœçš„æ˜¯ï¼Œ2017å¹´çš„å¼€å¤´æ²¡æœ‰å¥½å¥½æ•´ç†ä»Šå¹´çš„ç›®æ ‡ã€‚<br>è®°å¾—æœ‰å¥è¯å¾ˆæ·±åˆ»ï¼šã€Œäººç”Ÿä¸­æœ€é€‚åˆçš„æ—¶æœºæœ‰ä¸¤ä¸ªï¼Œä¸€ä¸ªæ˜¯åå¹´å‰ï¼Œä¸€ä¸ªæ˜¯ç°åœ¨ã€<br>è™½ç„¶è¿‡äº†ä¸‰åˆ†ä¹‹ä¸€äº†ï¼Œä½†ç°åœ¨è®¡åˆ’ï¼Œè¿˜æ¥å¾—åŠã€‚</p>
<h1 id="The-Next"><a href="#The-Next" class="headerlink" title="The Next"></a>The Next</h1><p>å¸Œæœ›åˆ°äº† 2018 å¹´çš„è‡ªå·±ï¼š</p>
<ol>
<li><strong>Target</strong>: èƒ½è§£å†³å¤§éƒ¨åˆ†å‰ç«¯ä¸šåŠ¡ä¸Šçš„å¼€å‘<ol>
<li>æ·±å…¥å‰ç«¯ï¼Œè¡¥è¶³å‰ç«¯åŸºç¡€ï¼ŒåŒ…æ‹¬ CSSã€HTML5ã€ReactJSã€Vue2ï¼Œç§»åŠ¨ç«¯å¼€å‘</li>
<li>å­¦ä¹ è®¾è®¡ç†è®ºã€è‰²å½©ç†è®ºã€çœ‹æ›´å¤šçš„ä¼˜ç§€è®¾è®¡ã€‚</li>
<li>å¯»æ‰¾è®¾è®¡é¢†åŸŸæ¯”è¾ƒå¥½çš„è¯»ç‰©ï¼Œç»™è¯»å®Œã€‚</li>
</ol>
</li>
<li><strong>Target</strong>: åœ¨ç¤¾åŒºæœ‰æ›´åŠ å¤šçš„å½±å“åŠ›<ol>
<li>å…¨å¹´è‡³å°‘äº§å‡ºæ–‡ç«  12 - 20 ç¯‡</li>
<li>æ‹¥æœ‰ä¸€ä¸ª 300 star çš„å¼€æºé¡¹ç›®</li>
<li>å½±å“æ‰€åœ¨å›¢é˜Ÿï¼Œé€æ¸è¥é€ æŠ€æœ¯æ°›å›´</li>
</ol>
</li>
<li><strong>Target</strong>: æŒç»­æ‰å®åŸºç¡€å®åŠ›<ol>
<li>ã€Šé¸Ÿå“¥çš„Linuxç§æˆ¿èœã€‹</li>
<li>ã€Šè®¾è®¡æ¨¡å¼ã€‹</li>
<li>ã€Šæ·±å…¥ç†è§£è®¡ç®—æœºæ“ä½œç³»ç»Ÿã€‹</li>
<li>ã€Šæ·±å…¥æµ…å‡º NodeJSã€‹ã€ã€ŠNodeJS ç¡¬å®æˆ˜ã€‹ã€ã€ŠSecurity Your NodeJS Applicationã€‹</li>
<li>ã€Šé«˜æ€§èƒ½MySQLã€‹</li>
<li>ã€ŠCSS æƒå¨æŒ‡å—ã€‹ã€ã€ŠCSS æ­ç§˜ã€‹</li>
<li>ã€ŠRedis è®¾è®¡ä¸å®ç°ã€‹ã€ã€ŠRedis å®æˆ˜ã€‹</li>
<li>ã€Šä½ ä¸çŸ¥é“çš„ JavaScriptã€‹</li>
</ol>
</li>
<li><strong>Target</strong>: å…·æœ‰æ•æ·å¼€å‘çš„å®è·µç»éªŒ<ol>
<li>å›¢é˜Ÿæ²Ÿé€š</li>
<li>æ–‡æ¡£æ²‰æ·€</li>
<li>å½±å“åŠ›è¾“å‡º</li>
<li>ä»£ç è´¨é‡</li>
<li>ç¨³å®šäº¤ä»˜</li>
<li>å¿«é€Ÿè¿­ä»£æµç¨‹</li>
</ol>
</li>
<li><strong>Target</strong>: æ‹“å±•è‡ªèº«çš„æŠ€æœ¯è§†é‡<ol>
<li>å­¦ä¹  Pythonï¼Œæ„Ÿå—ç¤¾åŒº</li>
<li>å­¦ä¹  Goï¼Œæ„Ÿå—ç¤¾åŒº</li>
</ol>
</li>
<li><strong>Target</strong>: æŠ€æœ¯ä¹‹å¤–<ol>
<li>ã€Šè½¯æŠ€èƒ½ã€‹</li>
<li>ã€Šæµªæ½®ä¹‹å·…ã€‹ä¸€äºŒå†Œ</li>
<li>ã€Šæš—æ—¶é—´ã€‹ç¬¬äºŒæ¬¡é˜…è¯»</li>
<li>ã€Šå¦‚ä½•é˜…è¯»ä¸€æœ¬ä¹¦ã€‹</li>
</ol>
</li>
</ol>
<p>å…±å‹‰ã€‚</p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;The-Past&quot;&gt;&lt;a href=&quot;#The-Past&quot; class=&quot;headerlink&quot; title=&quot;The Past&quot;&gt;&lt;/a&gt;The Past&lt;/h1&gt;&lt;ol&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/JerryC8080/M
    
    </summary>
    
      <category term="ä¸‰çœå¾èº«" scheme="http://huang-jerryc.com/categories/%E4%B8%89%E7%9C%81%E5%90%BE%E8%BA%AB/"/>
    
    
  </entry>
  
  <entry>
    <title>ä¸€æ¬¾ NodeJS è½»é‡çº§å†…å­˜ç›‘æ§å·¥å…·</title>
    <link href="http://huang-jerryc.com/2017/03/17/the-memeye/"/>
    <id>http://huang-jerryc.com/2017/03/17/the-memeye/</id>
    <published>2017-03-17T07:17:38.000Z</published>
    <updated>2019-07-17T13:52:49.737Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Memeye"><a href="#Memeye" class="headerlink" title="Memeye"></a><a href="https://github.com/JerryC8080/Memeye" target="_blank" rel="external">Memeye</a></h1><p>Github é“¾æ¥ï¼š<a href="https://github.com/JerryC8080/Memeye" target="_blank" rel="external">https://github.com/JerryC8080/Memeye</a></p>
<p>Memeye æ˜¯ä¸€ä¸ªè½»é‡çº§çš„ NodeJS è¿›ç¨‹ç›‘æ§å·¥å…·ï¼Œå®ƒæä¾› è¿›ç¨‹å†…å­˜ã€V8 å †ç©ºé—´å†…å­˜ã€æ“ä½œç³»ç»Ÿå†…å­˜ ä¸‰å¤§ç»´åº¦çš„æ•°æ®å¯è§†åŒ–å±•ç¤ºã€‚<br>å‰ç«¯éƒ¨åˆ†ï¼Œå€ŸåŠ© <a href="https://github.com/vuejs/vue" target="_blank" rel="external">Vue2</a> å’Œ <a href="https://github.com/chartjs/Chart.js" target="_blank" rel="external">ChartJS</a> æä¾›äº†ä¸€ä¸ªä¸é”™çš„åŠ¨æ€å±•ç¤ºé¢æ¿ã€‚<br>Memeye åœ¨å®¿ä¸»è¿›ç¨‹ä¸­ï¼Œåªæ¤å…¥äº†ä¸€ä¸ªç®€å•çš„æ•°æ®æ”¶é›†å™¨ï¼Œå…¶ä»–å·¥ä½œåˆ™å¯åŠ¨ä¸€ä¸ªå­è¿›ç¨‹ï¼Œäº¤ç”±å­è¿›ç¨‹æ¥è¿›è¡Œã€‚<br>è¿™æ ·åšèƒ½æŠŠ Memeye çš„ä»£ç å¯¹å®¿ä¸»è¿›ç¨‹çš„å½±å“é™åˆ°æœ€ä½ï¼Œä»¥ç¡®ä¿æ•°æ®çš„çœŸå®æ€§ã€‚    </p>
<h3 id="ç‰¹ç‚¹"><a href="#ç‰¹ç‚¹" class="headerlink" title="ç‰¹ç‚¹"></a>ç‰¹ç‚¹</h3><ul>
<li>è½»é‡çº§</li>
<li>ç®€å•</li>
<li>é¢å‘å¼€å‘ç¯å¢ƒ</li>
<li>å¯è§†åŒ–</li>
</ul>
<p><em>Note: Memeye æš‚æ—¶åªæ”¯æŒå•è¿›ç¨‹ï¼ŒNodeJS åˆ†å¸ƒå¼è¿›ç¨‹è¿˜ä¸é€‚ç”¨ï¼Œæ‰€ä»¥ä¸å»ºè®®åœ¨äº§å“ç¯å¢ƒä½¿ç”¨ã€‚</em></p>
<h1 id="åŠ¨æœº"><a href="#åŠ¨æœº" class="headerlink" title="åŠ¨æœº"></a>åŠ¨æœº</h1><p>æ€»æ‰€å‘¨çŸ¥ï¼ŒNodeJS å¯¹å†…å­˜æ˜¯å¾ˆæ•æ„Ÿçš„ã€‚åœ¨å»å¹´ 4 æœˆæˆ‘ç”¨ NodeJS åšçš„ä¸€ä¸ªè¥é”€æ€§çš„é¡¹ç›®ï¼Œåœ¨ä¸Šçº¿å½“å¤© PV çªç ´äº† 100Wã€‚<br>å…¶ä¸­å†…å­˜å°±å‘ˆç°å‡ºæŒç»­ä¸Šæ¶¨è¶‹åŠ¿ï¼Œåœ¨æ’æŸ¥é—®é¢˜çš„è¿‡ç¨‹ä¸­ï¼Œæƒ³å¯»æ‰¾ä¸€ä¸ªè½»é‡çº§çš„ï¼Œåªè¦å¯è§†åŒ–çš„å‘ˆç°å†…å­˜ä½¿ç”¨æƒ…å†µçš„å·¥å…·ï¼Œæ— æœã€‚<br>ç„¶åå°±æœ‰äº†è¿™ä¸ªé¡¹ç›®çš„æƒ³æ³•ï¼Œä½†å½“æ—¶ç”±äºç¹å¿™åªåšå‡ºäº†ä¸€ä¸ª Demo çº§åˆ«çš„ï¼Œç®€å•èƒ½ç”¨å°±å‘å¸ƒäº†ã€‚<br>æœ€è¿‘æœ‰æ—¶é—´ï¼Œå†æ¬¡ç¿»å‡ºæ¥ï¼Œé‡æ„æ”¹ç‰ˆï¼Œå¢åŠ æ›´å¤šç»´åº¦çš„æ•°æ®å±•ç¤ºã€‚    </p>
<h1 id="Demo"><a href="#Demo" class="headerlink" title="Demo"></a>Demo</h1><p><a href="http://jerryc8080.github.io/Memeye/" target="_blank" rel="external">See preview demo</a> (ä¹Ÿè®¸éœ€è¦ç¿»å¢™)</p>
<h1 id="å…¼å®¹æ€§"><a href="#å…¼å®¹æ€§" class="headerlink" title="å…¼å®¹æ€§"></a>å…¼å®¹æ€§</h1><ul>
<li>Node v7.x</li>
<li>Node v6.x</li>
</ul>
<h1 id="å®‰è£…-amp-ä½¿ç”¨"><a href="#å®‰è£…-amp-ä½¿ç”¨" class="headerlink" title="å®‰è£… &amp; ä½¿ç”¨"></a>å®‰è£… &amp; ä½¿ç”¨</h1><p>è¿è¡Œä¸‹é¢å‘½ä»¤å®‰è£… : </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">npm install memeye --save-dev</div></pre></td></tr></table></figure>
<p>ç„¶ååœ¨ä½ çš„ä»£ç ä¸­å¼•å…¥</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">const memeye = require(&apos;memeye&apos;);</div><div class="line">memeye();</div></pre></td></tr></table></figure>
<p>æœ€åæ‰“å¼€ä½ çš„æµè§ˆå™¨ï¼Œè¾“å…¥ä¸‹é¢åœ°å€ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">http://localhost:23333  //23333 port by defaul.</div></pre></td></tr></table></figure>
<p>å°±è¿™ä¹ˆç®€å•ï¼</p>
<h1 id="Memeye-æ˜¯å¦‚ä½•å·¥ä½œçš„"><a href="#Memeye-æ˜¯å¦‚ä½•å·¥ä½œçš„" class="headerlink" title="Memeye æ˜¯å¦‚ä½•å·¥ä½œçš„"></a>Memeye æ˜¯å¦‚ä½•å·¥ä½œçš„</h1><p>Memeye æœ‰ä¸‰ä¸ªæ ¸å¿ƒæ¦‚å¿µï¼šCollector, Indicators, Dashboardã€‚<br>Collector è¿è¡Œåœ¨å®¿ä¸»è¿›ç¨‹ä¸­ï¼ˆä½ çš„NodeJSè¿›ç¨‹ï¼‰ï¼ŒIndicator å’Œ Dashboard è¿è¡Œåœ¨å­è¿›ç¨‹ä¸­ï¼Œè¿™æ ·å¯ä»¥å°½é‡å‡å°‘ Memeye ä»£ç å¯¹ä½ çš„å®¿ä¸»è¿›ç¨‹çš„å½±å“ã€‚    </p>
<h2 id="Collector"><a href="#Collector" class="headerlink" title="Collector"></a>Collector</h2><p>Collector ä¼šç›‘å¬å®¿ä¸»è¿›ç¨‹ï¼Œå¹¶ä¸”æ”¶é›†æ•°æ®ï¼Œç„¶åé€šè¿‡ IPC é€šä¿¡ç®¡é“å‘é€æ•°æ®ç»™å­è¿›ç¨‹ï¼Œäº¤ç”±å­è¿›ç¨‹å¤„ç†ã€‚    </p>
<h2 id="Indicator"><a href="#Indicator" class="headerlink" title="Indicator"></a>Indicator</h2><p>Indicator åƒä¸€ä¸ªçŠ¶æ€æœºã€‚å½“å®ƒçš„å±æ€§å˜åŒ–çš„æ—¶å€™ï¼Œä¼šè§¦å‘ç›¸åº”äº‹ä»¶ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ¥å¤„ç†æ”¶é›†å›æ¥çš„æ•°æ®ã€‚    </p>
<h2 id="Dashboard"><a href="#Dashboard" class="headerlink" title="Dashboard"></a>Dashboard</h2><p>Dashboard ä¼šä»¥å­è¿›ç¨‹çš„å½¢å¼å”¤èµ·ã€‚ä»–ä¼šåˆ›å»ºä¸€ä¸ª Indicator å®ä¾‹ï¼Œä»¥åŠå¯åŠ¨ä¸€ä¸ªé›†æˆ socket.io çš„ Http æœåŠ¡å™¨ã€‚<br>ç„¶åç»‘å®š Indicator å’Œè¿›ç¨‹é€šä¿¡ç®¡é“ï¼Œä»¥æ¥æ”¶çˆ¶è¿›ç¨‹å‘è¿‡æ¥çš„æ•°æ®ã€‚<br>æœ€åå†ç»‘å®š Indicator å’Œ socket.ioï¼Œè¿™æ ·å¯ä»¥åœ¨ Indicator å±æ€§å˜åŒ–çš„æ—¶å€™å‘é€æ•°æ®ç»™å‰ç«¯ã€‚    </p>
<p>##Collector, Indicator, Dashboard ä¹‹é—´çš„é€šä¿¡</p>
<p><img src="(https://raw.githubusercontent.com/JerryC8080/figure-bed/master/img/20190717214117.jpg" alt="commication.jpeg"></p>
<h1 id="é¢„è§ˆ"><a href="#é¢„è§ˆ" class="headerlink" title="é¢„è§ˆ"></a>é¢„è§ˆ</h1><p><img src="https://raw.githubusercontent.com/JerryC8080/figure-bed/master/img/20190717214216.jpeg" alt="é¢„è§ˆ"></p>
]]></content>
    
    <summary type="html">
    
      &lt;h1 id=&quot;Memeye&quot;&gt;&lt;a href=&quot;#Memeye&quot; class=&quot;headerlink&quot; title=&quot;Memeye&quot;&gt;&lt;/a&gt;&lt;a href=&quot;https://github.com/JerryC8080/Memeye&quot; target=&quot;_blank&quot; rel=&quot;
    
    </summary>
    
      <category term="æ¬ç –ç å†œ" scheme="http://huang-jerryc.com/categories/%E6%90%AC%E7%A0%96%E7%A0%81%E5%86%9C/"/>
    
    
      <category term="Javascript" scheme="http://huang-jerryc.com/tags/Javascript/"/>
    
      <category term="Nodejs" scheme="http://huang-jerryc.com/tags/Nodejs/"/>
    
      <category term="SOAP" scheme="http://huang-jerryc.com/tags/SOAP/"/>
    
  </entry>
  
  <entry>
    <title>ç†è§£UDP</title>
    <link href="http://huang-jerryc.com/2017/03/02/understand-udp/"/>
    <id>http://huang-jerryc.com/2017/03/02/understand-udp/</id>
    <published>2017-03-02T08:02:25.000Z</published>
    <updated>2020-07-21T08:12:37.393Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>æ›´å¥½é˜…è¯»ä½“éªŒï¼š<a href="https://jerryc8080.gitbooks.io/understand-tcp-and-udp/" target="_blank" rel="external">ã€Šç†è§£ TCP å’Œ UDPã€‹â€” By Gitbook</a>    </p>
</blockquote>
<h1 id="UDP-å’Œ-TCP-çš„ä¸åŒ"><a href="#UDP-å’Œ-TCP-çš„ä¸åŒ" class="headerlink" title="UDP å’Œ TCP çš„ä¸åŒ"></a>UDP å’Œ TCP çš„ä¸åŒ</h1><p>TCP åœ¨ä¼ é€æ•°æ®ä¹‹å‰å¿…é¡»å…ˆå»ºç«‹è¿æ¥ï¼Œæ•°æ®ä¼ é€ç»“æŸåè¦é‡Šæ”¾è¿æ¥ã€‚<br>TCP ä¸æä¾›å¹¿æ’­æˆ–å¤šæ’­æœåŠ¡ï¼Œç”±äº TCP è¦æä¾›å¯é çš„ã€é¢å‘è¿æ¥çš„è¿è¾“æœåŠ¡ï¼Œå› æ­¤ä¸å¯é¿å…åœ°å¢åŠ äº†è®¸å¤šçš„å¼€é”€ï¼Œå¦‚ç¡®è®¤ã€æµé‡æ§åˆ¶ã€è®¡æ—¶å™¨ä»¥åŠè¿æ¥ç®¡ç†ç­‰ã€‚    </p>
<p>è€Œ UDP åœ¨ä¼ é€æ•°æ®ä¹‹å‰ä¸éœ€è¦å…ˆå»ºç«‹è¿æ¥ã€‚æ¥æ”¶æ–¹æ”¶åˆ° UDP æŠ¥æ–‡ä¹‹åï¼Œä¸éœ€è¦ç»™å‡ºä»»ä½•ç¡®è®¤ã€‚<br>è™½ç„¶ UDP ä¸æä¾›å¯é äº¤ä»˜ï¼Œä½†åœ¨æŸäº›æƒ…å†µä¸‹ UDP å´æ˜¯ä¸€ç§æœ€æœ‰æ•ˆçš„å·¥ä½œæ–¹å¼ã€‚    </p>
<p>ç®€å•æ¥è¯´å°±æ˜¯ï¼š</p>
<p><strong>UDPï¼šå•ä¸ªæ•°æ®æŠ¥ï¼Œä¸ç”¨å»ºç«‹è¿æ¥ï¼Œç®€å•ï¼Œä¸å¯é ï¼Œä¼šä¸¢åŒ…ï¼Œä¼šä¹±åºï¼›</strong></p>
<p><strong>TCPï¼šæµå¼ï¼Œéœ€è¦å»ºç«‹è¿æ¥ï¼Œå¤æ‚ï¼Œå¯é  ï¼Œæœ‰åºã€‚</strong></p>
<h1 id="UDP-æ¦‚è¿°"><a href="#UDP-æ¦‚è¿°" class="headerlink" title="UDP æ¦‚è¿°"></a>UDP æ¦‚è¿°</h1><p>UDP å…¨ç§° User Datagram Protocol, ä¸ TCP åŒæ˜¯åœ¨ç½‘ç»œæ¨¡å‹ä¸­çš„ä¼ è¾“å±‚çš„åè®®ã€‚</p>
<p><strong>UDP çš„ä¸»è¦ç‰¹ç‚¹æ˜¯ï¼š</strong></p>
<ol>
<li><strong>æ— è¿æ¥çš„</strong>ï¼Œå³å‘é€æ•°æ®ä¹‹å‰ä¸éœ€è¦å»ºç«‹è¿æ¥ï¼Œå› æ­¤å‡å°‘äº†å¼€é”€å’Œå‘é€æ•°æ®ä¹‹å‰çš„æ—¶å»¶ã€‚</li>
<li><strong>ä¸ä¿è¯å¯é äº¤ä»˜</strong>ï¼Œå› æ­¤ä¸»æœºä¸éœ€è¦ä¸ºæ­¤å¤æ‚çš„è¿æ¥çŠ¶æ€è¡¨</li>
<li><strong>é¢å‘æŠ¥æ–‡çš„</strong>ï¼Œæ„æ€æ˜¯ UDP å¯¹åº”ç”¨å±‚äº¤ä¸‹æ¥çš„æŠ¥æ–‡ï¼Œæ—¢ä¸åˆå¹¶ï¼Œä¹Ÿä¸æ‹†åˆ†ï¼Œè€Œæ˜¯ä¿ç•™è¿™äº›æŠ¥æ–‡çš„è¾¹ç•Œï¼Œåœ¨æ·»åŠ é¦–éƒ¨åå‘ä¸‹äº¤ç»™ IP å±‚ã€‚</li>
<li><strong>æ²¡æœ‰é˜»å¡æ§åˆ¶</strong>ï¼Œå› æ­¤ç½‘ç»œå‡ºç°çš„æ‹¥å¡ä¸ä¼šä½¿å‘é€æ–¹çš„å‘é€é€Ÿç‡é™ä½ã€‚</li>
<li><strong>æ”¯æŒä¸€å¯¹ä¸€ã€ä¸€å¯¹å¤šã€å¤šå¯¹ä¸€å’Œå¤šå¯¹å¤šçš„äº¤äº’é€šä¿¡</strong>ï¼Œä¹Ÿå³æ˜¯æä¾›å¹¿æ’­å’Œå¤šæ’­çš„åŠŸèƒ½ã€‚</li>
<li><strong>é¦–éƒ¨å¼€é”€å°</strong>ï¼Œé¦–éƒ¨åªæœ‰ 8 ä¸ªå­—èŠ‚ï¼Œåˆ†ä¸ºå››éƒ¨åˆ†ã€‚</li>
</ol>
<p><strong>UDP çš„å¸¸ç”¨åœºæ™¯ï¼š</strong></p>
<ol>
<li>åå­—è½¬æ¢ï¼ˆDNSï¼‰</li>
<li>æ–‡ä»¶ä¼ é€ï¼ˆTFTPï¼‰</li>
<li>è·¯ç”±é€‰æ‹©åè®®ï¼ˆRIPï¼‰</li>
<li>IP åœ°å€é…ç½®ï¼ˆBOOTPï¼ŒDHTPï¼‰</li>
<li>ç½‘ç»œç®¡ç†ï¼ˆSNMPï¼‰</li>
<li>è¿œç¨‹æ–‡ä»¶æœåŠ¡ï¼ˆNFSï¼‰</li>
<li>IP ç”µè¯</li>
<li>æµå¼å¤šåª’ä½“é€šä¿¡</li>
</ol>
<h1 id="UDP-æŠ¥æ–‡ç»“æ„"><a href="#UDP-æŠ¥æ–‡ç»“æ„" class="headerlink" title="UDP æŠ¥æ–‡ç»“æ„"></a>UDP æŠ¥æ–‡ç»“æ„</h1><p>UDP æ•°æ®æŠ¥åˆ†ä¸ºæ•°æ®å­—æ®µå’Œé¦–éƒ¨å­—æ®µã€‚<br>é¦–éƒ¨å­—æ®µåªæœ‰ 8 ä¸ªå­—èŠ‚ï¼Œç”±å››ä¸ªå­—æ®µç»„æˆï¼Œæ¯ä¸ªå­—æ®µçš„é•¿åº¦æ˜¯ 2 ä¸ªå­—èŠ‚ã€‚    </p>
<p><img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/post/understand-tcp-udp/6FCC9F4EDE80F784BD11ED9FA76FA375.png" alt="UDP  æ•°æ®æŠ¥ç»“æ„.png"></p>
<p><strong>é¦–éƒ¨å„å­—æ®µæ„ä¹‰</strong>ï¼š</p>
<ol>
<li><strong>æºç«¯å£</strong>ï¼šæºç«¯å£å·ï¼Œåœ¨éœ€è¦å¯¹æ–¹å›ä¿¡æ—¶é€‰ç”¨ï¼Œä¸éœ€è¦æ—¶å¯å…¨ 0.</li>
<li><strong>ç›®çš„ç«¯å£</strong>ï¼šç›®çš„ç«¯å£å·ï¼Œåœ¨ç»ˆç‚¹äº¤ä»˜æŠ¥æ–‡æ—¶å¿…é¡»è¦ä½¿ç”¨åˆ°ã€‚</li>
<li><strong>é•¿åº¦</strong>ï¼šUDP ç”¨æˆ·æ•°æ®æŠ¥çš„é•¿åº¦ï¼Œåœ¨åªæœ‰é¦–éƒ¨çš„æƒ…å†µï¼Œå…¶æœ€å°å€¼æ˜¯ 8 ã€‚</li>
<li><strong>æ£€éªŒå’Œ</strong>ï¼šæ£€æµ‹ UDP ç”¨æˆ·æ•°æ®æŠ¥åœ¨ä¼ è¾“ä¸­æ˜¯å¦æœ‰é”™ï¼Œæœ‰é”™å°±ä¸¢å¼ƒã€‚</li>
</ol>
<h1 id="UDP-å¦‚ä½•è¿›è¡Œæ ¡éªŒå’Œ"><a href="#UDP-å¦‚ä½•è¿›è¡Œæ ¡éªŒå’Œ" class="headerlink" title="UDP å¦‚ä½•è¿›è¡Œæ ¡éªŒå’Œ"></a>UDP å¦‚ä½•è¿›è¡Œæ ¡éªŒå’Œ</h1><h2 id="ä¼ªé¦–éƒ¨"><a href="#ä¼ªé¦–éƒ¨" class="headerlink" title="ä¼ªé¦–éƒ¨"></a>ä¼ªé¦–éƒ¨</h2><p>UDP æ•°æ®æŠ¥é¦–éƒ¨ä¸­æ£€éªŒå’Œçš„è®¡ç®—æ–¹æ³•æ¯”è¾ƒç‰¹æ®Šã€‚<br>åœ¨è®¡ç®—æ£€éªŒå’Œæ—¶ï¼Œè¦åœ¨æ•°æ®æŠ¥ä¹‹å‰å¢åŠ  12 ä¸ªå­—èŠ‚çš„ä¼ªé¦–éƒ¨ï¼Œç”¨æ¥è®¡ç®—æ ¡éªŒå’Œã€‚<br>ä¼ªé¦–éƒ¨å¹¶ä¸æ˜¯æ•°æ®æŠ¥çœŸæ­£çš„é¦–éƒ¨ï¼Œæ˜¯ä¸ºäº†è®¡ç®—æ ¡éªŒå’Œè€Œä¸´æ—¶æ·»åŠ åœ¨æ•°æ®æŠ¥å‰é¢çš„ï¼Œåœ¨çœŸæ­£ä¼ è¾“çš„æ—¶å€™å¹¶ä¸ä¼šæŠŠä¼ªé¦–éƒ¨ä¸€å¹¶å‘é€ã€‚    </p>
<p><img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/post/understand-tcp-udp/3D9C291187835C3571A111952201B4FF.png" alt="UDP æ•°æ®æŠ¥ç»“æ„-ä¼ªé¦–éƒ¨.png"></p>
<p><strong>ä¼ªé¦–éƒ¨ä¸ªå­—æ®µæ„ä¹‰</strong>ï¼š</p>
<ol>
<li>ç¬¬ä¸€å­—æ®µï¼Œæº IP åœ°å€</li>
<li>ç¬¬äºŒå­—æ®µï¼Œç›®çš„ IP åœ°å€</li>
<li>ç¬¬ä¸‰å­—æ®µï¼Œå­—æ®µå…¨ 0</li>
<li>ç¬¬å››å­—æ®µï¼ŒIP é¦–éƒ¨ä¸­çš„åè®®å­—æ®µçš„å€¼ï¼Œå¯¹äº UDPï¼Œæ­¤å­—æ®µå€¼ä¸º 17</li>
<li>ç¬¬äº”å­—æ®µï¼ŒUDP ç”¨æˆ·æ•°æ®æŠ¥çš„é•¿åº¦</li>
</ol>
<h2 id="æ ¡éªŒå’Œè®¡ç®—æ–¹æ³•"><a href="#æ ¡éªŒå’Œè®¡ç®—æ–¹æ³•" class="headerlink" title="æ ¡éªŒå’Œè®¡ç®—æ–¹æ³•"></a>æ ¡éªŒå’Œè®¡ç®—æ–¹æ³•</h2><p>æ ¡éªŒå’Œçš„è®¡ç®—ä¸­ï¼Œé¢‘ç¹ç”¨åˆ°äº†äºŒè¿›åˆ¶çš„åç æ±‚å’Œè¿ç®—ï¼Œè¿ç®—è§„åˆ™è§ä¸‹ï¼š    </p>
<p><strong>äºŒè¿›åˆ¶åç æ±‚å’Œè¿ç®—</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">0 + 0 = 0</div><div class="line">1 + 0 = 0 + 1 = 1</div><div class="line">1 + 1 = 10</div></pre></td></tr></table></figure>
<p>å…¶ä¸­ 10 ä¸­çš„ 1 åŠ åˆ°äº†ä¸‹ä¸€åˆ—å»ï¼Œå¦‚æœæ˜¯æœ€é«˜åˆ—çš„ 1 + 1 ï¼Œé‚£ä¹ˆå¾—åˆ°çš„ 10 ç•™ä¸‹ 0 , 1 ç§»åˆ°æœ€ä½åˆ—ï¼Œä¸æœ€ä½ä½å†åšä¸€æ¬¡äºŒè¿›åˆ¶åŠ æ³•å³å¯ã€‚</p>
<p><strong>æ£€éªŒå’Œè®¡ç®—è¿‡ç¨‹</strong></p>
<ol>
<li>æŠŠé¦–éƒ¨çš„æ£€éªŒå’Œå­—æ®µè®¾ç½®ä¸ºå…¨ 0 </li>
<li>æŠŠä¼ªé¦–éƒ¨ä»¥åŠæ•°æ®æ®µçœ‹æˆæ˜¯è®¸å¤š 16 ä½çš„å­—ä¸²æ¥èµ·æ¥ã€‚</li>
<li>è‹¥æ•°æ®æ®µä¸æ˜¯å¶æ•°ä¸ªå­—èŠ‚ï¼Œåˆ™å¡«å……ä¸€ä¸ªå…¨ 0 å­—èŠ‚ï¼Œä½†æ˜¯è¿™ä¸ªå­—èŠ‚ä¸å‘é€ã€‚</li>
<li>é€šè¿‡äºŒè¿›åˆ¶åç è¿ç®—ï¼Œè®¡ç®—å‡º 16 ä½å­—çš„å’Œã€‚<ol>
<li>è®©ç¬¬ä¸€è¡Œå’Œç¬¬äºŒè¡ŒåšäºŒè¿›åˆ¶åç è¿ç®—ã€‚  </li>
<li>å°†ç¬¬ä¸€è¡Œå’Œç¬¬äºŒè¡Œçš„ç»“æœä¸ç¬¬ä¸‰è¡ŒåšäºŒè¿›åˆ¶åç è®¡ç®—ï¼Œä»¥æ­¤ç±»æ¨ã€‚</li>
</ol>
</li>
<li>æœ€åè¿ç®—ç»“æœå–åï¼Œå¾—åˆ°æ ¡éªŒå’Œã€‚</li>
<li>æŠŠè®¡ç®—å‡ºæ¥çš„æ ¡éªŒå’Œå€¼ï¼Œå¡«å…¥é¦–éƒ¨æ ¡éªŒå’Œå­—æ®µã€‚</li>
</ol>
<p>æ¥æ”¶æ–¹æ”¶åˆ°æ•°æ®æŠ¥ä¹‹åï¼ŒæŒ‰ç…§åŒæ ·çš„æ–¹æ³•è®¡ç®—æ ¡éªŒå’Œï¼Œå¦‚æœæœ‰å·®é”™ï¼Œåˆ™ä¸¢å¼ƒè¿™ä¸ªæ•°æ®æŠ¥ã€‚    </p>
<p>å¯ä»¥çœ‹å‡ºæ ¡éªŒå’Œï¼Œæ—¢æ£€æŸ¥äº† UDP ç”¨æˆ·æ•°æ®æŠ¥çš„æºç«¯å£å·å’Œç›®çš„ç«¯å£å·ä»¥åŠæ•°æ®æŠ¥çš„æ•°æ®éƒ¨åˆ†ï¼Œåˆæ£€æŸ¥äº† IP æ•°æ®æŠ¥çš„æº IP åœ°å€å’Œç›®çš„åœ°å€ã€‚    </p>
<p><strong>ä¸€ä¸ªæ ¡éªŒå’Œä¾‹å­</strong><br>å‡è®¾ä¸€ä¸ª UDP æ•°æ®æŠ¥ï¼š</p>
<p><img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/post/understand-tcp-udp/5DADDF7480F81837145468E2ADA6839F.png" alt="UDP æ ¡éªŒå’Œ.png"></p>
<p>å„å­—æ®µä»¥äºŒè¿›åˆ¶è¡¨ç¤ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">1001 1001 0001 0011 //ä¼ªé¦–éƒ¨æºIPåœ°å€å‰16ä½ï¼Œå€¼ï¼š153.19</div><div class="line">0000 1000 0110 1000 //ä¼ªé¦–éƒ¨æºIPåœ°å€å16ä½ï¼Œå€¼ï¼š8.104</div><div class="line">1010 1011 0000 0011 //ä¼ªé¦–éƒ¨ç›®çš„IPåœ°å€å‰16ä½ï¼Œå€¼ï¼š171.3</div><div class="line">0000 1110 0000 1011 //ä¼ªé¦–éƒ¨ç›®çš„IPåœ°å€å16ä½ï¼Œå€¼ï¼š14.11</div><div class="line">0000 0000 0001 0001 //ä¼ªé¦–éƒ¨UDPåè®®å­—æ®µä»£è¡¨å·ï¼Œå€¼ï¼š17</div><div class="line">0000 0000 0000 1111 //ä¼ªé¦–éƒ¨UDPé•¿åº¦å­—æ®µï¼Œå€¼ï¼š15</div><div class="line">0000 0100 0011 1111 //UDPå¤´éƒ¨æºIPåœ°å€å¯¹åº”çš„è¿›ç¨‹ç«¯å£å·ï¼Œå€¼ï¼š1087</div><div class="line">0000 0000 0000 1101 //UDPå¤´éƒ¨ç›®çš„IPåœ°å€å¯¹åº”çš„è¿›ç¨‹ç«¯å£å·ï¼Œå€¼ï¼š13</div><div class="line">0000 0000 0000 1111 //UDPå¤´éƒ¨UDPé•¿åº¦å­—æ®µï¼Œå€¼ï¼š15</div><div class="line">0000 0000 0000 0000 //UDPå¤´éƒ¨UDPæ£€éªŒå’Œï¼Œå€¼ï¼š0</div><div class="line">0101 0100 0100 0101 //æ•°æ®å­—æ®µ</div><div class="line">0101 0011 0101 0100 //æ•°æ®å­—æ®µ</div><div class="line">0100 1001 0100 1110 //æ•°æ®å­—æ®µ</div><div class="line">0100 0111 0000 0000 //æ•°æ®å­—æ®µ+å¡«å……0å­—æ®µ</div></pre></td></tr></table></figure>
<p>æŒ‰ç…§äºŒè¿›åˆ¶åç è¿ç®—æ±‚å’Œï¼Œç»“æœï¼š<code>10010110 11101101</code><br>ç»“æœæ±‚åç å¾—å‡ºæ ¡éªŒå’Œï¼š<code>01101001 00010010</code> </p>
<h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><a href="https://jcchan23.github.io/2016/07/12/%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%8F%8D%E7%A0%81%E6%B1%82%E5%92%8C%E8%BF%90%E7%AE%97/" target="_blank" rel="external">äºŒè¿›åˆ¶åç æ±‚å’Œè¿ç®—</a><br><a href="https://book.douban.com/subject/26850616/" target="_blank" rel="external">ã€Šåå°å¼€å‘ æ ¸å¿ƒæŠ€æœ¯ä¸åº”ç”¨å®è·µã€‹</a><br><a href="https://book.douban.com/subject/2970300/" target="_blank" rel="external">ã€Šè®¡ç®—æœºç½‘ç»œã€‹</a>    </p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;æ›´å¥½é˜…è¯»ä½“éªŒï¼š&lt;a href=&quot;https://jerryc8080.gitbooks.io/understand-tcp-and-udp/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;ã€Šç†è§£ TCP å’Œ UDPã€‹â€” By Gi
    
    </summary>
    
      <category term="æ¬ç –ç å†œ" scheme="http://huang-jerryc.com/categories/%E6%90%AC%E7%A0%96%E7%A0%81%E5%86%9C/"/>
    
    
      <category term="udp" scheme="http://huang-jerryc.com/tags/udp/"/>
    
  </entry>
  
  <entry>
    <title>ç†è§£TCPï¼ˆå…­ï¼‰ï¼šç½‘ç»œç¼–ç¨‹æ¥å£</title>
    <link href="http://huang-jerryc.com/2017/03/02/understand-tcp-6/"/>
    <id>http://huang-jerryc.com/2017/03/02/understand-tcp-6/</id>
    <published>2017-03-02T08:01:25.000Z</published>
    <updated>2020-07-21T08:12:37.393Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>æ›´å¥½é˜…è¯»ä½“éªŒï¼š<a href="https://jerryc8080.gitbooks.io/understand-tcp-and-udp/" target="_blank" rel="external">ã€Šç†è§£ TCP å’Œ UDPã€‹â€” By Gitbook</a>    </p>
</blockquote>
<h1 id="ä¸€åˆ‡çš†-Socket"><a href="#ä¸€åˆ‡çš†-Socket" class="headerlink" title="ä¸€åˆ‡çš† Socket"></a>ä¸€åˆ‡çš† Socket</h1><p>æˆ‘ä»¬å·²ç»çŸ¥é“ç½‘ç»œä¸­çš„è¿›ç¨‹æ˜¯é€šè¿‡ socket æ¥é€šä¿¡çš„ï¼Œé‚£ä»€ä¹ˆæ˜¯ socket å‘¢ï¼Ÿ<br>socket èµ·æºäº UNIXï¼Œè€Œ UNIX/Linux åŸºæœ¬å“²å­¦ä¹‹ä¸€å°±æ˜¯ã€Œä¸€åˆ‡çš†æ–‡ä»¶ã€ï¼Œéƒ½å¯ä»¥ç”¨ã€Œopen â†’ write/read â†’ closeã€æ¨¡å¼æ¥æ“ä½œã€‚<br>socket å…¶å®å°±æ˜¯è¯¥æ¨¡å¼çš„ä¸€ä¸ªå®ç°ï¼Œsocket å³æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ–‡ä»¶ï¼Œä¸€äº› socket å‡½æ•°å°±æ˜¯å¯¹å…¶è¿›è¡Œçš„æ“ä½œã€‚    </p>
<p>ä½¿ç”¨ TCP/IP åè®®çš„åº”ç”¨ç¨‹åºé€šå¸¸é‡‡ç”¨ç³»ç»Ÿæä¾›çš„ç¼–ç¨‹æ¥å£ï¼š<strong>UNIX BSD çš„å¥—æ¥å­—æ¥å£ï¼ˆSocket Interfacesï¼‰</strong><br>ä»¥æ­¤æ¥å®ç°ç½‘ç»œè¿›ç¨‹ä¹‹é—´çš„é€šä¿¡ã€‚<br>å°±ç›®å‰è€Œè¨€ï¼Œå‡ ä¹æ‰€æœ‰çš„åº”ç”¨ç¨‹åºéƒ½æ˜¯é‡‡ç”¨ socketï¼Œæ‰€ä»¥è¯´ç°åœ¨çš„ç½‘ç»œæ—¶ä»£ï¼Œç½‘ç»œä¸­è¿›ç¨‹é€šä¿¡æ˜¯æ— å¤„ä¸åœ¨ï¼Œ<strong>ä¸€åˆ‡çš† socket</strong>    </p>
<h1 id="å¥—æ¥å­—æ¥å£-Socket-Interfaces"><a href="#å¥—æ¥å­—æ¥å£-Socket-Interfaces" class="headerlink" title="å¥—æ¥å­—æ¥å£ Socket Interfaces"></a>å¥—æ¥å­—æ¥å£ Socket Interfaces</h1><p>å¥—æ¥å­—æ¥å£æ˜¯ä¸€ç»„å‡½æ•°ï¼Œç”±æ“ä½œç³»ç»Ÿæä¾›ï¼Œç”¨ä»¥åˆ›å»ºç½‘ç»œåº”ç”¨ã€‚<br>å¤§å¤šæ•°ç°ä»£æ“ä½œç³»ç»Ÿéƒ½å®ç°äº†å¥—æ¥å­—æ¥å£ï¼ŒåŒ…æ‹¬æ‰€æœ‰ Unix å˜ç§ï¼ŒWindows å’Œ Macintosh ç³»ç»Ÿã€‚    </p>
<blockquote>
<p><strong>å¥—æ¥å­—æ¥å£çš„èµ·æº</strong><br>å¥—æ¥å­—æ¥å£æ˜¯åŠ å·å¤§å­¦ä¼¯å…‹åˆ©åˆ†æ ¡çš„ç ”ç©¶äººå‘˜åœ¨ 20 ä¸–çºª 80 å¹´ä»£æ—©èµ·æå‡ºçš„ã€‚<br>ä¼¯å…‹åˆ©çš„ç ”ç©¶è€…ä½¿å¾—å¥—æ¥å­—æ¥å£é€‚ç”¨äºä»»ä½•åº•å±‚çš„åè®®ï¼Œç¬¬ä¸€ä¸ªå®ç°å°±æ˜¯é’ˆå¯¹ TCP/IP åè®®ï¼Œä»–ä»¬æŠŠå®ƒåŒ…æ‹¬åœ¨ Unix 4.2 BSD çš„å†…æ ¸é‡Œï¼Œå¹¶ä¸”åˆ†å‘ç»™è®¸å¤šå­¦æ ¡å’Œå®éªŒå®¤ã€‚<br>è¿™åœ¨å› ç‰¹ç½‘çš„å†å²æˆä¸ºäº†ä¸€ä¸ªé‡å¤§äº‹ä»¶ã€‚<br>â€”â€” ã€Šæ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿã€‹</p>
</blockquote>
<p>ä» Linux å†…æ ¸çš„è§’åº¦æ¥çœ‹ï¼Œä¸€ä¸ªå¥—æ¥å­—å°±æ˜¯é€šä¿¡çš„ä¸€ä¸ªç«¯ç‚¹ã€‚<br>ä» Linux ç¨‹åºçš„è§’åº¦æ¥çœ‹ï¼Œå¥—æ¥å­—æ˜¯ä¸€ä¸ªæœ‰ç›¸åº”æè¿°ç¬¦çš„æ–‡ä»¶ã€‚<br>æ™®é€šæ–‡ä»¶çš„æ‰“å¼€æ“ä½œè¿”å›ä¸€ä¸ªæ–‡ä»¶æè¿°å­—ï¼Œè€Œ socket() ç”¨äºåˆ›å»ºä¸€ä¸ª socket æè¿°ç¬¦ï¼Œå”¯ä¸€æ ‡è¯†ä¸€ä¸ª socketã€‚<br>è¿™ä¸ª socket æè¿°å­—è·Ÿæ–‡ä»¶æè¿°å­—ä¸€æ ·ï¼Œåç»­çš„æ“ä½œéƒ½æœ‰ç”¨åˆ°å®ƒï¼ŒæŠŠå®ƒä½œä¸ºå‚æ•°ï¼Œé€šè¿‡å®ƒæ¥è¿›è¡Œä¸€äº›æ“ä½œã€‚    </p>
<p>å¸¸ç”¨çš„å‡½æ•°æœ‰ï¼š</p>
<ul>
<li>socket()</li>
<li>bind()</li>
<li>listen()</li>
<li>connect()</li>
<li>accept()</li>
<li>write()</li>
<li>read()</li>
<li>close()</li>
</ul>
<h1 id="Socket-çš„äº¤äº’æµç¨‹"><a href="#Socket-çš„äº¤äº’æµç¨‹" class="headerlink" title="Socket çš„äº¤äº’æµç¨‹"></a>Socket çš„äº¤äº’æµç¨‹</h1><p><img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/post/understand-tcp-udp/46872611EB6C0874FE9E4C290E8F3FE9.png" alt="socket äº¤äº’è¿‡ç¨‹.png"></p>
<p>å›¾ä¸­å±•ç¤ºäº† TCP åè®®çš„ socket äº¤äº’æµç¨‹ï¼Œæè¿°å¦‚ä¸‹ï¼š</p>
<ol>
<li>æœåŠ¡å™¨æ ¹æ®åœ°å€ç±»å‹ã€socket ç±»å‹ã€ä»¥åŠåè®®æ¥åˆ›å»º socketã€‚</li>
<li>æœåŠ¡å™¨ä¸º socket ç»‘å®š IP åœ°å€å’Œç«¯å£å·ã€‚</li>
<li>æœåŠ¡å™¨ socket ç›‘å¬ç«¯å£å·è¯·æ±‚ï¼Œéšæ—¶å‡†å¤‡æ¥æ”¶å®¢æˆ·ç«¯å‘æ¥çš„è¿æ¥ï¼Œè¿™æ—¶å€™æœåŠ¡å™¨çš„ socket å¹¶æ²¡æœ‰å…¨éƒ¨æ‰“å¼€ã€‚</li>
<li>å®¢æˆ·ç«¯åˆ›å»º socketã€‚</li>
<li>å®¢æˆ·ç«¯æ‰“å¼€ socketï¼Œæ ¹æ®æœåŠ¡å™¨ IP åœ°å€å’Œç«¯å£å·è¯•å›¾è¿æ¥æœåŠ¡å™¨ socketã€‚</li>
<li>æœåŠ¡å™¨ socket æ¥æ”¶åˆ°å®¢æˆ·ç«¯ socket è¯·æ±‚ï¼Œè¢«åŠ¨æ‰“å¼€ï¼Œå¼€å§‹æ¥æ”¶å®¢æˆ·ç«¯è¯·æ±‚ï¼ŒçŸ¥é“å®¢æˆ·ç«¯è¿”å›è¿æ¥ä¿¡æ¯ã€‚è¿™æ—¶å€™ socket è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œé˜»å¡æ˜¯ç”±äº accept() æ–¹æ³•ä¼šä¸€ç›´ç­‰åˆ°å®¢æˆ·ç«¯è¿”å›è¿æ¥ä¿¡æ¯åæ‰è¿”å›ï¼Œç„¶åå¼€å§‹è¿æ¥ä¸‹ä¸€ä¸ªå®¢æˆ·ç«¯çš„è¿æ¥è¯·æ±‚ã€‚</li>
<li>å®¢æˆ·ç«¯è¿æ¥æˆåŠŸï¼Œå‘æœåŠ¡å™¨å‘é€è¿æ¥çŠ¶æ€ä¿¡æ¯ã€‚</li>
<li>æœåŠ¡å™¨ accept() æ–¹æ³•è¿”å›ï¼Œè¿æ¥æˆåŠŸã€‚</li>
<li>æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯é€šè¿‡ç½‘ç»œ I/O å‡½æ•°è¿›è¡Œæ•°æ®çš„ä¼ è¾“ã€‚</li>
<li>å®¢æˆ·ç«¯å…³é—­ socketã€‚</li>
<li>æœåŠ¡å™¨å…³é—­ socketã€‚</li>
</ol>
<p>è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼ŒæœåŠ¡å™¨å’Œå®¢æˆ·ç«¯å»ºç«‹è¿æ¥çš„éƒ¨åˆ†ï¼Œå°±ä½“ç°äº† TCP ä¸‰æ¬¡æ¡æ‰‹çš„åŸç†ã€‚    </p>
<p>ä¸‹é¢è¯¦ç»†è®²ä¸€ä¸‹ socket çš„å„å‡½æ•°ã€‚    </p>
<h2 id="Socket-æ¥å£"><a href="#Socket-æ¥å£" class="headerlink" title="Socket æ¥å£"></a>Socket æ¥å£</h2><p>socket æ˜¯ç³»ç»Ÿæä¾›çš„æ¥å£ï¼Œè€Œæ“ä½œç³»ç»Ÿå¤§å¤šæ•°éƒ½æ˜¯ç”¨ C/C++ å¼€å‘çš„ï¼Œè‡ªç„¶å‡½æ•°åº“ä¹Ÿæ˜¯ C/C++ ä»£ç ã€‚    </p>
<h2 id="socket-å‡½æ•°"><a href="#socket-å‡½æ•°" class="headerlink" title="socket å‡½æ•°"></a>socket å‡½æ•°</h2><p>è¯¥å‡½æ•°ä¼šè¿”å›ä¸€ä¸ªå¥—æ¥å­—æè¿°ç¬¦ï¼ˆsocket descriptorï¼‰ï¼Œä½†æ˜¯è¯¥æè¿°ç¬¦ä»…æ˜¯éƒ¨åˆ†æ‰“å¼€çš„ï¼Œè¿˜ä¸èƒ½ç”¨äºè¯»å†™ã€‚<br>å¦‚ä½•å®Œæˆæ‰“å¼€å¥—æ¥å­—çš„å·¥ä½œï¼Œå–å†³äºæˆ‘ä»¬æ˜¯å®¢æˆ·ç«¯è¿˜æ˜¯æœåŠ¡å™¨ã€‚    </p>
<h3 id="å‡½æ•°åŸå‹"><a href="#å‡½æ•°åŸå‹" class="headerlink" title="å‡½æ•°åŸå‹"></a>å‡½æ•°åŸå‹</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/socket.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">socket</span><span class="params">(<span class="keyword">int</span> domain, <span class="keyword">int</span> type, <span class="keyword">int</span> protocol)</span></span>;</div></pre></td></tr></table></figure>
<h3 id="å‚æ•°è¯´æ˜"><a href="#å‚æ•°è¯´æ˜" class="headerlink" title="å‚æ•°è¯´æ˜"></a>å‚æ•°è¯´æ˜</h3><p><strong>domain</strong>:<br>åè®®åŸŸï¼Œå†³å®šäº† socket çš„åœ°è´¨ç±»å‹ï¼Œåœ¨é€šä¿¡ä¸­å¿…é¡»é‡‡ç”¨å¯¹åº”çš„åœ°å€ã€‚<br>å¸¸ç”¨çš„åè®®æ—æœ‰ï¼š<code>AF_INET</code>ï¼ˆipv4åœ°å€ä¸ç«¯å£å·çš„ç»„åˆï¼‰ã€<code>AF_INET6</code>ï¼ˆipv6åœ°å€ä¸ç«¯å£å·çš„ç»„åˆï¼‰ã€<code>AF_LOCAL</code>ï¼ˆç»å¯¹è·¯å¾„åä½œä¸ºåœ°å€ï¼‰ã€‚<br>è¯¥å€¼çš„å¸¸é‡å®šä¹‰åœ¨ <code>sys/socket.h</code> æ–‡ä»¶ä¸­ã€‚    </p>
<p><strong>type</strong>:<br>æŒ‡å®š socket ç±»å‹ã€‚<br>å¸¸ç”¨çš„ç±»å‹æœ‰ï¼š<code>SOCK_STREAM</code>ã€<code>SOCK_DGRAM</code>ã€<code>SOCK_RAW</code>ã€<code>SOCK_PACKET</code>ã€<code>SOCK_SEQPACKET</code>ç­‰ã€‚<br>å…¶ä¸­ <code>SOCK_STREAM</code> è¡¨ç¤ºæä¾›é¢å‘è¿æ¥çš„ç¨³å®šæ•°æ®ä¼ è¾“ï¼Œå³ TCP åè®®ã€‚<br>è¯¥å€¼çš„å¸¸é‡å®šä¹‰åœ¨ <code>sys/socket.h</code> æ–‡ä»¶ä¸­ã€‚    </p>
<p><strong>protocol</strong>:<br>æŒ‡å®šåè®®ã€‚<br>å¸¸ç”¨çš„åè®®æœ‰ï¼š<code>IPPROTO_TCP</code>ï¼ˆTCPåè®®ï¼‰ã€<code>IPPTOTO_UDP</code>ï¼ˆUDPåè®®ï¼‰ã€<code>IPPROTO_SCTP</code>ï¼ˆSTCPåè®®ï¼‰ã€‚<br>å½“å€¼ä½ 0 æ—¶ï¼Œä¼šè‡ªåŠ¨é€‰æ‹© <code>type</code> ç±»å‹å¯¹åº”çš„é»˜è®¤åè®®ã€‚    </p>
<h2 id="bind-å‡½æ•°"><a href="#bind-å‡½æ•°" class="headerlink" title="bind å‡½æ•°"></a>bind å‡½æ•°</h2><p>ç”±æœåŠ¡ç«¯è°ƒç”¨ï¼ŒæŠŠä¸€ä¸ªåœ°å€æ—ä¸­çš„ç‰¹å®šåœ°å€å’Œ socket è”ç³»èµ·æ¥ã€‚</p>
<h3 id="å‡½æ•°åŸå‹-1"><a href="#å‡½æ•°åŸå‹-1" class="headerlink" title="å‡½æ•°åŸå‹"></a>å‡½æ•°åŸå‹</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/socket.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">bind</span><span class="params">(<span class="keyword">int</span> sockfd, <span class="keyword">const</span> <span class="keyword">struct</span> sockaddr *addr, <span class="keyword">socklen_t</span> addrlen)</span></span>;</div></pre></td></tr></table></figure>
<h3 id="å‚æ•°è¯´æ˜-1"><a href="#å‚æ•°è¯´æ˜-1" class="headerlink" title="å‚æ•°è¯´æ˜"></a>å‚æ•°è¯´æ˜</h3><p><strong>sockfd</strong>:<br>å³ socket æè¿°å­—ï¼Œç”± socket() å‡½æ•°åˆ›å»ºã€‚    </p>
<p><strong>*addr</strong>ï¼š<br>ä¸€ä¸ª <code>const struct sockaddr</code> æŒ‡é’ˆï¼ŒæŒ‡å‘è¦ç»‘å®šç»™ <code>sockfd</code> çš„åè®®åœ°å€ã€‚<br>è¿™ä¸ªåœ°å€ç»“æ„æ ¹æ®åœ°å€åˆ›å»º socket æ—¶çš„åœ°å€åè®®æ—ä¸åŒè€Œä¸åŒï¼Œä¾‹å¦‚ ipv4 å¯¹åº” <code>sockaddr_in</code>ï¼Œipv6 å¯¹åº” <code>sockaddr_in6</code>.<br>è¿™å‡ ä¸ªç»“æ„ä½“åœ¨ä½¿ç”¨çš„æ—¶å€™ï¼Œéƒ½å¯ä»¥å¼ºåˆ¶è½¬æ¢æˆ <code>sockaddr</code>ã€‚<br>ä¸‹é¢æ˜¯è¿™å‡ ä¸ªç»“æ„ä½“å¯¹åº”çš„æ‰€åœ¨çš„å¤´æ–‡ä»¶ï¼š</p>
<ol>
<li><code>sockaddr</code>ï¼š <code>sys/socket.h</code></li>
<li><code>sockaddr_in</code>ï¼š <code>netinet/in.h</code></li>
<li><code>sockaddr_in6</code>ï¼š <code>netinet6/in.h</code></li>
</ol>
<blockquote>
<p>_in åç¼€æ„ä¹‰ï¼šäº’è”ç½‘ç»œ(internet)çš„ç¼©å†™ï¼Œè€Œä¸æ˜¯è¾“å…¥(input)çš„ç¼©å†™ã€‚</p>
</blockquote>
<h2 id="listen-å‡½æ•°"><a href="#listen-å‡½æ•°" class="headerlink" title="listen å‡½æ•°"></a>listen å‡½æ•°</h2><p>æœåŠ¡å™¨è°ƒç”¨ï¼Œå°† socket ä»ä¸€ä¸ªä¸»åŠ¨å¥—æ¥å­—è½¬åŒ–ä¸ºä¸€ä¸ªç›‘å¬å¥—æ¥å­—ï¼ˆlistening socketï¼‰, è¯¥å¥—æ¥å­—å¯ä»¥æ¥æ”¶æ¥è‡ªå®¢æˆ·ç«¯çš„è¿æ¥è¯·æ±‚ã€‚<br>åœ¨é»˜è®¤æƒ…å†µä¸‹ï¼Œæ“ä½œç³»ç»Ÿå†…æ ¸ä¼šè®¤ä¸º socket å‡½æ•°åˆ›å»ºçš„æè¿°ç¬¦å¯¹åº”äºä¸»åŠ¨å¥—æ¥å­—ï¼ˆactive socketï¼‰ã€‚    </p>
<h3 id="å‡½æ•°åŸå‹-2"><a href="#å‡½æ•°åŸå‹-2" class="headerlink" title="å‡½æ•°åŸå‹"></a>å‡½æ•°åŸå‹</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/socket.h&gt;</span></span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">listen</span><span class="params">(<span class="keyword">int</span> sockfd, <span class="keyword">int</span> backlog)</span></span>;</div></pre></td></tr></table></figure>
<h3 id="å‚æ•°è¯´æ˜-2"><a href="#å‚æ•°è¯´æ˜-2" class="headerlink" title="å‚æ•°è¯´æ˜"></a>å‚æ•°è¯´æ˜</h3><p><strong>sockfd</strong>:<br>å³ socket æè¿°å­—ï¼Œç”± socket() å‡½æ•°åˆ›å»ºã€‚    </p>
<p><strong>backlog</strong>:<br>æŒ‡å®šåœ¨è¯·æ±‚é˜Ÿåˆ—ä¸­çš„æœ€å¤§è¯·æ±‚æ•°ï¼Œè¿›å…¥çš„è¿æ¥è¯·æ±‚å°†åœ¨é˜Ÿåˆ—ä¸­ç­‰å¾… accept() å®ƒä»¬ã€‚    </p>
<h2 id="connect-å‡½æ•°"><a href="#connect-å‡½æ•°" class="headerlink" title="connect å‡½æ•°"></a>connect å‡½æ•°</h2><p>ç”±å®¢æˆ·ç«¯è°ƒç”¨ï¼Œä¸ç›®çš„æœåŠ¡å™¨çš„å¥—æ¥å­—å»ºç«‹ä¸€ä¸ªè¿æ¥ã€‚    </p>
<h3 id="å‡½æ•°åŸå‹-3"><a href="#å‡½æ•°åŸå‹-3" class="headerlink" title="å‡½æ•°åŸå‹"></a>å‡½æ•°åŸå‹</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/socket.h&gt;</span></span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">connect</span><span class="params">(<span class="keyword">int</span> clientfd, <span class="keyword">const</span> <span class="keyword">struct</span> sockaddr *addr, <span class="keyword">socklen_t</span> addrlen)</span></span>;</div></pre></td></tr></table></figure>
<h3 id="å‚æ•°è¯´æ˜-3"><a href="#å‚æ•°è¯´æ˜-3" class="headerlink" title="å‚æ•°è¯´æ˜"></a>å‚æ•°è¯´æ˜</h3><p><strong>clientfd</strong>:<br>ç›®çš„æœåŠ¡å™¨çš„ socket æè¿°ç¬¦    </p>
<p><strong>*addr</strong>:<br>ä¸€ä¸ª <code>const struct sockaddr</code> æŒ‡é’ˆï¼ŒåŒ…å«äº†ç›®çš„æœåŠ¡å™¨ IP å’Œç«¯å£ã€‚    </p>
<p><strong>addrlen</strong>ï¼š<br>åè®®åœ°å€çš„é•¿åº¦ï¼Œå¦‚æœæ˜¯ ipv4 çš„ TCP è¿æ¥ï¼Œä¸€èˆ¬ä¸º <code>sizeof(sockaddr_in)</code>;    </p>
<h2 id="accept-å‡½æ•°"><a href="#accept-å‡½æ•°" class="headerlink" title="accept å‡½æ•°"></a>accept å‡½æ•°</h2><p>æœåŠ¡å™¨è°ƒç”¨ï¼Œç­‰å¾…æ¥è‡ªå®¢æˆ·ç«¯çš„è¿æ¥è¯·æ±‚ã€‚<br>å½“å®¢æˆ·ç«¯è¿æ¥ï¼Œaccept å‡½æ•°ä¼šåœ¨ <code>addr</code> ä¸­ä¼šå¡«å……ä¸Šå®¢æˆ·ç«¯çš„å¥—æ¥å­—åœ°å€ï¼Œå¹¶ä¸”è¿”å›ä¸€ä¸ªå·²è¿æ¥æè¿°ç¬¦ï¼ˆconnected descriptorï¼‰ï¼Œè¿™ä¸ªæè¿°ç¬¦å¯ä»¥ç”¨æ¥åˆ©ç”¨ Unix I/O å‡½æ•°ä¸å®¢æˆ·ç«¯é€šä¿¡ã€‚    </p>
<h3 id="å‡½æ•°åŸå‹-4"><a href="#å‡½æ•°åŸå‹-4" class="headerlink" title="å‡½æ•°åŸå‹"></a>å‡½æ•°åŸå‹</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#indclude <span class="meta-string">&lt;sys/socket.h&gt;</span></span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">accept</span><span class="params">(<span class="keyword">int</span> listenfd, <span class="keyword">struct</span> sockaddr *addr, <span class="keyword">int</span> *addrlen)</span></span>;</div></pre></td></tr></table></figure>
<h3 id="å‚æ•°è¯´æ˜-4"><a href="#å‚æ•°è¯´æ˜-4" class="headerlink" title="å‚æ•°è¯´æ˜"></a>å‚æ•°è¯´æ˜</h3><p><strong>listenfd</strong>:<br>æœåŠ¡å™¨çš„ socket æè¿°å­—ï¼Œç”± socket() å‡½æ•°åˆ›å»ºã€‚    </p>
<p><strong>*addr</strong>:<br>ä¸€ä¸ª <code>const struct sockaddr</code> æŒ‡é’ˆï¼Œç”¨æ¥å­˜æ”¾æå‡ºè¿æ¥è¯·æ±‚å®¢æˆ·ç«¯çš„ä¸»æœºçš„ä¿¡æ¯</p>
<p><strong>*addrlen</strong>:<br>åè®®åœ°å€çš„é•¿åº¦ï¼Œå¦‚æœæ˜¯ ipv4 çš„ TCP è¿æ¥ï¼Œä¸€èˆ¬ä¸º <code>sizeof(sockaddr_in)</code>ã€‚    </p>
<h2 id="close-å‡½æ•°"><a href="#close-å‡½æ•°" class="headerlink" title="close å‡½æ•°"></a>close å‡½æ•°</h2><p>åœ¨æ•°æ®ä¼ è¾“å®Œæˆä¹‹åï¼Œæ‰‹åŠ¨å…³é—­è¿æ¥ã€‚    </p>
<h3 id="å‡½æ•°åŸå‹-5"><a href="#å‡½æ•°åŸå‹-5" class="headerlink" title="å‡½æ•°åŸå‹"></a>å‡½æ•°åŸå‹</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/socket.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">close</span><span class="params">(<span class="keyword">int</span> fd)</span></span>;</div></pre></td></tr></table></figure>
<h3 id="å‚æ•°è¯´æ˜-5"><a href="#å‚æ•°è¯´æ˜-5" class="headerlink" title="å‚æ•°è¯´æ˜"></a>å‚æ•°è¯´æ˜</h3><p><strong>fd</strong>:<br>éœ€è¦å…³é—­çš„è¿æ¥ socket æè¿°ç¬¦    </p>
<h2 id="ç½‘ç»œ-I-O-å‡½æ•°"><a href="#ç½‘ç»œ-I-O-å‡½æ•°" class="headerlink" title="ç½‘ç»œ I/O å‡½æ•°"></a>ç½‘ç»œ I/O å‡½æ•°</h2><p>å½“å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨å»ºç«‹è¿æ¥åï¼Œå¯ä»¥ä½¿ç”¨ç½‘ç»œ I/O è¿›è¡Œè¯»å†™æ“ä½œã€‚<br>ç½‘ç»œ I/O æ“ä½œæœ‰ä¸‹é¢å‡ ç»„ï¼š</p>
<ol>
<li>read()/write()</li>
<li>recv()/send()</li>
<li>readv()/writev()</li>
<li>recvmsg()/sendmsg()</li>
<li>recvfrom()/sendto()</li>
</ol>
<p>æœ€å¸¸ç”¨çš„æ˜¯ read()/write()<br>ä»–ä»¬çš„åŸå‹æ˜¯ï¼š</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">ssize_t</span> read(<span class="keyword">int</span> fd, <span class="keyword">void</span> *buf, <span class="keyword">size_t</span> count);</div><div class="line"><span class="keyword">ssize_t</span> write(<span class="keyword">int</span> fd, <span class="keyword">const</span> <span class="keyword">void</span> *buf, <span class="keyword">size_t</span> count);</div></pre></td></tr></table></figure>
<p>é‰´äºè¯¥æ–‡æ˜¯ä¾§é‡äºæè¿° socket çš„å·¥ä½œåŸç†ï¼Œå°±ä¸å†è¯¦ç»†æè¿°è¿™äº›å‡½æ•°äº†ã€‚</p>
<h1 id="å®ç°ä¸€ä¸ªç®€å•-TCP-äº¤äº’"><a href="#å®ç°ä¸€ä¸ªç®€å•-TCP-äº¤äº’" class="headerlink" title="å®ç°ä¸€ä¸ªç®€å• TCP äº¤äº’"></a>å®ç°ä¸€ä¸ªç®€å• TCP äº¤äº’</h1><h2 id="æœåŠ¡ç«¯"><a href="#æœåŠ¡ç«¯" class="headerlink" title="æœåŠ¡ç«¯"></a>æœåŠ¡ç«¯</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// socket_server.cpp</span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;errno.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/types.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/socket.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;netinet/in.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXLINE 4096 <span class="comment">// 4 * 1024</span></span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> listenfd, <span class="comment">// ç›‘å¬ç«¯å£çš„ socket æè¿°ç¬¦</span></div><div class="line">        connfd;   <span class="comment">// è¿æ¥ç«¯ socket æè¿°ç¬¦</span></div><div class="line">    <span class="keyword">struct</span> sockaddr_in servaddr;</div><div class="line">    <span class="keyword">char</span> buff[MAXLINE];</div><div class="line">    <span class="keyword">int</span> n;</div><div class="line"></div><div class="line">    <span class="comment">// åˆ›å»º socketï¼Œå¹¶ä¸”è¿›è¡Œé”™è¯¯å¤„ç†</span></div><div class="line">    <span class="keyword">if</span> ((listenfd = socket(AF_INET, SOCK_STREAM, <span class="number">0</span>)) == <span class="number">-1</span>)</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"create socket error: %s(errno: %d)\n"</span>, strerror(errno), errno);</div><div class="line">        <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// åˆå§‹åŒ– sockaddr_in æ•°æ®ç»“æ„</span></div><div class="line">    <span class="built_in">memset</span>(&amp;servaddr, <span class="number">0</span>, <span class="keyword">sizeof</span>(servaddr));</div><div class="line">    servaddr.sin_family = AF_INET;</div><div class="line">    servaddr.sin_addr.s_addr = htonl(INADDR_ANY);</div><div class="line">    servaddr.sin_port = htons(<span class="number">6666</span>);</div><div class="line"></div><div class="line">    <span class="comment">// ç»‘å®š socket å’Œ ç«¯å£</span></div><div class="line">    <span class="keyword">if</span> (bind(listenfd, (<span class="keyword">struct</span> sockaddr *)&amp;servaddr, <span class="keyword">sizeof</span>(servaddr)) == <span class="number">-1</span>)</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"bind socket error: %s(errno: %d)\n"</span>, strerror(errno), errno);</div><div class="line">        <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// ç›‘å¬è¿æ¥</span></div><div class="line">    <span class="keyword">if</span> (listen(listenfd, <span class="number">10</span>) == <span class="number">-1</span>)</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"listen socket error: %s(errno: %d)\n"</span>, strerror(errno), errno);</div><div class="line">        <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="built_in">printf</span>(<span class="string">"====== Waiting for client's request======\n"</span>);</div><div class="line"></div><div class="line">    <span class="comment">// æŒç»­æ¥æ”¶å®¢æˆ·ç«¯çš„è¿æ¥è¯·æ±‚</span></div><div class="line">    <span class="keyword">while</span> (<span class="literal">true</span>)</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">if</span> ((connfd = accept(listenfd, (<span class="keyword">struct</span> sockaddr *)<span class="literal">NULL</span>, <span class="literal">NULL</span>) == <span class="number">-1</span>))</div><div class="line">        &#123;</div><div class="line">            <span class="built_in">printf</span>(<span class="string">"accept socket error: %s(errno: %d)\n"</span>, strerror(errno), errno);</div><div class="line">            <span class="keyword">continue</span>;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        n = recv(connfd, buff, MAXLINE, <span class="number">0</span>);</div><div class="line">        buff[n] = <span class="string">'\0'</span>;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"recv msg from client: %s\n"</span>, buff);</div><div class="line">        close(connfd);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    close(listenfd);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="å®¢æˆ·ç«¯"><a href="#å®¢æˆ·ç«¯" class="headerlink" title="å®¢æˆ·ç«¯"></a>å®¢æˆ·ç«¯</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// socket_client.cpp</span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;errno.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/types.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sys/socket.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;netinet/in.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;arpa/inet.h&gt;</span></span></div><div class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;unistd.h&gt;</span></span></div><div class="line"></div><div class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXLINE 4096</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> **argv)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">int</span> sockfd, n;</div><div class="line">    <span class="keyword">char</span> recvline[<span class="number">4096</span>], sendline[<span class="number">4096</span>];</div><div class="line">    <span class="keyword">struct</span> sockaddr_in servaddr;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (argc != <span class="number">2</span>)</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"usage: ./client &lt;ipaddress&gt;\n"</span>);</div><div class="line">        <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// åˆ›å»º socket æè¿°ç¬¦</span></div><div class="line">    <span class="keyword">if</span> ((sockfd = socket(AF_INET, SOCK_STREAM, <span class="number">0</span>)) &lt; <span class="number">0</span>)</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"create socket error: %s(errno: %d)\n"</span>, strerror(errno), errno);</div><div class="line">        <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// åˆå§‹åŒ–ç›®æ ‡æœåŠ¡å™¨æ•°æ®ç»“æ„</span></div><div class="line">    <span class="built_in">memset</span>(&amp;servaddr, <span class="number">0</span>, <span class="keyword">sizeof</span>(servaddr));</div><div class="line">    servaddr.sin_family = AF_INET;</div><div class="line">    servaddr.sin_port = htons(<span class="number">6666</span>);</div><div class="line">    <span class="comment">// ä»å‚æ•°ä¸­è¯»å– IP åœ°å€</span></div><div class="line">    <span class="keyword">if</span> (inet_pton(AF_INET, argv[<span class="number">1</span>], &amp;servaddr.sin_addr) &lt;= <span class="number">0</span>)</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"inet_pton error for %s\n"</span>, argv[<span class="number">1</span>]);</div><div class="line">        <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// è¿æ¥ç›®æ ‡æœåŠ¡å™¨ï¼Œå¹¶å’Œ sockfd è”ç³»èµ·æ¥ã€‚</span></div><div class="line">    <span class="keyword">if</span> (connect(sockfd, (<span class="keyword">struct</span> sockaddr *)&amp;servaddr, <span class="keyword">sizeof</span>(servaddr)) &lt; <span class="number">0</span>)</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"connect error: %s(errno: %d)\n"</span>, strerror(errno), errno);</div><div class="line">        <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="built_in">printf</span>(<span class="string">"send msg to server: \n"</span>);</div><div class="line"></div><div class="line">    <span class="comment">// ä»æ ‡å‡†è¾“å…¥æµä¸­è¯»å–ä¿¡æ¯</span></div><div class="line">    fgets(sendline, <span class="number">4096</span>, <span class="built_in">stdin</span>);</div><div class="line"></div><div class="line">    <span class="comment">// é€šè¿‡ sockfdï¼Œå‘ç›®æ ‡æœåŠ¡å™¨å‘é€ä¿¡æ¯</span></div><div class="line">    <span class="keyword">if</span> (send(sockfd, sendline, <span class="built_in">strlen</span>(sendline), <span class="number">0</span>) &lt; <span class="number">0</span>)</div><div class="line">    &#123;</div><div class="line">        <span class="built_in">printf</span>(<span class="string">"send msg error: %s(errno: %d)\n"</span>, strerror(errno), errno);</div><div class="line">        <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// æ•°æ®ä¼ è¾“å®Œæ¯•ï¼Œå…³é—­ socket è¿æ¥</span></div><div class="line">    close(sockfd);</div><div class="line">    <span class="keyword">return</span> <span class="number">0</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="Run"><a href="#Run" class="headerlink" title="Run"></a>Run</h1><p>é¦–å…ˆåˆ›å»º <code>makefile</code> æ–‡ä»¶</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">all:server client</div><div class="line">server:socket_server.o</div><div class="line">	g++ -g -o socket_server socket_server.o</div><div class="line">client:socket_client.o</div><div class="line">	g++ -g -o socket_client socket_client.o</div><div class="line">socket_server.o:socket_server.cpp</div><div class="line">	g++ -g -c socket_server.cpp</div><div class="line">socket_client.o:socket_client.cpp</div><div class="line">	g++ -g -c socket_client.cpp</div><div class="line">clean:all</div><div class="line">	rm all</div></pre></td></tr></table></figure>
<p>ç„¶åä½¿ç”¨å‘½ä»¤:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ make</div></pre></td></tr></table></figure>
<p>ä¼šç”Ÿæˆä¸¤ä¸ªå¯æ‰§è¡Œæ–‡ä»¶ï¼š</p>
<ol>
<li><code>socket_server</code></li>
<li><code>socket_client</code></li>
</ol>
<p>åˆ†åˆ«æ‰“å¼€ä¸¤ä¸ªç»ˆç«¯ï¼Œè¿è¡Œï¼š</p>
<ol>
<li><code>./socket_server</code></li>
<li><code>./socket_client 127.0.0.1</code></li>
</ol>
<p>ç„¶ååœ¨ <code>socket_client</code> ä¸­é”®å…¥å‘é€å†…å®¹ï¼Œå¯ä»¥å† <code>socket_server</code> æ¥æ”¶åˆ°åŒæ ·çš„ä¿¡æ¯ã€‚</p>
<h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><a href="https://book.douban.com/subject/26850616/" target="_blank" rel="external">ã€Šåå°å¼€å‘ æ ¸å¿ƒæŠ€æœ¯ä¸åº”ç”¨å®è·µã€‹</a><br><a href="https://book.douban.com/subject/2970300/" target="_blank" rel="external">ã€Šè®¡ç®—æœºç½‘ç»œã€‹</a></p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;æ›´å¥½é˜…è¯»ä½“éªŒï¼š&lt;a href=&quot;https://jerryc8080.gitbooks.io/understand-tcp-and-udp/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;ã€Šç†è§£ TCP å’Œ UDPã€‹â€” By Gi
    
    </summary>
    
      <category term="æ¬ç –ç å†œ" scheme="http://huang-jerryc.com/categories/%E6%90%AC%E7%A0%96%E7%A0%81%E5%86%9C/"/>
    
    
      <category term="tcp" scheme="http://huang-jerryc.com/tags/tcp/"/>
    
  </entry>
  
  <entry>
    <title>ç†è§£TCPï¼ˆäº”ï¼‰ï¼šå¯é æ€§äº¤ä»˜çš„å®ç°</title>
    <link href="http://huang-jerryc.com/2017/03/02/understand-tcp-5/"/>
    <id>http://huang-jerryc.com/2017/03/02/understand-tcp-5/</id>
    <published>2017-03-02T08:00:25.000Z</published>
    <updated>2020-07-21T08:12:37.393Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>æ›´å¥½é˜…è¯»ä½“éªŒï¼š<a href="https://jerryc8080.gitbooks.io/understand-tcp-and-udp/" target="_blank" rel="external">ã€Šç†è§£ TCP å’Œ UDPã€‹â€” By Gitbook</a>    </p>
</blockquote>
<p>TCP æ˜¯ä¸€ç§æä¾›å¯é æ€§äº¤ä»˜çš„åè®®ã€‚<br>ä¹Ÿå°±æ˜¯è¯´ï¼Œé€šè¿‡ TCP è¿æ¥ä¼ è¾“çš„æ•°æ®ï¼Œæ— å·®é”™ã€ä¸ä¸¢å¤±ã€ä¸é‡å¤ã€å¹¶ä¸”æŒ‰åºåˆ°è¾¾ã€‚<br>ä½†æ˜¯åœ¨ç½‘ç»œä¸­ç›¸è¿ä¸¤ç«¯ä¹‹é—´çš„ä»‹è´¨ï¼Œæ˜¯å¤æ‚çš„ï¼Œå¹¶ä¸ç¡®ä¿æ•°æ®çš„å¯é æ€§äº¤ä»˜ï¼Œé‚£ä¹ˆ TCP æ˜¯æ€ä¹ˆæ ·è§£å†³é—®é¢˜çš„ï¼Ÿ<br>è¿™å°±éœ€è¦äº†è§£ TCP çš„å‡ ç§æŠ€æœ¯ï¼š    </p>
<ol>
<li>æ»‘åŠ¨çª—å£    </li>
<li>è¶…æ—¶é‡ä¼     </li>
<li>æµé‡æ§åˆ¶    </li>
<li>æ‹¥å¡æ§åˆ¶    </li>
</ol>
<p>ä¸‹é¢æ¥åˆ†åˆ«è®²ä¸€ä¸‹è¿™å‡ ç§æŠ€æœ¯çš„å®ç°åŸç†ã€‚    </p>
<h1 id="è¶…æ—¶é‡ä¼ "><a href="#è¶…æ—¶é‡ä¼ " class="headerlink" title="è¶…æ—¶é‡ä¼ "></a>è¶…æ—¶é‡ä¼ </h1><h2 id="é‡ä¼ æ—¶æœº"><a href="#é‡ä¼ æ—¶æœº" class="headerlink" title="é‡ä¼ æ—¶æœº"></a>é‡ä¼ æ—¶æœº</h2><p>TCP æŠ¥æ–‡æ®µåœ¨ä¼ è¾“çš„è¿‡ç¨‹ä¸­ï¼Œä¸‹é¢çš„æƒ…å†µéƒ½æ˜¯æœ‰å¯èƒ½å‘ç”Ÿçš„ï¼š</p>
<ol>
<li>æ•°æ®åŒ…ä¸­é€”ä¸¢å¤±ï¼›</li>
<li>æ•°æ®åŒ…é¡ºåˆ©åˆ°è¾¾ï¼Œä½†å¯¹æ–¹å‘é€çš„ ACK æŠ¥æ–‡ä¸­é€”ä¸¢å¤±ï¼›</li>
<li>æ•°æ®åŒ…é¡ºåˆ©åˆ°è¾¾ï¼Œä½†å¯¹æ–¹å¼‚å¸¸æœªå“åº” ACK æˆ–è¢«å¯¹æ–¹ä¸¢å¼ƒï¼›</li>
</ol>
<p>å½“å‡ºç°è¿™äº›å¼‚å¸¸æƒ…å†µæ—¶ï¼ŒTCP å°±ä¼šè¶…æ—¶é‡ä¼ ã€‚<br>TCP æ¯å‘é€ä¸€ä¸ªæŠ¥æ–‡æ®µï¼Œå°±å¯¹è¿™ä¸ªæŠ¥æ–‡æ®µè®¾ç½®ä¸€æ¬¡è®¡æ—¶å™¨ã€‚åªè¦è®¡æ—¶å™¨è®¾ç½®çš„é‡ä¼ æ—¶é—´åˆ°äº†ï¼Œä½†è¿˜æ²¡æœ‰æ”¶åˆ°ç¡®è®¤ï¼Œå°±é‡ä¼ è¿™ä¸€æŠ¥æ–‡æ®µï¼Œè¿™ä¸ªå°±å«åšã€Œè¶…æ—¶é‡ä¼ ã€ã€‚    </p>
<h2 id="é‡ä¼ ç®—æ³•"><a href="#é‡ä¼ ç®—æ³•" class="headerlink" title="é‡ä¼ ç®—æ³•"></a>é‡ä¼ ç®—æ³•</h2><h3 id="å…ˆè®¤è¯†ä¸¤ä¸ªæ¦‚å¿µ"><a href="#å…ˆè®¤è¯†ä¸¤ä¸ªæ¦‚å¿µ" class="headerlink" title="å…ˆè®¤è¯†ä¸¤ä¸ªæ¦‚å¿µ"></a>å…ˆè®¤è¯†ä¸¤ä¸ªæ¦‚å¿µ</h3><h4 id="RTO-Retransmission-Time-Out-é‡ä¼ è¶…æ—¶æ—¶é—´"><a href="#RTO-Retransmission-Time-Out-é‡ä¼ è¶…æ—¶æ—¶é—´" class="headerlink" title="RTO ( Retransmission Time-Out ) é‡ä¼ è¶…æ—¶æ—¶é—´"></a>RTO ( Retransmission Time-Out ) é‡ä¼ è¶…æ—¶æ—¶é—´</h4><p>æŒ‡å‘é€ç«¯å‘é€æ•°æ®åã€é‡ä¼ æ•°æ®å‰ç­‰å¾…æ¥æ”¶æ–¹æ”¶åˆ°è¯¥æ•°æ® ACK æŠ¥æ–‡çš„æ—¶é—´ã€‚<br>å¤§ç™½è¯å°±æ˜¯ï¼Œéœ€è¦ç­‰å¾…å¤šé•¿æ—¶é—´è¿˜æ²¡æ”¶åˆ°ç¡®è®¤ï¼Œå°±é‡æ–°ä¼ ä¸€æ¬¡ã€‚    </p>
<p>RTO çš„è®¾ç½®å¯¹äºé‡ä¼ éå¸¸é‡è¦ï¼š    </p>
<ol>
<li>è®¾é•¿äº†ï¼Œé‡å‘å°±æ…¢ï¼Œæ²¡æœ‰æ•ˆç‡ï¼Œæ€§èƒ½å·®ï¼›</li>
<li>è®¾çŸ­äº†ï¼Œé‡å‘å¾—å°±å¿«ï¼Œä¼šå¢åŠ ç½‘ç»œæ‹¥å¡ï¼Œå¯¼è‡´æ›´å¤šçš„è¶…æ—¶ï¼Œæ›´å¤šçš„è¶…æ—¶å¯¼è‡´æ›´å¤šçš„é‡å‘ã€‚</li>
</ol>
<h4 id="RTT-Round-Trip-Time-è¿æ¥å¾€è¿”æ—¶é—´"><a href="#RTT-Round-Trip-Time-è¿æ¥å¾€è¿”æ—¶é—´" class="headerlink" title="RTT ( Round Trip Time ) è¿æ¥å¾€è¿”æ—¶é—´"></a>RTT ( Round Trip Time ) è¿æ¥å¾€è¿”æ—¶é—´</h4><p>æŒ‡å‘é€ç«¯ä»å‘é€ TCP åŒ…å¼€å§‹åˆ°æ¥æ”¶å®ƒçš„ ACK æŠ¥æ–‡ä¹‹é—´æ‰€è€—è´¹çš„æ—¶é—´ã€‚<br>è€Œåœ¨å®é™…çš„ç½‘ç»œä¼ è¾“ä¸­ï¼ŒRTT çš„å€¼æ¯æ¬¡éƒ½æ˜¯éšæœºçš„ï¼Œæ— æ³•äº‹å…ˆé¢„é¢„çŸ¥ã€‚<br>TCP é€šè¿‡æµ‹é‡æ¥è·å¾—è¿æ¥å½“å‰ RTT çš„ä¸€ä¸ªä¼°è®¡å€¼ï¼Œå¹¶ä»¥è¯¥ RTT ä¼°è®¡å€¼ä¸ºåŸºå‡†æ¥è®¾ç½®å½“å‰çš„ RTOã€‚<br>è¿™å°±å¼•å…¥äº†ä¸€ç±»ç®—æ³•çš„ç§°å‘¼ï¼šè‡ªé€‚åº”é‡ä¼ ç®—æ³•ï¼ˆAdaptive Restransmission Algorithmï¼‰<br>è¿™ç±»ç®—æ³•çš„å…³é”®å°±åœ¨äºå¯¹å½“å‰ RTT çš„å‡†ç¡®ä¼°è®¡ï¼Œä»¥ä¾¿é€‚æ—¶è°ƒæ•´ RTOã€‚    </p>
<p>å…³äºè‡ªé€‚åº”é‡ä¼ ç®—æ³•ï¼Œç»å†è¿‡å¤šæ¬¡çš„è¿­ä»£å’Œä¿®æ­£ã€‚<br>ä» 1981 å¹´çš„ <a href="https://tools.ietf.org/html/rfc793" target="_blank" rel="external">RFC793</a> æåŠçš„ç»å…¸ç®—æ³•ï¼Œåˆ° 1987 å¹´ Karn æå‡ºçš„ Karn/Partridge ç®—æ³•ï¼Œå†åˆ°åæ¥çš„ 1988 å¹´çš„ Jacobson / Karels ç®—æ³•ã€‚<br>æœ€åçš„è¿™ä¸ªç®—æ³•åœ¨è¢«ç”¨åœ¨ä»Šå¤©çš„ TCP åè®®ä¸­ï¼ˆLinuxçš„æºä»£ç åœ¨ï¼š<a href="http://lxr.free-electrons.com/source/net/ipv4/tcp_input.c?v=2.6.32#L609" target="_blank" rel="external"><code>tcp_rtt_estimator</code></a>ï¼‰ã€‚    </p>
<p>è‡ªé€‚åº”é‡ä¼ ç®—æ³•çš„å‘å±•è¯»è€…æœ‰å…´è¶£å¯ä»¥å‚è€ƒå…¶ä»–èµ„æ–™ï¼Œåœ¨è¿™é‡Œæˆ‘æ‹ä¸€ä¸ªç°åœ¨åœ¨ç”¨çš„ç®—æ³•å‡ºæ¥è®²è®²ï¼Œéšæ„æ„Ÿå—ä¸€ä¸‹ã€‚    </p>
<h3 id="Jacobson-Karels-ç®—æ³•"><a href="#Jacobson-Karels-ç®—æ³•" class="headerlink" title="Jacobson / Karels ç®—æ³•"></a>Jacobson / Karels ç®—æ³•</h3><p>1988å¹´ï¼Œæœ‰äººæ¨å‡ºæ¥äº†ä¸€ä¸ªæ–°çš„ç®—æ³•ï¼Œè¿™ä¸ªç®—æ³•å« Jacobson / Karels Algorithmï¼ˆå‚çœ‹<a href="https://tools.ietf.org/html/rfc2988" target="_blank" rel="external">RFC6298</a>ï¼‰ã€‚<br>å…¶è®¡ç®—å…¬å¼ï¼š</p>
<blockquote>
<p>SRTT = SRTT + Î± ( RTT â€“ SRTT )  â€”â€” è®¡ç®—å¹³æ»‘ RTT</p>
<p>DevRTT = ( 1-Î² ) <em> DevRTT + Î² </em> ( | RTT - SRTT | ) â€”â€”è®¡ç®—å¹³æ»‘ RTT å’ŒçœŸå®çš„å·®è·ï¼ˆåŠ æƒç§»åŠ¨å¹³å‡ï¼‰</p>
<p>RTO= Âµ <em> SRTT + âˆ‚ </em> DevRTT </p>
</blockquote>
<p>å…¶ä¸­ï¼š</p>
<ul>
<li><p><code>Î±</code>ã€<code>Î²</code>ã€<code>Î¼</code>ã€<code>âˆ‚</code> æ˜¯å¯ä»¥è°ƒæ•´çš„å‚æ•°ï¼Œåœ¨ RFC6298 ä¸­ç»™å‡ºäº†å¯¹åº”çš„å‚è€ƒå€¼ï¼Œè€Œåœ¨Linuxä¸‹ï¼ŒÎ± = 0.125ï¼ŒÎ² = 0.25ï¼Œ Î¼ = 1ï¼Œâˆ‚ = 4ï¼›</p>
</li>
<li><p>SRTT æ˜¯ Smoothed RTT çš„æ„æ€ï¼Œæ˜¯ RTT çš„å¹³æ»‘è®¡ç®—å€¼ï¼Œå³æ ¹æ®æ¯æ¬¡æµ‹é‡çš„ RTT å’Œæ—§çš„ RTT è¿›è¡Œè¿ç®—ï¼Œå¾—å‡ºæ–°çš„ RTTã€‚SRTT çš„å€¼ï¼Œä¼šåœ¨æ¯ä¸€æ¬¡æµ‹é‡åˆ° RTT ä¹‹åè¿›è¡Œæ›´æ–°ï¼›</p>
</li>
<li><p>DevRTT æ˜¯ Deviation RTT çš„æ„æ€ï¼Œæ ¹æ®æ¯æ¬¡æµ‹é‡çš„ RTT å’Œæ—§çš„ SRTT å€¼è¿›è¡Œè¿ç®—ï¼Œå¾—å‡ºæ–°çš„ DevRTTï¼›</p>
</li>
</ul>
<p>ç”±ç®—æ³•å¯ä»¥çŸ¥é“ RTO çš„å€¼ä¼šæ ¹æ®æ¯æ¬¡æµ‹é‡çš„ RTT å€¼å˜åŒ–è€Œå˜åŒ–ï¼ŒåŸºæœ¬è¦ç‚¹æ˜¯ TCP ç›‘è§†æ¯ä¸ªè¿æ¥çš„æ€§èƒ½ï¼Œç”±æ¯ä¸€ä¸ª TCP çš„è¿æ¥æƒ…å†µæ¨ç®—å‡ºåˆé€‚çš„ RTO å€¼ï¼Œæ ¹æ®ä¸åŒçš„ç½‘ç»œæƒ…å†µï¼Œè‡ªåŠ¨ä¿®æ”¹ RTO å€¼ï¼Œä»¥é€‚åº”è´Ÿè´£çš„ç½‘ç»œå˜åŒ–ã€‚</p>
<h1 id="æ‹¥å¡æ§åˆ¶"><a href="#æ‹¥å¡æ§åˆ¶" class="headerlink" title="æ‹¥å¡æ§åˆ¶"></a>æ‹¥å¡æ§åˆ¶</h1><h1 id="æ»‘åŠ¨çª—å£-Sliding-Window"><a href="#æ»‘åŠ¨çª—å£-Sliding-Window" class="headerlink" title="æ»‘åŠ¨çª—å£ Sliding Window"></a>æ»‘åŠ¨çª—å£ Sliding Window</h1><p>æ»‘åŠ¨çª—å£åè®®æ¯”è¾ƒå¤æ‚ï¼Œä¹Ÿæ˜¯ TCP åè®®çš„ç²¾é«“æ‰€åœ¨ã€‚    </p>
<p>TCP å¤´é‡Œæœ‰ä¸€ä¸ªå­—æ®µå« Windowï¼Œå« Advertised-Windowï¼Œè¿™ä¸ªå­—æ®µæ˜¯æ¥æ”¶ç«¯å‘Šè¯‰å‘é€ç«¯è‡ªå·±è¿˜æœ‰å¤šå°‘ç¼“å†²åŒºå¯ä»¥æ¥æ”¶æ•°æ®ã€‚äºæ˜¯å‘é€ç«¯å°±å¯ä»¥æ ¹æ®è¿™ä¸ªæ¥æ”¶ç«¯çš„å¤„ç†èƒ½åŠ›æ¥å‘é€æ•°æ®ï¼Œè€Œä¸ä¼šå¯¼è‡´æ¥æ”¶ç«¯å¤„ç†ä¸è¿‡æ¥ã€‚    </p>
<p>æ»‘åŠ¨çª—å£åˆ†ä¸ºã€Œæ¥æ”¶çª—å£ã€å’Œã€Œå‘é€çª—å£ã€<br>å› ä¸º TCP åè®®æ˜¯å…¨åŒå·¥çš„ï¼Œä¼šè¯çš„åŒæ–¹éƒ½å¯ä»¥åŒæ—¶æ¥æ”¶å’Œå‘é€ï¼Œé‚£ä¹ˆå°±éœ€è¦å„è‡ªç»´æŠ¤ä¸€ä¸ªã€Œå‘é€çª—å£ã€å’Œã€Œæ¥æ”¶çª—å£ã€ã€‚    </p>
<h2 id="å‘é€çª—å£"><a href="#å‘é€çª—å£" class="headerlink" title="å‘é€çª—å£"></a>å‘é€çª—å£</h2><p>å¤§å°å–å†³äºå¯¹ç«¯é€šå‘Šçš„æ¥å—çª—å£ã€‚<br>åªæœ‰æ”¶åˆ°å¯¹ç«¯å¯¹äºæœ¬ç«¯å‘é€çª—å£å†…å­—èŠ‚çš„ ACK ç¡®è®¤ï¼Œæ‰ä¼šç§»åŠ¨å‘é€çª—å£çš„å·¦è¾¹ç•Œã€‚    </p>
<p>ä¸‹å›¾æ˜¯å‘é€çª—å£çš„ç¤ºæ„å›¾ï¼š</p>
<p><img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/post/understand-tcp-udp/FCA43D210DF50C93E428DFD04FBBBF32.png" alt="tcps-send-wwindows.png"></p>
<p>å¯¹äºå‘é€çª—å£ï¼Œåœ¨ç¼“å­˜å†…çš„æ•°æ®æœ‰å››ç§çŠ¶æ€ï¼š</p>
<ul>
<li>#1 å·²å‘é€ï¼Œå¹¶å¾—åˆ°æ¥æ”¶æ–¹ ACK ç¡®è®¤ï¼›</li>
<li>#2 å·²å‘é€ï¼Œä½†è¿˜æœªæ”¶åˆ°æ¥æ”¶æ–¹ ACKï¼›</li>
<li>#3 æœªå‘é€ï¼Œä½†æ¥æ”¶æ–¹å…è®¸å‘é€ï¼Œæ¥æ”¶æ–¹è¿˜æœ‰ç©ºé—´</li>
<li>#4 æœªå‘é€ï¼Œä¸”æ¥æ”¶æ–¹ä¸å…è®¸å‘é€ï¼Œæ¥æ”¶æ–¹æ²¡æœ‰ç©ºé—´</li>
</ul>
<p>å¦‚æœä¸‹ä¸€åˆ»ï¼Œæ”¶åˆ°äº†æ¥æ”¶æ–¹å¯¹äº 32-36 å­—èŠ‚åºçš„æ•°æ®åŒ…çš„ ACK ç¡®è®¤ï¼Œé‚£ä¹ˆå‘é€æ–¹çš„çª—å£å°±ä¼šå‘ç”Ÿã€Œæ»‘åŠ¨ã€ã€‚<br>å¹¶ä¸”å‘é€ä¸‹ä¸€ä¸ª 46-51 å­—èŠ‚åºçš„æ•°æ®åŒ…ã€‚    </p>
<p><img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/post/understand-tcp-udp/4C22A2B58DB2F0B885A0DC50057D2768.png" alt="tcps-send-wslide.png"></p>
<p>æ»‘åŠ¨çª—å£çš„æ¦‚å¿µï¼Œæè¿°äº† TCP çš„æ•°æ®æ˜¯æ€ä¹ˆå‘é€ï¼Œä»¥åŠæ€ä¹ˆæ¥æ”¶çš„ã€‚<br>TCP çš„æ»‘åŠ¨çª—å£æ˜¯åŠ¨æ€çš„ï¼Œæˆ‘ä»¬å¯ä»¥æƒ³è±¡æˆå°å­¦å¸¸è§çš„ä¸€ä¸ªæ•°å­¦é¢˜ï¼Œä¸€ä¸ªæ°´æ± ï¼Œä½“ç§¯ Vï¼Œæ¯å°æ—¶è¿›æ°´é‡ V1, å‡ºæ°´é‡ V2ã€‚<br>å½“æ°´æ± æ»¡äº†å°±ä¸å…è®¸å†æ³¨å…¥äº†ï¼Œå¦‚æœæœ‰ä¸ªæ¶²å‹ç³»ç»Ÿæ§åˆ¶æ°´æ± å¤§å°ï¼Œé‚£ä¹ˆå°±å¯ä»¥æ§åˆ¶æ°´çš„æ³¨å…¥é€Ÿç‡å’Œé‡äº†ã€‚<br>åº”ç”¨ç¨‹åºå¯ä»¥æ ¹æ®è‡ªèº«çš„å¤„ç†èƒ½åŠ›å˜åŒ–ï¼Œé€šè¿‡ API æ¥æ§åˆ¶æœ¬ç«¯ TCP æ¥æ”¶çª—å£çš„å¤§å°ï¼Œæ¥è¿›è¡Œæµé‡æ§åˆ¶ã€‚    </p>
<h2 id="æ¥æ”¶çª—å£"><a href="#æ¥æ”¶çª—å£" class="headerlink" title="æ¥æ”¶çª—å£"></a>æ¥æ”¶çª—å£</h2><p>å¤§å°å–å†³äºåº”ç”¨ã€ç³»ç»Ÿã€ç¡¬ä»¶çš„é™åˆ¶ã€‚    </p>
<p>ä¸‹å›¾æ˜¯æ¥æ”¶çª—å£çš„ç¤ºæ„å›¾ï¼ˆæ‰¾ä¸åˆ°å›¾ï¼Œå”¯æœ‰è‡ªå·±ç”»äº†ï¼‰ï¼š    </p>
<p><img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/post/understand-tcp-udp/F4B7AEDE41EE179676E79DEF2601D4A4.png" alt="tcps-receive-wwindows.png"></p>
<p>ç›¸å¯¹äºå‘é€çª—å£ï¼Œæ¥å—çª—å£åœ¨ç¼“å­˜å†…çš„æ•°æ®åªæœ‰ä¸‰ç§çŠ¶æ€ï¼š</p>
<ul>
<li>å·²æ¥æ”¶å·²ç¡®è®¤ï¼›</li>
<li>æœªæ¥æ”¶ï¼Œå‡†å¤‡æ¥æ”¶ï¼›</li>
<li>æœªæ¥æ”¶ï¼Œå¹¶æœªå‡†å¤‡æ¥æ”¶ï¼›</li>
</ul>
<p>ä¸‹ä¸€åˆ»æ¥æ”¶åˆ°æ¥è‡ªå‘é€ç«¯çš„ 32-36 æ•°æ®åŒ…ï¼Œç„¶åå›é€ ACK ç¡®è®¤æŠ¥ï¼Œå¹¶ä¸”ç§»åŠ¨æ¥æ”¶çª—å£ã€‚    </p>
<p><img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/post/understand-tcp-udp/95A36446FAD21CC3DD086FA683942FFA.png" alt="tcps-receive-wslide.png"></p>
<p>å¦å¤–æ¥æ”¶ç«¯ç›¸å¯¹äºå‘é€ç«¯è¿˜æœ‰ä¸åŒçš„ä¸€ç‚¹ï¼Œåªæœ‰å‰é¢æ‰€æœ‰çš„æ®µéƒ½ç¡®è®¤çš„æƒ…å†µä¸‹æ‰ä¼šç§»åŠ¨å·¦è¾¹ç•Œï¼Œ<br>åœ¨å‰é¢è¿˜æœ‰å­—èŠ‚æœªæ¥æ”¶ä½†æ”¶åˆ°åé¢å­—èŠ‚çš„æƒ…å†µä¸‹ï¼Œçª—å£ä¸ä¼šç§»åŠ¨ï¼Œå¹¶ä¸å¯¹åç»­å­—èŠ‚ç¡®è®¤ï¼Œä»¥æ­¤ç¡®ä¿å¯¹ç«¯ä¼šå¯¹è¿™äº›æ•°æ®é‡ä¼ ã€‚<br>å‡å¦‚ 32-36 å­—èŠ‚ä¸æ˜¯ä¸€ä¸ªæŠ¥æ–‡æ®µçš„ï¼Œè€Œæ˜¯æ¯ä¸ªå­—èŠ‚ä¸€ä¸ªæŠ¥æ–‡æ®µçš„è¯ï¼Œé‚£ä¹ˆå°±ä¼šåˆ†æˆäº† 5 ä¸ªæŠ¥æ–‡æ®µã€‚<br>åœ¨å®é™…çš„ç½‘ç»œç¯å¢ƒä¸­ï¼Œä¸èƒ½ç¡®ä¿æ˜¯æŒ‰åºæ”¶åˆ°çš„ï¼Œå…¶ä¸­ä¼šæœ‰ä¸€äº›æ—©è¾¾åˆ°ï¼Œä¸€äº›è¿Ÿåˆ°è¾¾ã€‚    </p>
<p><img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/post/understand-tcp-udp/686E3FC14C2DEF657C61ECBC16C9C954.png" alt="tcps-receive-disorder.png"></p>
<p>å¦‚å›¾ä¸­çš„ 34ã€35 å­—èŠ‚åºï¼Œå…ˆæ”¶åˆ°äº†ï¼Œæ¥æ”¶çª—å£ä¹Ÿä¸ä¼šç§»åŠ¨ã€‚<br>å› ä¸ºæœ‰å¯èƒ½ 32ã€33 å­—èŠ‚åºä¼šå‡ºç°ä¸¢åŒ…æˆ–è€…è¶…æ—¶ï¼Œè¿™æ—¶å°±éœ€è¦å‘é€ç«¯é‡å‘æŠ¥æ–‡æ®µäº†ã€‚    </p>
<h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><p><a href="http://www.tcpipguide.com/free/t_TCPSlidingWindowAcknowledgmentSystemForDataTranspo.htm" target="_blank" rel="external">The TCP/IP Guide</a><br><a href="http://coolshell.cn/articles/11609.html" target="_blank" rel="external">TCP çš„é‚£äº›äº‹å„¿ï¼ˆä¸‹ï¼‰</a><br><a href="https://book.douban.com/subject/26850616/" target="_blank" rel="external">ã€Šåå°å¼€å‘ æ ¸å¿ƒæŠ€æœ¯ä¸åº”ç”¨å®è·µã€‹</a><br><a href="https://book.douban.com/subject/2970300/" target="_blank" rel="external">ã€Šè®¡ç®—æœºç½‘ç»œã€‹</a>    </p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;æ›´å¥½é˜…è¯»ä½“éªŒï¼š&lt;a href=&quot;https://jerryc8080.gitbooks.io/understand-tcp-and-udp/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;ã€Šç†è§£ TCP å’Œ UDPã€‹â€” By Gi
    
    </summary>
    
      <category term="æ¬ç –ç å†œ" scheme="http://huang-jerryc.com/categories/%E6%90%AC%E7%A0%96%E7%A0%81%E5%86%9C/"/>
    
    
      <category term="tcp" scheme="http://huang-jerryc.com/tags/tcp/"/>
    
  </entry>
  
  <entry>
    <title>ç†è§£TCPï¼ˆå››ï¼‰ï¼šçŠ¶æ€æµè½¬</title>
    <link href="http://huang-jerryc.com/2017/03/02/understand-tcp-4/"/>
    <id>http://huang-jerryc.com/2017/03/02/understand-tcp-4/</id>
    <published>2017-03-02T07:59:25.000Z</published>
    <updated>2020-07-21T08:12:37.394Z</updated>
    
    <content type="html"><![CDATA[<blockquote>
<p>æ›´å¥½é˜…è¯»ä½“éªŒï¼š<a href="https://jerryc8080.gitbooks.io/understand-tcp-and-udp/" target="_blank" rel="external">ã€Šç†è§£ TCP å’Œ UDPã€‹â€” By Gitbook</a>    </p>
</blockquote>
<p>æ— è®ºå®¢æˆ·ç«¯è¿˜æ˜¯æœåŠ¡å™¨ï¼Œåœ¨åŒæ–¹ TCP é€šè®¯çš„è¿‡ç¨‹ä¸­ï¼Œéƒ½ä¼šæœ‰ç€ä¸€ä¸ªã€ŒçŠ¶æ€ã€çš„æ¦‚å¿µï¼ŒçŠ¶æ€ä¼šéšç€ TCP é€šè®¯çš„ä¸åŒé˜¶æ®µè€Œå˜åŒ–ã€‚</p>
<h2 id="TCP-çŠ¶æ€æµè½¬å›¾"><a href="#TCP-çŠ¶æ€æµè½¬å›¾" class="headerlink" title="TCP çŠ¶æ€æµè½¬å›¾"></a>TCP çŠ¶æ€æµè½¬å›¾</h2><p><img src="https://bluesun-1252625244.cos.ap-guangzhou.myqcloud.com/post/understand-tcp-udp/DB900F916ECD267746706FEA8DF682CD.png" alt="TCP çŠ¶æ€æµè½¬å›¾.png"></p>
<h2 id="å„ç§çŠ¶æ€è¡¨ç¤ºçš„æ„æ€"><a href="#å„ç§çŠ¶æ€è¡¨ç¤ºçš„æ„æ€" class="headerlink" title="å„ç§çŠ¶æ€è¡¨ç¤ºçš„æ„æ€"></a>å„ç§çŠ¶æ€è¡¨ç¤ºçš„æ„æ€</h2><p><strong>CLOSED</strong>ï¼šè¡¨ç¤ºåˆå§‹çŠ¶æ€</p>
<p><strong>LISTEN</strong>ï¼šè¡¨ç¤ºæœåŠ¡å™¨ç«¯çš„æŸä¸ª socket å¤„äºç›‘å¬çŠ¶æ€ï¼Œå¯ä»¥æ¥å—è¿æ¥</p>
<p><strong>SYN_SENT</strong>ï¼šåœ¨æœåŠ¡ç«¯ç›‘å¬åï¼Œå®¢æˆ·ç«¯ socket æ‰§è¡Œ CONNECT è¿æ¥æ—¶ï¼Œå®¢æˆ·ç«¯å‘é€ SYN æŠ¥æ–‡ï¼Œæ­¤æ—¶å®¢æˆ·ç«¯å°±è¿›å…¥ SYN_SENT çŠ¶æ€ï¼Œç­‰å¾…æœåŠ¡ç«¯ç¡®è®¤ã€‚</p>
<p><strong>SYN_RCVD</strong>ï¼šè¡¨ç¤ºæœåŠ¡ç«¯æ¥æ”¶åˆ°äº† SYN æŠ¥æ–‡ã€‚</p>
<p><strong>ESTABLISHED</strong>ï¼šè¡¨ç¤ºè¿æ¥å·²ç»å»ºç«‹äº†ã€‚</p>
<p><strong>FIN_WAIT_1</strong>ï¼šå…¶ä¸­ä¸€æ–¹è¯·æ±‚ç»ˆæ­¢è¿æ¥ï¼Œç­‰å¾…å¯¹æ–¹çš„ FIN æŠ¥æ–‡ã€‚</p>
<p><strong>FIN_WAIT_2</strong>ï¼šåœ¨ <strong>FIN_WAIT_2</strong> ä¹‹åï¼Œ å½“å¯¹æ–¹å›åº” ACK æŠ¥æ–‡ä¹‹åï¼Œè¿›å…¥è¯¥çŠ¶æ€ã€‚</p>
<p><strong>TIME_WAIT</strong>ï¼šè¡¨ç¤ºæ”¶åˆ°äº†å¯¹æ–¹çš„ FIN æŠ¥æ–‡ï¼Œå¹¶å‘é€å‡ºäº† ACK æŠ¥æ–‡ï¼Œå°±ç­‰ 2MSL ä¹‹åå³å¯å›åˆ° CLOSED çŠ¶æ€ã€‚</p>
<p><strong>CLOSING</strong>ï¼šä¸€ç§ç½•è§çŠ¶æ€ï¼Œå‘ç”Ÿåœ¨å‘é€ FIN æŠ¥æ–‡ä¹‹åï¼Œæœ¬åº”æ˜¯å…ˆæ”¶åˆ° ACK æŠ¥æ–‡ï¼Œå´å…ˆæ”¶åˆ°å¯¹æ–¹çš„ FIN æŠ¥æ–‡ï¼Œé‚£ä¹ˆå°±ä» FIN_WAIT_1 çš„çŠ¶æ€è¿›å…¥ CLOSING çŠ¶æ€ã€‚</p>
<p><strong>CLOSE_WAIT</strong>ï¼šè¡¨ç¤ºç­‰å¾…å…³é—­ï¼Œåœ¨ ESTABLISHED è¿‡æ¸¡åˆ° LAST_ACK çš„ä¸€ä¸ªè¿‡æ¸¡é˜¶æ®µï¼Œè¯¥é˜¶æ®µéœ€è¦è€ƒè™‘æ˜¯å¦è¿˜æœ‰æ•°æ®å‘é€ç»™å¯¹æ–¹ï¼Œå¦‚æœæ²¡æœ‰ï¼Œå°±å¯ä»¥å…³é—­è¿æ¥ï¼Œå‘é€ FIN æŠ¥æ–‡ï¼Œç„¶åè¿›å…¥ LAST_ACK çŠ¶æ€ã€‚</p>
<p><strong>LAST_ACK</strong>ï¼šè¢«åŠ¨å…³é—­ä¸€æ–¹å‘é€ FIN æŠ¥æ–‡ä¹‹åï¼Œæœ€åç­‰å¾…å¯¹æ–¹çš„ ACK æŠ¥æ–‡æ‰€å¤„çš„çŠ¶æ€ã€‚</p>
<p><strong>CLOSED</strong>ï¼šå½“æ”¶åˆ° ACK ä¿æ¸©åï¼Œå°±å¯ä»¥è¿›å…¥ CLOSED çŠ¶æ€äº†ã€‚</p>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://book.douban.com/subject/26850616/" target="_blank" rel="external">ã€Šåå°å¼€å‘ æ ¸å¿ƒæŠ€æœ¯ä¸åº”ç”¨å®è·µã€‹</a><br><a href="https://book.douban.com/subject/2970300/" target="_blank" rel="external">ã€Šè®¡ç®—æœºç½‘ç»œã€‹</a>k.douban.com/subject/2970300/)</p>
]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;æ›´å¥½é˜…è¯»ä½“éªŒï¼š&lt;a href=&quot;https://jerryc8080.gitbooks.io/understand-tcp-and-udp/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;ã€Šç†è§£ TCP å’Œ UDPã€‹â€” By Gi
    
    </summary>
    
      <category term="æ¬ç –ç å†œ" scheme="http://huang-jerryc.com/categories/%E6%90%AC%E7%A0%96%E7%A0%81%E5%86%9C/"/>
    
    
      <category term="tcp" scheme="http://huang-jerryc.com/tags/tcp/"/>
    
  </entry>
  
</feed>
